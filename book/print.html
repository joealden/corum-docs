<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Corum Project Report</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="The A Level Computing Coursework Project 'Corum' by Joe Alden">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <base href="">

        <link rel="stylesheet" href="book.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <link rel="shortcut icon" href="favicon.png">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme -->
        

        

        <!-- Fetch Clipboard.js from CDN but have a local fallback -->
        <script src="https://cdn.jsdelivr.net/clipboard.js/1.6.1/clipboard.min.js"></script>
        <script>
            if (typeof Clipboard == 'undefined') {
                document.write(unescape("%3Cscript src='clipboard.min.js'%3E%3C/script%3E"));
            }
        </script>

    </head>
    <body class="light">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { } 
            if (theme === null || theme === undefined) { theme = 'light'; }
            document.body.className = theme;
            document.querySelector('html').className = theme;
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            document.querySelector('html').classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <ol class="chapter"><li class="affix"><a href="index.html">Foreword</a></li><li class="affix"><a href="SUMMARY.html">Contents Page</a></li><li><a href="analysis/1-index/index.html"><strong aria-hidden="true">1.</strong> Analysis</a></li><li><ol class="section"><li><a href="analysis/2-idea/1-index.html"><strong aria-hidden="true">1.1.</strong> The Idea</a></li><li><ol class="section"><li><a href="analysis/2-idea/2-redditAlternative.html"><strong aria-hidden="true">1.1.1.</strong> Reddit Alterative</a></li><li><a href="analysis/2-idea/3-selfGoverning.html"><strong aria-hidden="true">1.1.2.</strong> Self Governing</a></li><li><a href="analysis/2-idea/4-openPlatform.html"><strong aria-hidden="true">1.1.3.</strong> Open Platform</a></li><li><a href="analysis/2-idea/5-modernInterface.html"><strong aria-hidden="true">1.1.4.</strong> Modern Interface</a></li></ol></li><li><a href="analysis/3-investigation/1-index.html"><strong aria-hidden="true">1.2.</strong> The Investigation</a></li><li><ol class="section"><li><a href="analysis/3-investigation/2-interviews.html"><strong aria-hidden="true">1.2.1.</strong> Interviews</a></li><li><a href="analysis/3-investigation/3-endUser.html"><strong aria-hidden="true">1.2.2.</strong> The End User</a></li><li><a href="analysis/3-investigation/4-focusGroup.html"><strong aria-hidden="true">1.2.3.</strong> The Focus Group</a></li><li><a href="analysis/3-investigation/5-existingSystems.html"><strong aria-hidden="true">1.2.4.</strong> Existing Systems</a></li></ol></li><li><a href="analysis/4-analysis/1-index.html"><strong aria-hidden="true">1.3.</strong> The Analysis</a></li><li><ol class="section"><li><a href="analysis/4-analysis/2-essentialFeatures.html"><strong aria-hidden="true">1.3.1.</strong> Essential Features</a></li><li><a href="analysis/4-analysis/3-computationalMethods.html"><strong aria-hidden="true">1.3.2.</strong> Computational Methods</a></li><li><a href="analysis/4-analysis/4-successCriteria.html"><strong aria-hidden="true">1.3.3.</strong> Success Criteria</a></li><li><a href="analysis/4-analysis/5-limitations.html"><strong aria-hidden="true">1.3.4.</strong> Limitations</a></li><li><a href="analysis/4-analysis/6-hardwareSoftware.html"><strong aria-hidden="true">1.3.5.</strong> Requirements</a></li></ol></li></ol></li><li><a href="design/1-index/index.html"><strong aria-hidden="true">2.</strong> Design</a></li><li><ol class="section"><li><a href="design/2-gui/index.html"><strong aria-hidden="true">2.1.</strong> GUI Design</a></li><li><a href="design/3-components/1-index.html"><strong aria-hidden="true">2.2.</strong> Component Design</a></li><li><ol class="section"><li><a href="design/3-components/2-logo.html"><strong aria-hidden="true">2.2.1.</strong> Logo</a></li><li><a href="design/3-components/3-header.html"><strong aria-hidden="true">2.2.2.</strong> Header</a></li><li><a href="design/3-components/4-navigation.html"><strong aria-hidden="true">2.2.3.</strong> Navigation</a></li><li><a href="design/3-components/5-main.html"><strong aria-hidden="true">2.2.4.</strong> Main Content</a></li><li><a href="design/3-components/6-footer.html"><strong aria-hidden="true">2.2.5.</strong> Footer</a></li></ol></li><li><a href="design/4-api/1-index.html"><strong aria-hidden="true">2.3.</strong> API Design</a></li><li><ol class="section"><li><a href="design/4-api/2-schema.html"><strong aria-hidden="true">2.3.1.</strong> API Schema</a></li></ol></li><li><a href="design/5-route/1-index.html"><strong aria-hidden="true">2.4.</strong> Route Design</a></li><li><ol class="section"><li><a href="design/5-route/2-summary.html"><strong aria-hidden="true">2.4.1.</strong> Route Summary</a></li><li><a href="design/5-route/3-home.html"><strong aria-hidden="true">2.4.2.</strong> Home Page</a></li><li><a href="design/5-route/4-login.html"><strong aria-hidden="true">2.4.3.</strong> Login Page</a></li><li><a href="design/5-route/5-signup.html"><strong aria-hidden="true">2.4.4.</strong> Signup Page</a></li><li><a href="design/5-route/6-subforum.html"><strong aria-hidden="true">2.4.5.</strong> Subforum Page</a></li><li><a href="design/5-route/7-post.html"><strong aria-hidden="true">2.4.6.</strong> Post Page</a></li><li><a href="design/5-route/8-newPost.html"><strong aria-hidden="true">2.4.7.</strong> New Post Page</a></li><li><a href="design/5-route/9-error.html"><strong aria-hidden="true">2.4.8.</strong> Error Page</a></li></ol></li><li><a href="design/6-testing/1-index.html"><strong aria-hidden="true">2.5.</strong> Testing</a></li><li><ol class="section"><li><a href="design/6-testing/2-linter.html"><strong aria-hidden="true">2.5.1.</strong> Linter</a></li><li><a href="design/6-testing/3-plan.html"><strong aria-hidden="true">2.5.2.</strong> Test Plan</a></li><li><a href="design/6-testing/4-data.html"><strong aria-hidden="true">2.5.3.</strong> Test Data</a></li><li><a href="design/6-testing/5-automation.html"><strong aria-hidden="true">2.5.4.</strong> Automated Testing</a></li></ol></li></ol></li><li><a href="development/1-index/index.html"><strong aria-hidden="true">3.</strong> Implementation</a></li><li><ol class="section"><li><a href="development/2-structure/1-index.html"><strong aria-hidden="true">3.1.</strong> Structure of Corum</a></li><li><ol class="section"><li><a href="development/2-structure/2-monolithMicro.html"><strong aria-hidden="true">3.1.1.</strong> Monolith vs Micro</a></li><li><a href="development/2-structure/3-client.html"><strong aria-hidden="true">3.1.2.</strong> Client Architecture</a></li><li><a href="development/2-structure/4-api.html"><strong aria-hidden="true">3.1.3.</strong> API Architecture</a></li></ol></li><li><a href="development/3-iterations/1-index.html"><strong aria-hidden="true">3.2.</strong> Iteration Stages</a></li><li><ol class="section"><li><a href="development/3-iterations/2-versionControl.html"><strong aria-hidden="true">3.2.1.</strong> Version Control</a></li><li><a href="development/3-iterations/3-changes.html"><strong aria-hidden="true">3.2.2.</strong> Iteration Stages</a></li><li><a href="development/3-iterations/4-feedback.html"><strong aria-hidden="true">3.2.3.</strong> User Feedback</a></li></ol></li><li><a href="development/4-problems/1-index.html"><strong aria-hidden="true">3.3.</strong> Problems experienced</a></li><li><ol class="section"><li><a href="development/4-problems/2-client.html"><strong aria-hidden="true">3.3.1.</strong> Client Problems</a></li><li><a href="development/4-problems/3-api.html"><strong aria-hidden="true">3.3.2.</strong> API Problems</a></li></ol></li><li><a href="development/6-codeAnalysis/1-index.html"><strong aria-hidden="true">3.4.</strong> Code Analysis</a></li><li><ol class="section"><li><a href="development/6-codeAnalysis/2-client.html"><strong aria-hidden="true">3.4.1.</strong> Client Analysis</a></li><li><a href="development/6-codeAnalysis/3-api.html"><strong aria-hidden="true">3.4.2.</strong> API Analysis</a></li></ol></li></ol></li><li><a href="evaluation/1-index/index.html"><strong aria-hidden="true">4.</strong> Evaluation</a></li><li><ol class="section"><li><a href="evaluation/2-testing/1-index.html"><strong aria-hidden="true">4.1.</strong> Testing</a></li><li><ol class="section"><li><a href="evaluation/2-testing/2-signup.html"><strong aria-hidden="true">4.1.1.</strong> Signup Page</a></li><li><a href="evaluation/2-testing/3-login.html"><strong aria-hidden="true">4.1.2.</strong> Login Page</a></li><li><a href="evaluation/2-testing/4-navigation.html"><strong aria-hidden="true">4.1.3.</strong> Navigation</a></li><li><a href="evaluation/2-testing/5-subforum.html"><strong aria-hidden="true">4.1.4.</strong> Subforum Page</a></li><li><a href="evaluation/2-testing/6-post.html"><strong aria-hidden="true">4.1.5.</strong> Post Page</a></li><li><a href="evaluation/2-testing/7-newPost.html"><strong aria-hidden="true">4.1.6.</strong> New Post Page</a></li><li><a href="evaluation/2-testing/8-newSubforum.html"><strong aria-hidden="true">4.1.7.</strong> New Subforum Page</a></li></ol></li><li><a href="evaluation/3-usabilityFeatures/1-index.html"><strong aria-hidden="true">4.2.</strong> Usability Features</a></li><li><a href="evaluation/4-evaluation/1-index.html"><strong aria-hidden="true">4.3.</strong> Final Evaluation</a></li></ol></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="submenu">
                                <li><button class="theme" id="light">Light <span class="default">(default)</span></button></li>
                                <li><button class="theme" id="rust">Rust</button></li>
                                <li><button class="theme" id="coal">Coal</button></li>
                                <li><button class="theme" id="navy">Navy</button></li>
                                <li><button class="theme" id="ayu">Ayu</button></li>
                            </ul>
                        </div>

                        <h1 class="menu-title">Corum Project Report</h1>

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <a class="header" href="print.html#computing-coursework-project---joe-alden" id="computing-coursework-project---joe-alden"><h1>Computing Coursework Project - Joe Alden</h1></a>
<p>This is the project report Corum by Joe Alden.</p>
<ul>
<li>Name: <strong>Joe Alden</strong></li>
<li>Candidate Number: <strong>????</strong></li>
<li>Centre Number: <strong>????</strong></li>
</ul>
<p><strong>NOTE:</strong> If you are viewing this in PDF form the GIFs will not play and will
instead look like static images. Above each GIF will be a line in the format
'Location: <code>PATH</code>'. <code>PATH</code> is the path of where the image can be found relative
to the PDF document.</p>
<a class="header" href="print.html#contents-page" id="contents-page"><h1>Contents Page</h1></a>
<p><a href="./index.md">Foreword</a></p>
<p><a href="./SUMMARY.md">Contents Page</a></p>
<ul>
<li><a href="./analysis/1-index/index.md">Analysis</a>
<ul>
<li><a href="./analysis/2-idea/1-index.md">The Idea</a>
<ul>
<li><a href="./analysis/2-idea/2-redditAlternative.md">Reddit Alterative</a></li>
<li><a href="./analysis/2-idea/3-selfGoverning.md">Self Governing</a></li>
<li><a href="./analysis/2-idea/4-openPlatform.md">Open Platform</a></li>
<li><a href="./analysis/2-idea/5-modernInterface.md">Modern Interface</a></li>
</ul>
</li>
<li><a href="./analysis/3-investigation/1-index.md">The Investigation</a>
<ul>
<li><a href="./analysis/3-investigation/2-interviews.md">Interviews</a></li>
<li><a href="./analysis/3-investigation/3-endUser.md">The End User</a></li>
<li><a href="./analysis/3-investigation/4-focusGroup.md">The Focus Group</a></li>
<li><a href="./analysis/3-investigation/5-existingSystems.md">Existing Systems</a></li>
</ul>
</li>
<li><a href="./analysis/4-analysis/1-index.md">The Analysis</a>
<ul>
<li><a href="./analysis/4-analysis/2-essentialFeatures.md">Essential Features</a></li>
<li><a href="./analysis/4-analysis/3-computationalMethods.md">Computational Methods</a></li>
<li><a href="./analysis/4-analysis/4-successCriteria.md">Success Criteria</a></li>
<li><a href="./analysis/4-analysis/5-limitations.md">Limitations</a></li>
<li><a href="./analysis/4-analysis/6-hardwareSoftware.md">Requirements</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="./design/1-index/index.md">Design</a>
<ul>
<li><a href="./design/2-gui/index.md">GUI Design</a></li>
<li><a href="./design/3-components/1-index.md">Component Design</a>
<ul>
<li><a href="./design/3-components/2-logo.md">Logo</a></li>
<li><a href="./design/3-components/3-header.md">Header</a></li>
<li><a href="./design/3-components/4-navigation.md">Navigation</a></li>
<li><a href="./design/3-components/5-main.md">Main Content</a></li>
<li><a href="./design/3-components/6-footer.md">Footer</a></li>
</ul>
</li>
<li><a href="./design/4-api/1-index.md">API Design</a>
<ul>
<li><a href="./design/4-api/2-schema.md">API Schema</a></li>
</ul>
</li>
<li><a href="./design/5-route/1-index.md">Route Design</a>
<ul>
<li><a href="./design/5-route/2-summary.md">Route Summary</a></li>
<li><a href="./design/5-route/3-home.md">Home Page</a></li>
<li><a href="./design/5-route/4-login.md">Login Page</a></li>
<li><a href="./design/5-route/5-signup.md">Signup Page</a></li>
<li><a href="./design/5-route/6-subforum.md">Subforum Page</a></li>
<li><a href="./design/5-route/7-post.md">Post Page</a></li>
<li><a href="./design/5-route/8-newPost.md">New Post Page</a></li>
<li><a href="./design/5-route/9-error.md">Error Page</a></li>
</ul>
</li>
<li><a href="./design/6-testing/1-index.md">Testing</a>
<ul>
<li><a href="./design/6-testing/2-linter.md">Linter</a></li>
<li><a href="./design/6-testing/3-plan.md">Test Plan</a></li>
<li><a href="./design/6-testing/4-data.md">Test Data</a></li>
<li><a href="./design/6-testing/5-automation.md">Automated Testing</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="./development/1-index/index.md">Implementation</a>
<ul>
<li><a href="./development/2-structure/1-index.md">Structure of Corum</a>
<ul>
<li><a href="./development/2-structure/2-monolithMicro.md">Monolith vs Micro</a></li>
<li><a href="./development/2-structure/3-client.md">Client Architecture</a></li>
<li><a href="./development/2-structure/4-api.md">API Architecture</a></li>
</ul>
</li>
<li><a href="./development/3-iterations/1-index.md">Iteration Stages</a>
<ul>
<li><a href="./development/3-iterations/2-versionControl.md">Version Control</a></li>
<li><a href="./development/3-iterations/3-changes.md">Iteration Stages</a></li>
<li><a href="./development/3-iterations/4-feedback.md">User Feedback</a></li>
</ul>
</li>
<li><a href="./development/4-problems/1-index.md">Problems experienced</a>
<ul>
<li><a href="./development/4-problems/2-client.md">Client Problems</a></li>
<li><a href="./development/4-problems/3-api.md">API Problems</a></li>
</ul>
</li>
<li><a href="./development/6-codeAnalysis/1-index.md">Code Analysis</a>
<ul>
<li><a href="./development/6-codeAnalysis/2-client.md">Client Analysis</a></li>
<li><a href="./development/6-codeAnalysis/3-api.md">API Analysis</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="./evaluation/1-index/index.md">Evaluation</a>
<ul>
<li><a href="./evaluation/2-testing/1-index.md">Testing</a>
<ul>
<li><a href="./evaluation/2-testing/2-signup.md">Signup Page</a></li>
<li><a href="./evaluation/2-testing/3-login.md">Login Page</a></li>
<li><a href="./evaluation/2-testing/4-navigation.md">Navigation</a></li>
<li><a href="./evaluation/2-testing/5-subforum.md">Subforum Page</a></li>
<li><a href="./evaluation/2-testing/6-post.md">Post Page</a></li>
<li><a href="./evaluation/2-testing/7-newPost.md">New Post Page</a></li>
<li><a href="./evaluation/2-testing/8-newSubforum.md">New Subforum Page</a></li>
</ul>
</li>
<li><a href="./evaluation/3-usabilityFeatures/1-index.md">Usability Features</a></li>
<li><a href="./evaluation/4-evaluation/1-index.md">Final Evaluation</a></li>
</ul>
</li>
</ul>
<a class="header" href="print.html#analysis" id="analysis"><h1>Analysis</h1></a>
<p>In this section of the report, I will be doing the following:</p>
<ul>
<li>Outlining my proposed idea</li>
<li>Investigating existing similar systems</li>
<li>Figuring out who the audience (End user) of my product is</li>
<li>Forming a focus group of this audience</li>
<li>Interviewing this focus group for feedback on the idea and existing systems</li>
<li>Coming up with a list of essential features</li>
<li>Thinking of what computation methods will be required to solve the problem</li>
<li>Creating a list of success criteria that I will use throughout the project</li>
<li>Outlining possible limitations of the project</li>
<li>Thinking about hardware and software requirements</li>
</ul>
<a class="header" href="print.html#the-idea" id="the-idea"><h1>The Idea</h1></a>
<p>Placeholder describing what this section of the report does</p>
<a class="header" href="print.html#a-reddit-alternative" id="a-reddit-alternative"><h1>A Reddit Alternative</h1></a>
<p>If you do not already know what <a href="https://www.reddit.com/">Reddit</a> is, this
section will explain the basic premise behind it. Reddit was founded in 2005,
and has largely remained the same since its inception.</p>
<p>As Wikipedia puts it (paraphrased):</p>
<blockquote>
<p>Reddit is a <strong>social news aggregation</strong>, <strong>web content rating</strong> and
<strong>discussion</strong> website.</p>
<p>Reddit's registered community members can submit content such as text posts or
links. Registered users can then vote submissions up or down that determines
their position on the page. Submissions with the most up-votes appear on the
front page or the top of a category. Content entries are organized by areas of
interest called &quot;subreddits&quot;.</p>
</blockquote>
<p>Corum will borrow these basic ideas. The reason I wanted to create Corum,
instead of continuing to use Reddit, is explained in the following subsections.</p>
<a class="header" href="print.html#a-self-governing-democracy" id="a-self-governing-democracy"><h1>A Self Governing Democracy</h1></a>
<p>Being self governed means that those that are being governed, govern themselves
and each other. There is no higher authority that makes decisions. In the case
of a forum site, this means that it is solely up to the users of the forum as a
collective to decide what content belongs on it. Corum will be designed and
developed from the ground up to strictly follow this principle.</p>
<p>Users will be given one vote each on every post, and each vote will be treated
equally. Up until now, this sounds very similar to
<a href="https://www.reddit.com/">Reddit</a>. The way that Corum differentiates itself from
existing solutions like Reddit is by making the vote that users are given
actually mean something. If users generally vote positively on a post, then the
post will remain. However, if a post gets a mostly negative response, it will be
automatically removed from the sub forum that it was posted in. This means that
if someone posts something that doesn't belong on the forum, it will be removed
by the users themselves <em>fairly</em>. This is instead of having a moderator remove
it based on their own opinion of the post, which could be biased.</p>
<p>The idea of having self governing forum software means that the role of the
forum moderator no longer needs to exist.</p>
<p>This is a good thing because:</p>
<ul>
<li>It means that the forum requires less maintenance. (Less man power required)</li>
<li>The users of the forum are responsible for maintaining it. (More <strong>neutral</strong>
and <strong>fair</strong>)</li>
<li>The removal of the moderator role keeps code complexity down. (Only one type
of user account needs to exist, and no 'admin control panel' is required)</li>
</ul>
<a class="header" href="print.html#an-open-platform" id="an-open-platform"><h1>An Open Platform</h1></a>
<p>While it is one thing to keep the platform itself democratic, it is also
important that the management and development is kept democratic as well. As of
1st September 2017, after many years of being open source,
<a href="https://www.reddit.com/r/programming/comments/6xh3xp/reddits_main_code_is_no_longer_opensource">Reddit has decided to stop developing in the open</a>.
As an advocate for open source, I believe that Reddit has made the wrong
decision here.</p>
<p>Being open source means that anyone who wants to contribute can. They can easily
propose new features, report and/or fix bugs, and freely read the source code
knowing that anyone else can too. Developers cannot go hiding things in the
source code like unnecessary tracking etc. Every decision made by the project is
made by the users.</p>
<p>This means that ultimately, the users of the forum decide the direction that
Corum takes in <em>all</em> aspects.</p>
<a class="header" href="print.html#a-modern-interface" id="a-modern-interface"><h1>A Modern Interface</h1></a>
<p>As mentioned previously, Reddit has not changed how it looks or feels very much
at all since it was created in 2005. However, the reasoning behind this decision
is probably that they do not want to make it feel unfamiliar for returning
users. For Corum, this means that I can completely rethink the way a forum
should look, feel and function, as it is a new project. With that being said, it
is important that the transition from Reddit to Corum is as easy as possible for
new users. So, if I keep the basic features of Reddit intact and keep the UI &amp;
UX simple, new users should be able to get up and running with Corum quickly.</p>
<a class="header" href="print.html#the-investigation" id="the-investigation"><h1>The Investigation</h1></a>
<p>Placeholder describing what this section of the report does</p>
<a class="header" href="print.html#interviews" id="interviews"><h1>Interviews</h1></a>
<p>I will be interviewing people that I know are users of Reddit to get an idea of
what they like and don't like about Reddit. This will help me understand what
features I should borrow, leave out, as well those that could be added that
don't currently exist.</p>
<a class="header" href="print.html#questions" id="questions"><h2>Questions</h2></a>
<ol>
<li>What do you like about it?</li>
<li>What don't you like about it?</li>
<li>What do you use regularly on it?</li>
<li>What do you not use on it?</li>
<li>What would like to see in the future on it?</li>
</ol>
<a class="header" href="print.html#answers" id="answers"><h2>Answers</h2></a>
<a class="header" href="print.html#interviewee-1" id="interviewee-1"><h3>Interviewee 1</h3></a>
<ol>
<li>
<blockquote>
<p>I like the post voting system and how popular articles raise to the top of
each sub-reddit</p>
</blockquote>
</li>
<li>
<blockquote>
<p>I don't like the look of it. I don't think it looks very modern.</p>
</blockquote>
</li>
<li>
<blockquote>
<p>When browsing a sub-reddit and see a post I like, I almost always look what
site the link is from.</p>
</blockquote>
</li>
<li>
<blockquote>
<p>I never look at the name of the author of the post on the main sub-reddit.</p>
</blockquote>
</li>
<li>
<blockquote>
<p>I would like a more fluid experience using it. I want it to feel like im
using an app.</p>
</blockquote>
</li>
</ol>
<a class="header" href="print.html#interviewee-2" id="interviewee-2"><h3>Interviewee 2</h3></a>
<ol>
<li>
<blockquote>
<p>The fact that I can see instantly how popular a post is, which isn't a
feature of many forum websites.</p>
</blockquote>
</li>
<li>
<blockquote>
<p>I don't like that a sub-reddit can choose what it looks like, I find it
very jarring to my experience when switching to a sub-reddit that looks
totally different than the last.</p>
</blockquote>
</li>
<li>
<blockquote>
<p>I use the navigation bar at the top a lot as I am always moving between
sub-forums</p>
</blockquote>
</li>
<li>
<blockquote>
<p>I never really look at the information that is on the right side of every
sub-forum, I only go to a sub-forum to look at what new has been posted.</p>
</blockquote>
</li>
<li>
<blockquote>
<p>I post quite a lot, so it would be nice if the interface of creating a new
post was simpler.</p>
</blockquote>
</li>
</ol>
<a class="header" href="print.html#interviewee-3" id="interviewee-3"><h3>Interviewee 3</h3></a>
<ol>
<li>
<blockquote>
<p>I like that I can subscribe to particular sub-forums and have them easily
accessible.</p>
</blockquote>
</li>
<li>
<blockquote>
<p>I think that there is too much information about each post of sub-forums
main pages. (time posted etc.)</p>
</blockquote>
</li>
<li>
<blockquote>
<p>I use the sort functionality quite a lot to see whats new, but also what is
popular.</p>
</blockquote>
</li>
<li>
<blockquote>
<p>I don't really look at or care about the number of people that are current
online on a sub-reddit. I would rather a cleaner interface.</p>
</blockquote>
</li>
<li>
<blockquote>
<p>I would like to see a major redesign of the whole site, it doesn't feel
modern at all anymore.</p>
</blockquote>
</li>
</ol>
<a class="header" href="print.html#interviewee-4" id="interviewee-4"><h3>Interviewee 4</h3></a>
<ol>
<li>
<blockquote>
<p>I like that other people can comment on posts, with their own opinions.</p>
</blockquote>
</li>
<li>
<blockquote>
<p>I don't like the fact that moderators can remove whatever they please.</p>
</blockquote>
</li>
<li>
<blockquote>
<p>The comment section on each post, it often is of similar value to the
actual post.</p>
</blockquote>
</li>
<li>
<blockquote>
<p>I think the profile preference section is way too complicated, and it
doesn't need to be.</p>
</blockquote>
</li>
<li>
<blockquote>
<p>For Reddit to open source their code again, I don't like the fact that I
cannot see the source code of software I use regularly.</p>
</blockquote>
</li>
</ol>
<a class="header" href="print.html#insights-gained-from-these-interviews" id="insights-gained-from-these-interviews"><h2>Insights Gained from these Interviews</h2></a>
<p>As a summary from these interview responses, I can tell the following:</p>
<ul>
<li>People like how the Reddit voting system works</li>
<li>People want a more modern version of Reddit (Like a web app)</li>
<li>People dont like how cluttered Reddit's UI is</li>
<li>People like the idea of Reddit, but think it could be executed better</li>
</ul>
<p>I will take these interviews responses into account when designing and
developing Corum.</p>
<a class="header" href="print.html#the-end-user-stakeholders" id="the-end-user-stakeholders"><h1>The End User (Stakeholders)</h1></a>
<p>In the case of a forum like Reddit, as evident from the
<a href="print.html#interviews">above interviews</a>, the end user / audience of a project like this
can be wide. For example, on Reddit, there are sub forums ranging from politics
to comedy to programming. This also means that the potential target audience is
large, as anyone that wants to visit the site to read or engage in discussion
can.</p>
<p>As Corum aims to be similar to Reddit, it will likely foster the same type of
content on it. Unlike forums that are designed for a single topic or purpose,
Reddit, and therefore Corum, is designed to have anything on it. This means that
whatever people want to talk about on it, then can. (This could be sharing news,
collaborating on research, or just chatting to each other.)</p>
<p>The reason why an end user would use Corum over a site such as Reddit could be
for many reasons. For example, it could be that they like the democratic system
of moderation as discussed, or that they prefer the modern experience that Corum
will provide.</p>
<p>Also, there are two different types of users that could use Corum; the users
that regularly visit and actively engage in discussion, and the users that will
only ever visit the site when directed from a search engine. In the following
sub sections, I will outline what Corum should do to try and cater to the needs
of these two types of users.</p>
<a class="header" href="print.html#users-that-have-different-interests" id="users-that-have-different-interests"><h2>Users That Have Different Interests</h2></a>
<p>Users of the site will have different interests, which means that Corum needs to
work well for all, and the site should not be designed for only one type of
content. <strong>Good computer literacy should not be a given</strong>, so the interface
should be layed out in a simple manner. Colour should also be kept to a minimum
to keep the site looking neutral.</p>
<a class="header" href="print.html#users-that-use-the-forum-differently" id="users-that-use-the-forum-differently"><h2>Users That Use the Forum Differently</h2></a>
<p>For users that have never visited or rarely visit the site, the UI (User
Interface) and UX (User Experience) shouldn't be surprising so that this type of
user can get whatever information they are looking for quickly and efficiently.
Also, the site should work equally as well for returning, regular users. This
means that the site should keep a similar structure and look throughout, and
should not get in the way of the user.</p>
<a class="header" href="print.html#the-focus-group" id="the-focus-group"><h1>The Focus Group</h1></a>
<p>The focus group will consist of people I know that regularly use sites such as
reddit, and of those that only use such sites for information gathering. This
means that the focus group will contains the two possible types of end users as
mentioned in the previous section. I will use this group for testing and
feedback on Corum as it develops. The group will contains people of a wide age
range, to most accurately represent the end users, as Corum is not aimed at any
particular age group.</p>
<a class="header" href="print.html#research-into-existing-systems" id="research-into-existing-systems"><h1>Research into Existing Systems</h1></a>
<a class="header" href="print.html#a-hrefhttpsredditcomreddita-proprietary-a-hrefbeing-openas-of-september-2017a" id="a-hrefhttpsredditcomreddita-proprietary-a-hrefbeing-openas-of-september-2017a"><h2><a href="https://reddit.com">Reddit</a> (Proprietary <a href="print.html#being-open">as of September 2017</a>)</h2></a>
<p><img src="images/reddit.png" alt="Reddit Front Page" /></p>
<p><strong>Reddit</strong> is a very popular forum site that is home to a wide range of topics,
where people can post links to other websites, or just have discussions actually
on the site. Users can up-vote or down-vote posts if they like or dislike them.
This is where the inspiration of Corum came from, however I thought that the
vote that the user is given on each post could be given more value.</p>
<p>As a regular reddit user, I have had plenty of time to get a grasp of its
features and what it feels like to use. As Reddit is a major inspiration for
this project, a lot of its features will be borrowed. This is on purpose, as the
target audience of Corum will be mainly those who have already had experience
with Reddit. This will mean that it will feel familiar and it will be easy to
get started.</p>
<p>While the idea of Reddit is quite simple, in my opinion, and others (as shown by
the <a href="print.html#interviews">interviews</a> with fellow Reddit users), the user interface is
cluttered, with many features that are rarely used such as the amount of people
online etc. Corum will strive to be a simpler version of Reddit.</p>
<a class="header" href="print.html#a-hrefhttpsnewsycombinatorcomhacker-newsa-proprietary" id="a-hrefhttpsnewsycombinatorcomhacker-newsa-proprietary"><h2><a href="https://news.ycombinator.com/">Hacker News</a> (Proprietary)</h2></a>
<p><img src="images/hackernews.png" alt="Hacker News Front Page" /></p>
<p><strong>Hacker News</strong> is a similar site to Reddit, however it is a lot simpler. There
are no sub-forums, as it is a site dedicated only for computer science related
topics such as programming. The user interface is very simple (and quite dated
in my opinion), which means that it doesn't get in the users way. However, I
believe that it is too simple, and too niche (As it is only for programmers).</p>
<p>I believe that there is space in the forum software landscape for a site that is
simpler than Reddit, but one with more features than Hacker News. This is where
Corum could fit in.</p>
<a class="header" href="print.html#a-hrefhttpswwwphpbbcomphpbba-open-source" id="a-hrefhttpswwwphpbbcomphpbba-open-source"><h2><a href="https://www.phpbb.com/">phpBB</a> (Open source)</h2></a>
<p><img src="images/solusforum.png" alt="Solus' Forum Front Page" /></p>
<p><strong>phpBB</strong> has different goals than Corum, Reddit and Hacker News. Instead of
being designed to run from one website, it is designed to be used by anyone who
wants to setup their own forum. An example of where phpBB is deployed is at
<a href="https://solus-project.com/forums/">Solus' Forum</a>. This can be seen when looking
at the pages footer.</p>
<p>phpBB can be themed so that it can fit the style of any website it is being run
on. This means that the look or layout of phpBB isn't really an issue as it can
be easily altered. However, as Corum will be a more similar project to Reddit,
Corum does not need this extra complexity of being able to change its looks. I
like the simplicity of Solus' forum theme, and Corum will take some inspiration
from its looks.</p>
<a class="header" href="print.html#the-analysis" id="the-analysis"><h1>The Analysis</h1></a>
<p>Placeholder describing what this section of the report does</p>
<a class="header" href="print.html#essential-features" id="essential-features"><h1>Essential Features</h1></a>
<p>From my research into existing systems, as well as the interviews I have done, I
believe this to be a good set of basic features that Corum needs.</p>
<a class="header" href="print.html#page-layout" id="page-layout"><h2>Page Layout</h2></a>
<ul>
<li>Header (Top of the page)
<ul>
<li>Top left - Logo linking to homepage</li>
<li>Top Right - Login/logout/sign-up button/link</li>
</ul>
</li>
<li>Navigation (Left side under Header, think this is better placement than Reddit
at the top as it is easier to navigate through)
<ul>
<li>Sub-forum subscriptions at the top (Called Favorites, users can access their
favorites first. This will mean that returning users can access content they
want to see quicker)</li>
<li>All other sub-forums below (Search bar of all sub-forums for easier
navigation around the site)</li>
<li>Highlight the currently selected sub-forum in the nav (So the user can
easily see where they are)</li>
</ul>
</li>
<li>Current sub-forum (Render selection message upon first load/after login when
no sub-forum is selected - gives first time user some helpful instructions on
what to do)
<ul>
<li>Give user sort selection (newest / most popular [This gives the user a
choice on how they wish to view the content])</li>
<li>Eventually make it so posts are loaded in dynamically (paginated)</li>
<li>Each post
<ul>
<li>Current amount of up votes (Shows popularity of post, which could be an
indication of how good the post is and if it is worth viewing)</li>
<li>Title -&gt; links to link/post</li>
</ul>
</li>
</ul>
</li>
<li>Selected post (Fills the space where the sub-forum was)
<ul>
<li>Title (So that the user can always see where they are)</li>
<li>Time Posted (This can give context of how relevant the content is [For
example, an older post may not be so up to date])</li>
<li>User that posted it (Could tell the user if the information is credible)</li>
<li>Amount of votes</li>
<li>Content</li>
<li>Comments (For discussion of the post, show message if empty)</li>
</ul>
</li>
</ul>
<a class="header" href="print.html#general-features" id="general-features"><h2>General Features</h2></a>
<ul>
<li>Login System
<ul>
<li>Account Creation / Sign-up (username, password)</li>
<li>Require login to post/comment (So that other users know who posted / said
what)</li>
</ul>
</li>
<li>Self governing voting system
<ul>
<li>Each user gets a single vote (up or down) for each post (like Reddit)</li>
<li>Posts with positive votes rise to the top (popularity sort)</li>
<li>Posts with negative votes go to the bottom (popularity sort)</li>
<li>Posts that get -25 (due to change) 'votes' are removed from the sub-forum
<ul>
<li>This point is the key to the self governing system, as the features before
it are borrowed from Reddit.</li>
<li>Theoretically, no matter how popular the sub-forum is, if more people like
the post that don't, the post will remain.</li>
<li>If more people dislike a post than like it (within the vote threshold)
then it will be removed automatically.</li>
<li>This means, that instead of a moderator moderating the sub-forum, the
users do it themselves. This comes back to the point for neutrality and
fairness, as the sub-forum community as a whole gets to decide what is
allowed on the sub-forum.</li>
</ul>
</li>
</ul>
</li>
<li>API
<ul>
<li>Use GraphQL</li>
<li>Setup the backend on graphcool</li>
</ul>
</li>
</ul>
<a class="header" href="print.html#computational-methods-required" id="computational-methods-required"><h1>Computational Methods Required</h1></a>
<p>Here is a list of computational methods that could be used to create Corum, as
well as how they will be useful.</p>
<a class="header" href="print.html#decomposition" id="decomposition"><h2>Decomposition</h2></a>
<p>By using <a href="https://vuejs.org/">Vue</a>, I will be able to break the UI down into
small, reusable components. This allows developers to create large projects
while keeping it manageable and maintainable. In the case of Corum, it would not
be manageable or maintainable to create the whole site in one large file. Not
only would it be a nightmare to work on, common code and components could not be
reused across different pages.</p>
<a class="header" href="print.html#abstraction" id="abstraction"><h2>Abstraction</h2></a>
<p>Also with the aid of <a href="https://vuejs.org/">Vue</a>, I will be able to compose large
components from multiple smaller components. This means that the complexity of
each component can be abstracted away when taking a high level view of the
composite components. For example, each page of the site will be considered its
own component, but it will contain many smaller components such as the
navigation component and a main content component.</p>
<a class="header" href="print.html#pattern-matching" id="pattern-matching"><h2>Pattern matching</h2></a>
<p>I will attempt to implement search functionality into the navigation part of the
application, this will require pattern matching. Also, as this project will make
use of client-side routing with
<a href="https://nuxtjs.org/api/components-nuxt-link">vue-router</a>, pattern matching is
required to direct the user to the correct page. For example, navigating to
<code>/subforum/:subforum</code> will render the subforum page component with the data from
the path variable <code>:subforum</code></p>
<a class="header" href="print.html#sorting-and-searching" id="sorting-and-searching"><h2>Sorting and searching</h2></a>
<p>Related to the method above, searching will be used as the subforum navigation
will be searchable. This will most likely be achieved by using a regex (Regular
expression), or a composition of built in javascript string methods. Sorting
will also be used, as the user will be able to select the order in which they
see posts in the sub-forum. This will most likely be handled on the server side,
as in the end, I will want the subforum post list to be paginated. This means
that a sort would require a re-fetch from the server, as the client will not
have all the data at once. Graphcool provides a 'orderBy' parameter in their
queries, so it will not be too complex to implement.</p>
<a class="header" href="print.html#use-of-multiple-programming-paradigms" id="use-of-multiple-programming-paradigms"><h2>Use of Multiple Programming Paradigms</h2></a>
<a class="header" href="print.html#declarative" id="declarative"><h3>Declarative</h3></a>
<p>Vue allow me to develop components as
<a href="https://vuejs.org/v2/guide/single-file-components.html">SFCs (Single File Components)</a>
This allows me to create my components declaratively and encapsulated, as the
HTML, JavaScript and CSS for that particular component will all be contained
within the single file. Also, as I am using Vue, I do not have to worry about
<em>how</em> my components will get rendered to the
<a href="https://en.wikipedia.org/wiki/Document_Object_Model">DOM (Document Object Model)</a>,
I just tell Vue <em>what</em> I want to render, and Vue will figure out the most
efficient way to do so.</p>
<a class="header" href="print.html#functional" id="functional"><h3>Functional</h3></a>
<p>Programming in a functional style helps improve code maintainability,
readability, and <a href="https://en.wikipedia.org/wiki/Functional_programming">more</a>.
Also, the project will be easier to test (Due to things such as pure functions
not having side effects, and function composition allows for better testing in
isolation [Unit testing])</p>
<p>JavaScript provides great tools to build software in a functional paradigm, this
includes features such as:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/First-class_function">First-class Functions</a> -
This means that JavaScript treats functions the same as any other variable.
Functions can be passed as arguments to functions, returned from functions,
assigned to variables and stored in objects and arrays.</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions">Arrow Functions</a> -
Allows for concise function declarations and clean
<a href="https://en.wikipedia.org/wiki/Currying">function currying</a>. For example:</li>
</ul>
<pre><code class="language-javascript">// Regular function expression - not curried
const concatRegular = function(string1, string2) {
  return `${string1} ${string2}`
}
const joinedTextRegular = concatRegular('Hello,', 'world!') // &quot;Hello, world!&quot;

// Arrow function expression - curried
const concatArrow = string1 =&gt; string2 =&gt; `${string1} ${string2}`
const joinedTextArrow = concatArrow('Hello')('world!') // &quot;Hello, world!&quot;
</code></pre>
<ul>
<li>Functional Array Methods
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map"><code>Array.prototype.map</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter"><code>Array.prototype.filter</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce"><code>Array.prototype.reduce</code></a></li>
</ul>
</li>
<li>Immutability
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const"><code>const</code></a>
(Not perfect, reference only so objects + arrays can be mutated, use</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/freeze"><code>Object.freeze</code></a>
(for both objects and arrays) or something like
<a href="http://facebook.github.io/immutable-js/">Immutable.js</a>)</li>
</ul>
</li>
</ul>
<a class="header" href="print.html#real-time-data-processing" id="real-time-data-processing"><h2>Real Time Data Processing</h2></a>
<p>I will implement real time search functionality for the navigation, as well as
possibly real time sub-forum updates like updating the current amount of votes
updates without a page refresh. This will be achieved through the use of
<a href="https://www.howtographql.com/vue-apollo/8-subscriptions/">GraphQL Subscriptions</a>.</p>
<a class="header" href="print.html#success-criteria" id="success-criteria"><h1>Success Criteria</h1></a>
<ul>
<li>The UI should resemble the layout seen in the
<a href="print.html#gui-design">GUI Design section</a></li>
<li>Users can click on subforums, and the site displays the subforum's posts.</li>
<li>Users can click on posts, and the site displays the content of the post.</li>
<li>Users can click on the <code>signup</code> button and signup to the site (Details saved
to backend)</li>
<li>Users can click on the <code>login</code> / <code>logout</code> button and login to / logout of the
site (Check details against the backend)</li>
<li>Logged in users can add &amp; remove subforums to their <code>favorites</code></li>
<li>Logged in users can vote on posts</li>
<li>Logged in users can comment on posts</li>
<li>Logged in users can create new posts</li>
<li>Posts are automatically deleted when a voting threshold is reached
<ul>
<li>This threshold will be something like when the votes reaches -10</li>
</ul>
</li>
</ul>
<a class="header" href="print.html#limitations-of-the-project" id="limitations-of-the-project"><h1>Limitations of the Project</h1></a>
<a class="header" href="print.html#account-recovery" id="account-recovery"><h2>Account Recovery</h2></a>
<p>If the user losses their email / password, they will not be able to recover it.
I am deciding not to include this feature, as this version of Corum is only a
prototype, and the creation of this feature is not essential, and it would take
quite a lot of time to get working.</p>
<a class="header" href="print.html#creation-of-new-sub-forums" id="creation-of-new-sub-forums"><h2>Creation of new sub-forums</h2></a>
<p>Unless I have time near the end of the project, I will not be implementing the
ability to add new sub forums. This can still be done manually by the owner of
the site, so it is not an essential feature to implement just yet.</p>
<a class="header" href="print.html#responsive-css" id="responsive-css"><h2>Responsive CSS</h2></a>
<p>Having responsive CSS would mean that the site would look good on both desktop
and mobile devices. As mentioned, this is just a prototype version of the site,
and as it is only a visual problem, it would be unwise to spend a lot of time
making it look good on mobile devices.</p>
<a class="header" href="print.html#hardware-and-software-requirements" id="hardware-and-software-requirements"><h1>Hardware and Software Requirements</h1></a>
<p>In the following subsections, I will explain both how to host and view the site.
These two use cases will require different software and hardware.</p>
<a class="header" href="print.html#hosting-the-site" id="hosting-the-site"><h2>Hosting the Site</h2></a>
<p>The project is based on a full JavaScript stack, so it is able to be developed
and deployed on any OS that Node.js supports. If you haven't already, download
Node Version 8+ <a href="https://nodejs.org/en/download/current/">here</a> and install it.
This will give access to Node and NPM (Node Package Manager). Now your system is
ready to develop and / or deploy Corum.</p>
<p>To get a copy of Corum on your local machine, clone this repo using the
following command (<a href="https://git-scm.com/">Git</a> must be installed):</p>
<pre><code class="language-bash">git clone https://github.com/joealden/corum.git
</code></pre>
<a class="header" href="print.html#development" id="development"><h3>Development</h3></a>
<p><a href="https://nuxtjs.org/">Nuxt</a> provides a pre-configured hot reloading dev server
(Using webpack-dev-server under the hood), which means I can save a file and see
the resulting change instantly in my browser. This dev server also provides an
in-browser error overlay, which allows for easier debugging.</p>
<p>To start the dev server, run the following commands:</p>
<pre><code class="language-bash">yarn
yarn dev
</code></pre>
<p>To view the site, navigate to <code>http://localhost:3000</code> in your browser.</p>
<a class="header" href="print.html#deployment" id="deployment"><h3>Deployment</h3></a>
<p>To start the production server, run the following commands:</p>
<pre><code class="language-bash">yarn
yarn deploy
</code></pre>
<a class="header" href="print.html#viewing-the-site" id="viewing-the-site"><h2>Viewing the Site</h2></a>
<a class="header" href="print.html#hardware" id="hardware"><h3>Hardware</h3></a>
<p>As mentioned in the section talking about the projects limitations, Corum will
be actively made compatible with mobile devices (Such as tablets and
smartphones), as it is currently only a prototype version. In the future, Corum
could be made to work on mobile devices as well. For this reason, it is
recommended that Corum is viewed on a desktop or laptop.</p>
<a class="header" href="print.html#software" id="software"><h3>Software</h3></a>
<p>As Corum is a website, any modern browser on any modern Operating System will
work. As I am using reasonably new features such as
<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Grid_Layout">CSS Grid Layout</a>,
it is recommended to view the site on the most up to date versions of Chrome,
Opera, Firefox or Edge. The reason I have chosen not to support older browsers
is because it would make the user experience of those using modern browsers
worse, as well as making it a lot harder to develop.</p>
<a class="header" href="print.html#other-software-information-about-the-project" id="other-software-information-about-the-project"><h2>Other Software Information about the Project</h2></a>
<a class="header" href="print.html#corums-backend" id="corums-backend"><h3>Corum's Backend</h3></a>
<p>I am planning to use <a href="https://www.graph.cool/">graphcool</a> as my API and user
authentication backend. Graphcool is a BaaS (Backend as a service) that combines
'serverless' (A service like AWS Lambda) and GraphQL (An API query language).</p>
<p>This will allow me to easily develop the client side of the application without
needing to worry about the implementation details of the GraphQL backend that it
fetches data from. Graphcool is a free to use service for small sites, as shown
<a href="https://www.graph.cool/pricing/">here</a>.</p>
<a class="header" href="print.html#libraries--tools-to-be-used" id="libraries--tools-to-be-used"><h3>Libraries / Tools To Be used</h3></a>
<p><strong>ALL</strong> of the code and technologies that will be used for this project are open
source.</p>
<ul>
<li><strong>Language</strong> - <a href="http://es6-features.org">ES2015</a> +
<a href="http://node.green/#ES2017">ES2017</a> (JavaScript)</li>
<li><strong>Runtime for development</strong> - <a href="https://nodejs.org">Node.js 8.x.x</a> and
<a href="https://www.google.com/chrome/browser/desktop/index.html">Chrome</a></li>
<li><strong>VCS
(<a href="https://en.wikipedia.org/wiki/Version_control">Version Control System</a>)</strong> -
<a href="https://git-scm.com/">Git</a> with <a href="https://github.com/joealden/corum">Github</a></li>
<li><strong>Package Manager</strong> - <a href="https://yarnpkg.com">Yarn</a></li>
<li><strong>Task Runner</strong> - <a href="https://docs.npmjs.com/misc/scripts">NPM Scripts</a></li>
<li><strong>Framework</strong> - <a href="https://nuxtjs.org/">nuxt</a></li>
<li><strong>View</strong> - <a href="https://vuejs.org/">Vue</a></li>
<li><strong>Data Fetching (GraphQL)</strong> -
<a href="https://github.com/Akryum/vue-apollo">Apollo Client</a></li>
<li><strong>Client-side Routing</strong> -
<a href="https://nuxtjs.org/api/components-nuxt-link">nuxt-link (vue-router)</a></li>
<li><strong>Module Bundler</strong> - <a href="https://webpack.js.org/">webpack</a></li>
<li><strong>JS Compiler</strong> - <a href="https://babeljs.io/">babel</a></li>
<li><strong>JS Linter</strong> - <a href="https://eslint.org/">ESLint</a></li>
<li><strong>Testing</strong> - <a href="https://facebook.github.io/jest/">Jest</a></li>
</ul>
<a class="header" href="print.html#design" id="design"><h1>Design</h1></a>
<p>In this section of the report, I will be doing the following:</p>
<ul>
<li>Coming up with what Corum's interface will look like</li>
<li>Thinking about how I can separate the interface into modules / components</li>
<li>Figuring out the best way to design and structure the API of Corum</li>
<li>Outlining the routes / different pages that Corum will have</li>
<li>Creating a test plan and data that will be used throughout development</li>
</ul>
<a class="header" href="print.html#gui-design" id="gui-design"><h1>GUI Design</h1></a>
<p>Here are some sketches that I have created for the GUI of Corum</p>
<a class="header" href="print.html#sub-forum-not-selected-logged-in-ui" id="sub-forum-not-selected-logged-in-ui"><h2>Sub-forum not selected (Logged in) UI</h2></a>
<p><img src="images/sub-forum-not-selected.jpg" alt="Sub-forum not selected" /></p>
<a class="header" href="print.html#sub-forum-selected-not-logged-in-ui" id="sub-forum-selected-not-logged-in-ui"><h2>Sub-forum selected (Not logged in) UI</h2></a>
<p><img src="images/sub-forum-selected.jpg" alt="Sub-forum selected" /></p>
<a class="header" href="print.html#post-view-logged-in-ui" id="post-view-logged-in-ui"><h2>Post view (Logged In) UI</h2></a>
<p><img src="images/post-view.jpg" alt="Post view" /></p>
<a class="header" href="print.html#new-post-ui" id="new-post-ui"><h2>New Post UI</h2></a>
<p><img src="images/new-post.jpg" alt="New post" /></p>
<a class="header" href="print.html#login-page-ui" id="login-page-ui"><h2>Login Page UI</h2></a>
<p><img src="images/login.jpg" alt="Login Page" /></p>
<a class="header" href="print.html#sign-up-page-ui" id="sign-up-page-ui"><h2>Sign-up Page UI</h2></a>
<p><img src="images/sign-up.jpg" alt="Sign-up Page" /></p>
<a class="header" href="print.html#component-design" id="component-design"><h1>Component Design</h1></a>
<p>As I am using <a href="http://vuejs.org">Vue</a> to build my UI, I can think of the site
being composed of individual components with isolated responsibilities. Here I
will define what each of these main component's roles are, and what they will
render when.</p>
<p><img src="images/component-design.jpg" alt="Component Design" /></p>
<a class="header" href="print.html#logo" id="logo"><h1>Logo</h1></a>
<p>This component will have the sole responsibility to render Corum's logo in the
top left of the page along side the header component. The logo will be a link to
<code>'/'</code> using
<a href="https://nuxtjs.org/api/components-nuxt-link">vue-router's Link component (nuxt-link)</a>.</p>
<a class="header" href="print.html#header" id="header"><h1>Header</h1></a>
<p>This component will have 2 different states. 1 for when the user is logged in,
and 1 for when they are not.</p>
<p>When the user is logged in, the component will render a greeting message, as
well as a <code>Logout</code> button. (As shown <a href="print.html#new-post">here</a>) When pressed, the
<code>Logout</code> button will execute a function that logs the user out of the site.</p>
<p>When the user is not logged in, the component will render 2 buttons. The 1st
button will be a <code>Sign Up</code> Link component that links to <code>'/signup'</code>. The 2nd
button will be a <code>Login</code> Link component that links to <code>'/login'</code>.</p>
<a class="header" href="print.html#navigation" id="navigation"><h1>Navigation</h1></a>
<p>This component will also have 2 different states like the Header component.</p>
<p>When the user is not logged in, only the <code>All sub-forums</code> section will render.
(As shown <a href="print.html#login-page">here</a>) This <code>All sub-forums</code> component will show all of
the sub-forums that Corum has with a search bar at the top. If the sub-forum
list is longer than the components height, it will scroll independently of the
page, with the search bar staying at the top of the navigation.</p>
<p>When the user is logged in, a <code>favorites</code> section will also be rendered above
the <code>All sub-forums</code> section. (As shown <a href="print.html#new-post">here</a>) The <code>favorites</code>
section will list the sub-forums that the user has added to their <code>favorites</code>. A
user can add a sub-forum to their favorites by clicking on the <code>+</code> icon next to
the sub-forum in the 'All sub-forums' section. The <code>+</code> icon is only rendered if
the user is logged in and the subforum is not already in their favorites. A user
can remove a sub-forum from their favorites by clicking the <code>-</code> sign next to the
sub-forum they wish to remove. The <code>favorites</code> section will be very similar to
the <code>All sub-forums</code> section, however it will not have a search bar.</p>
<p>Both the <code>favorites</code> and the <code>All sub-forums</code> section will be sorted
alphabetically so that it is easier to find a subforum.</p>
<p>Each sub-forum in both sections will be a Link component. They will link to a
sub-forum in the pattern <code>'/subforum/:subforum'</code>. (For example,
<code>'/subforum/programming'</code>)</p>
<a class="header" href="print.html#main-content" id="main-content"><h1>Main Content</h1></a>
<p>This component will handle nearly all of the client side routing (See
<a href="print.html#route-design">Route Design</a>). Whatever action a user takes, such as clicking
on a sub-forum, pressing the <code>Sign Up</code> or <code>Login</code> buttons, clicking on a post
within a sub-forum etc. (Shown in the <a href="print.html#gui-design">GUI Design section</a>)</p>
<a class="header" href="print.html#footer-and-social-links" id="footer-and-social-links"><h1>Footer and Social Links</h1></a>
<p><em>These two components have since been removed from the sites design, as I
thought it didn't have much of a benefit to the user.</em></p>
<a class="header" href="print.html#api-design" id="api-design"><h1>API Design</h1></a>
<p>As I have discussed in the analysis section of this report, I will be using
GraphQL to develop the API of Corum. If you haven't heard of GraphQL before,
putting it very simply, it is a more flexible and powerful alternative to REST
style APIs.</p>
<p>Some of the reasons I am using GraphQL to develop my API over REST are:</p>
<ul>
<li>It allows the server to define what data the client can access, and then the
client can choose the information it wants
<ul>
<li>This is unlike REST APIs, as they usually define API endpoints that are for
a single client (For example, the mobile site only)</li>
</ul>
</li>
<li>The way GraphQL is designed allows for a large tooling eco-system to be built
around it
<ul>
<li>For example, I will be using a GraphQL Client library called Apollo that
does things like caching and fetching automatically</li>
</ul>
</li>
<li>It is easier for the server to add and remove data that clients can access
without breaking existing client that depend on it</li>
</ul>
<p>If you would like to find out more about GraphQL, I recommend the following site
as a good resource to get started.
(<a href="https://www.howtographql.com/">howtographql.com</a>)</p>
<p>To more quickly develop a production standard GraphQL API, I will be using a
framework called Graphcool. The framework abstracts away some of the complexity
that comes with developing a GraphQL API, such as database management, data
access permissions etc. The best feature of graphcool is that is automatically
generated a CRUD (Create, Read, Update and Delete) interface to the schema
defined. This is very much like how an SQL database works, however instead of
using SQL, we use GraphQL to define what data we want. This allows me to
declaratively design my API, without having to think that much about how
everything works under the hood.</p>
<p>As well as abstracting away complexity, graphcool allows you to easily extend
its capabilities. For example, I will extend graphcool to do things such as
create and authorize users, initialize data so that the client doesn't have to,
(E.G. Set vote count of a new post to 0 automatically) and do some validation on
the data. (E.G. Ensure a user can only vote once on a single post)</p>
<p>For more information about graphcool, visit there website here.
(<a href="https://www.graph.cool/">graph.cool</a>)</p>
<a class="header" href="print.html#api-schema-data-structures" id="api-schema-data-structures"><h1>API Schema (Data Structures)</h1></a>
<p>In GraphQL, similar to SQL databases, the API has a schema. This schema is
defined in the GraphQL SDL. (Schema Definition Language) This allows me to
declaratively define the structure of my data.</p>
<p>As quoted from graphcool's website:</p>
<blockquote>
<p>The main components of a Schema Definition are the types and their fields.</p>
</blockquote>
<p>For example, the <code>Post</code> type will have a field such a <code>title</code>, that will be of
type <code>String</code>. Also:</p>
<ul>
<li>Field types such as <code>String</code> can be followed by an <code>!</code> (<code>String!</code>) to show
that a field is required</li>
<li>Arrays are specified by surrounding a type with <code>[]</code>. For example, an array of
strings would be specified by <code>[String]</code></li>
</ul>
<blockquote>
<p>Additional information can be provided as custom directives.</p>
</blockquote>
<p>For example, I could:</p>
<ul>
<li>Specify default values for a field using the <code>@default</code> directive</li>
<li>Specify that a field must be unique to all other data of the same type using
the <code>@isUnique</code> directive</li>
<li>Tell graphcool to generated the CRUD API for this type using the <code>@model</code>
directive</li>
<li>Tell graphcool that there is a relation between two fields (Like relations in
SQL) with the <code>@relation</code> directive
<ul>
<li>These can be <code>1-1</code>, <code>1-n</code>, or <code>n-n</code> relations</li>
<li>In my data, I will only be needing <code>1-1</code> and <code>1-n</code> mappings</li>
</ul>
</li>
</ul>
<p>To find out more information about GraphQL schemas, visit
<a href="https://www.graph.cool/docs/reference/database/data-modelling-eiroozae8u/">graph.cool</a>
and search the documentation for the section on 'Data Modelling'</p>
<a class="header" href="print.html#the-schema-for-corum" id="the-schema-for-corum"><h2>The Schema for Corum</h2></a>
<pre><code class="language-graphql">type User @model {
  id: ID! @isUnique
  username: String! @isUnique
  email: String! @isUnique
  password: String!
  posts: [Post!]! @relation(name: &quot;UserToPost&quot;)
  votes: [Vote!]! @relation(name: &quot;UserToVote&quot;)
  favorites: [Favorite!]! @relation(name: &quot;UserToFavorite&quot;)
}

type Subforum @model {
  id: ID! @isUnique
  url: String! @isUnique
  name: String!
  posts: [Post!]! @relation(name: &quot;SubforumToPost&quot;)
  favorites: [Favorite!]! @relation(name: &quot;SubforumToFavorite&quot;)
}

type Favorite @model {
  id: ID! @isUnique
  user: User! @relation(name: &quot;UserToFavorite&quot;)
  subforum: Subforum! @relation(name: &quot;SubforumToFavorite&quot;)
}

type Post @model {
  id: ID! @isUnique
  subforum: Subforum! @relation(name: &quot;SubforumToPost&quot;)
  title: String!
  author: User! @relation(name: &quot;UserToPost&quot;)
  content: String!
  voteCount: Int
  createdAt: DateTime!
  comments: [Comment!]! @relation(name: &quot;PostToComment&quot;)
  votes: [Vote!]! @relation(name: &quot;PostToVote&quot;)
}

type Comment @model {
  id: ID! @isUnique
  post: Post! @relation(name: &quot;PostToComment&quot;)
  author: String!
  content: String!
}

type Vote @model {
  id: ID! @isUnique
  post: Post! @relation(name: &quot;PostToVote&quot;)
  user: User! @relation(name: &quot;UserToVote&quot;)
  vote: VoteType!
}

enum VoteType {
  VOTE_UP
  VOTE_DOWN
}
</code></pre>
<p>Here is a graphical representation of the schema above:</p>
<p><img src="images/api-schema-graph-view.png" alt="Graph View of API Schema" /></p>
<a class="header" href="print.html#route-design" id="route-design"><h1>Route Design</h1></a>
<p>As Corum is a website, accessing different parts of the application is done by
routing (For example, clicking on links or altering the contents of the URL bar)
As mentioned before, I am using Vue as my view layer library. This means that I
can easily do client side routing using the accompanying library vue-router.
Client side routing is where the routing is done on the users machine. (More
information on this web development technique can be found by searching for
SPAs.
(<a href="https://en.wikipedia.org/wiki/Single-page_application">Single Page Applications</a>)
This is the opposite to server side routing that is common for sites developed
with PHP and no view library. Server side routing means loading entire new pages
from a server, instead of dynamically rewriting the current page.</p>
<p>As quoted from Wikipedia's article on SPAs:</p>
<blockquote>
<p>This approach avoids interruption of the user experience between successive
pages, making the application behave more like a desktop application.</p>
</blockquote>
<p>If you would like to find out more information about Vue, visit the
documentation at the following link. (<a href="https://vuejs.org/">vuejs.org</a>)</p>
<a class="header" href="print.html#route-summary" id="route-summary"><h1>Route Summary</h1></a>
<p>Here is a brief summary of what all of the different routes will do.</p>
<ul>
<li><a href="print.html#sub-forum-not-selected-logged-in-ui"><code>'/'</code></a> - Displays a user guide that
explains how the site works and how to do things.</li>
<li><a href="print.html#login-page-ui"><code>'/login'</code></a> - Displays a login screen (Username + password)</li>
<li><a href="print.html#sign-up-page-ui"><code>'/signup'</code></a> - Displays a sign up screen (Username +
password + password)</li>
<li><a href="print.html#sub-forum-selected-not-logged-in-ui"><code>'/subforum/:subforum'</code></a> - Displays the
posts from the selected sub-forum. (Using the <code>:subforum</code> variable)</li>
<li><a href="print.html#post-view-logged-in-ui"><code>'/subforum/:subforum/post/:post'</code></a> - Displays the
post selected. (Using the <code>:post</code> variable)</li>
<li><a href="print.html#new-post-ui"><code>'/subforum/:subforum/new'</code></a> - Displays the new post entry
fields.</li>
</ul>
<p>The following sections will describe each of these routes in more detail. Most
of the following sections will contains subsections about the design of the
client and the design of the server/backend. (API) If they do not have these
subsections, it will because all of the information is about the client, as no
server side processing is required.</p>
<a class="header" href="print.html#home-page" id="home-page"><h1>Home Page</h1></a>
<p>This is the page that the user sees when they first visit the site. (At the path
<code>'/'</code>) The home page will contain helpful information about how to use the site
such as how the site works and where to find things etc.</p>
<a class="header" href="print.html#login-page" id="login-page"><h1>Login Page</h1></a>
<a class="header" href="print.html#client-side" id="client-side"><h2>Client Side</h2></a>
<p>This is the page that the user will see when they visit the path <code>'/login'</code>.
This page could be accessed in 2 different ways. The first way would be type
physically type the path into the web browser's url bar. The second way would be
to click on the <code>login</code> button located in the header. This page will display a
form to the user to login. For the user to login, they must have first created
an account. (Which is done through the <code>signup</code> page)</p>
<p>The login form will contain the following:</p>
<ul>
<li>The Corum logo</li>
<li>An email address field</li>
<li>A password field</li>
<li>A login button</li>
<li>A message and link directing the user to the <code>signup</code> page if they do not
already have an account.</li>
</ul>
<p>The login button will only be enabled (clickable) if both an email address and a
password have been supplied.</p>
<p>If the user successfully logs in, they will be redirected back to the page they
were previously on before visiting the login page. If the user have an
unsuccessful login attempt, then the error returned by the GraphQL API will be
displayed to the user. After the error has been displayed, the user will be free
to try and login again.</p>
<p>After the user logs in, the rest of the site will update in response to the
state change. (From being logged out to being logged in) These state changes are
described in more detail in the <a href="print.html#component-design">Component Design</a> section.</p>
<p>This means the following:</p>
<ul>
<li>The header will render a greeting and logout button instead of the signup and
login buttons</li>
<li>The navigation will render the user's 'favorites' section and the 'all
subforums' section instead of just the 'all subforums' section</li>
<li>The user will now be allowed to create new posts and comments</li>
<li>The user will now be allowed to upvote and downvote posts</li>
</ul>
<p>After the site has updated to be in the 'logged in' state, the user will no
longer be able to click on a login button. However, this does not mean they
could not access the login page from the other way described above, via the url
bar in the browser. If the user could access the login page when already logged
in, this would not only be confusing to the user, it could cause bugs. To
prevent this issue, if a user visits <code>'/login'</code> when already logged in, then a
message will display telling them that they are already logged in.</p>
<a class="header" href="print.html#server-side" id="server-side"><h2>Server Side</h2></a>
<p>The graphcool framework doesn't provide a user authentication system out of the
box. Instead, I will have to create my own using Graphcool resolvers. As talked
about already, graphcool provides ways to extend its functionality. Resolvers
are one of many extension points that graphcool provides. Resolvers essentially
allow you to create custom GraphQL queries and mutations on top of the
auto-generated CRUD ones such as <code>allPosts</code>, <code>createPost</code> etc. To find out more
about Graphcool resolvers, visit the graphcool docs here.
(<a href="https://www.graph.cool/docs/reference/functions/resolvers-su6wu3yoo2">graph.cool/docs</a>)</p>
<p>To create a user authentication system, the resolver must do the following:</p>
<ul>
<li>Expose a GraphQL mutation called <code>authenticateUser</code></li>
<li>This mutation will have the following inputs and outputs:
<ul>
<li>Inputs:
<ul>
<li><code>email</code> -&gt; type String (The email of the user)</li>
<li><code>password</code> -&gt; type String (The password of the user)</li>
</ul>
</li>
<li>Outputs:
<ul>
<li><code>ID</code> -&gt; type ID (ids are generated by graphcool and are unique, the users
ID will be used to determine the state of the UI)</li>
<li><code>username</code> -&gt; type String (The username that is associated with the email
address entered. This is what other users see on posts and comments)</li>
<li><code>token</code> -&gt; type String (A JWT (JSON Web Token) that will be stored to be
later used to authenticate the user when making requests such as to create
a new post)</li>
</ul>
</li>
</ul>
</li>
<li>Check if a user with the email provided exists
<ul>
<li>If one does not, then return a generic error to the user saying something
such as 'Invalid credentials'. (Intentionally vague error message for
security reasons)</li>
</ul>
</li>
<li>Now that we have confirmed that the user exists, we can check if the user
entered the correct password for the user</li>
<li>Using a password hashing library (probably something like bcryptjs), hash the
password the user entered and compare the hash with the one stored on the
server
<ul>
<li>If they do not match, then return the same generic error of 'Invalid
credentials'</li>
</ul>
</li>
<li>If the hashes match, then we know that the user has entered both the correct
email and correct password</li>
<li>Now we can return the user the data that they requested.</li>
</ul>
<p>As mentioned briefly above, the <code>token</code> output is a JWT (JSON Web Token). JWTs
are extremely useful when dealing with stateless protocols such as HTTP. JWTs
can be used to verify that the client is who they say they are. In an
application such as Corum, users that are not logged in should not be allowed to
create new posts or new comments. By sending the JWT in the header of every HTTP
request to the GraphQL API, I can ensure that only logged in users can perform
actions such as creating new posts and comments. To find out more about JWTs,
visit the following link. (<a href="https://jwt.io/">jwt.io</a>)</p>
<p>Some of this will only make complete sense after reading through how Corum will
create the users in the first place. This is described in the section below.</p>
<a class="header" href="print.html#signup-page" id="signup-page"><h1>Signup Page</h1></a>
<a class="header" href="print.html#client-side-1" id="client-side-1"><h2>Client Side</h2></a>
<p>While the 'Login Page' section describes how the system will log the user into
the site, it doesn't say how users can create accounts. This will be done
through the signup page. Just like the login page, this page will be accessible
either by clicking on the <code>signup</code> button in the header, or from the url bar.
(At the path <code>'/signup'</code>) Also like the login page, the user will not be able to
visit the signup page if they are already logged in.</p>
<p>The signup form will contain the following:</p>
<ul>
<li>The Corum logo</li>
<li>An email address field</li>
<li>A username field</li>
<li>A password field</li>
<li>Another password field to verify that the user has type in their password
correctly (Verification will be needed to check that they are the same)</li>
<li>A signup button</li>
<li>A message and link directing the user to the <code>login</code> page if they already have
an account.</li>
</ul>
<p>The signup button will only be enabled (clickable) if an email address has been
entered and both password fields have matching data in.</p>
<p>If the user successfully creates an account, (If there are no errors with the
data they entered, for example, an error would be an incorrect email or a user
with the same email or username already exists) then not only will the account
have been created, they will also be logged into the site with the data that
they entered in the signup form. This means that the same state changes occur as
mentioned in the 'Login Page' section. (Ability to create posts, comments etc.)</p>
<a class="header" href="print.html#server-side-1" id="server-side-1"><h2>Server Side</h2></a>
<p>As mentioned in the 'Login Page' section, the graphcool framework doesn't
provide a user authentication system. Please read the 'Login Page' section for
more context of this subsection. (For information about resolvers etc.)</p>
<p>As well as the <code>authenticateUser</code> mutation that is created for the <code>login</code> page,
there will need to be a <code>signupUser</code> mutation to create an account.</p>
<p>Here is the algorithm for the <code>signupUser</code> resolver:</p>
<ul>
<li>Expose a GraphQL mutation called <code>signupUser</code></li>
<li>This mutation will have the following inputs and outputs:
<ul>
<li>Inputs:
<ul>
<li><code>email</code> -&gt; type String (The email address associated with the account that
will be used to login in the future)</li>
<li><code>username</code> -&gt; type String (The username of the user that will be displayed
to other users in things such as posts and comments)</li>
<li><code>password</code> -&gt; type String (The password that will be hashed and stored,
then checked against when the user logs in in the future)</li>
</ul>
</li>
<li>Outputs:
<ul>
<li><code>id</code> -&gt; type ID (ids are generated by graphcool and are unique, the user's
ID will be used to determine the state of the UI)</li>
<li><code>token</code> -&gt; type String (A JWT (JSON Web Token) that will be stored to be
later used to authenticate the user when making requests such as to create
a new post. For more information about JWTs, look at the 'Login Page'
section)</li>
</ul>
</li>
</ul>
</li>
<li>It will first verify for that the email address is valid (Using the library
<code>validator</code>)
<ul>
<li>If it is not a valid email, return an error to the user that the email is
invalid</li>
</ul>
</li>
<li>Now that we know the email address is valid, we must check if a user has
already registered with the same email address
<ul>
<li>If an account already uses this email address, return an error to the user
that the email address is already in use.</li>
</ul>
</li>
<li>Now that we know the email address is also not already taken, we must also
check if a user has already registered with the same username
<ul>
<li>If an account already uses this username, return an error to the user that
the username is already in use.</li>
</ul>
</li>
<li>Now that we know a user with either the same email address or username doesn't
exist, we can start creating the account.
<ul>
<li>First, we need to hash and salt the password before storing it, as storing
password in plain text isn't a good idea for obvious reasons.</li>
<li>Next, the user details actually need to be stored on the server, so a new
User type is created.
<ul>
<li>This User type contains the email address, username and hashed password,
as well things like the users generated ID.</li>
</ul>
</li>
</ul>
</li>
<li>Now we can return the user the data that they requested.</li>
</ul>
<a class="header" href="print.html#subforum-page" id="subforum-page"><h1>Subforum Page</h1></a>
<a class="header" href="print.html#client-side-2" id="client-side-2"><h5>Client Side</h5></a>
<p>Like any other page, there are two ways to access this page. The first way is to
navigate to it via the navigation on the left of the site. The second way is for
the user to enter the url of a subforum the already know exists (For example,
<code>'/subforum/test'</code>)</p>
<p>The way the client knows what subforum to fetch data for is by the path variable
<code>:subforum</code> that is in the url. This value can be accessed from within the
JavaScript of the page.</p>
<p>This page will show the posts that have been posted in the subforum. A visual
representation of the following information can also be found in the 'UI Design'
section.</p>
<p>This is what a subforum page will contain:</p>
<ul>
<li>The title of the subforum</li>
<li>A way to sort the posts (Two radio buttons):
<ul>
<li>Sort by most popular posts</li>
<li>Sort by newest posts</li>
</ul>
</li>
<li>A <code>New Post</code> button that will link to <code>'/subforum/:subforum/new'</code></li>
<li>Headers for each piece of data of a post:
<ul>
<li>The posts title</li>
<li>The time and date it was created at</li>
<li>The current vote count of the post</li>
</ul>
</li>
<li>A list containing the posts associated with the current subforum with the data
specified by the headers above</li>
<li>Each post will be a linked to <code>'/subforum/:subforum/post/:post'</code></li>
</ul>
<p>The <code>New Post</code> button will only be enabled (clickable) if the user is logged in,
otherwise, it will be greyed out. This is because a user should only be allowed
to create a post if they are logged in.</p>
<a class="header" href="print.html#server-side-2" id="server-side-2"><h5>Server Side</h5></a>
<p>As mentioned before, the GraphQL API exposes automatically generated queries and
mutations to perform CRUD operations. One of these exposed queries is called
<code>allPosts</code>. If I provide no parameters to the query, it will return every post
that exists on the whole site.</p>
<p>Two parameters that will be used to fetch the posts for a specific subforums
will be the following:</p>
<ul>
<li><code>filter</code>
<ul>
<li>This expects a data type of 'Subforum'</li>
<li>The way I will be filtering the data is by the 'url' field on the 'Subforum'
type.</li>
<li>This means that only the data that was posted on the subforum will be
returned</li>
</ul>
</li>
<li><code>orderBy</code>
<ul>
<li>This an enum called 'PostOrderBy'</li>
<li>This enum has values to sort by both descending ('DESC') and ascending
('ASC') of each field of 'Post'</li>
<li>The enum values that we are interested in are 'voteCount_DESC' and
'createdAt_DESC'</li>
</ul>
</li>
</ul>
<p>The client will pass the path variable mentioned above (<code>:subforum</code>) as the
value for <code>filter</code>.</p>
<p>By default, the sort will be by vote count ('voteCount_DESC'). When the user
switches between the two sort types, the query will be resent to the server with
the different enum value. This means that graphcool abstracts away the sorting
functionality, meaning that I don't have to implement it myself.</p>
<a class="header" href="print.html#post-page" id="post-page"><h1>Post Page</h1></a>
<a class="header" href="print.html#client-side-3" id="client-side-3"><h2>Client Side</h2></a>
<p>Other than from the url bar of the browser, the user can access a post by
following a link provided on the subforum page.</p>
<p>As shown by this pages route, it has two path variables, <code>:subforum</code> and
<code>:post</code>. The client will use these variables to construct a GraphQL query that
will be sent to Corum's API. It is important to note that a post may only belong
to a single subforum.</p>
<p>The post page will contain:</p>
<ul>
<li>The post title</li>
<li>The username of the post's author</li>
<li>The time the post was created at (In the format <code>HH:mm - DD/MM/YY</code>)
<ul>
<li><code>H</code> = Hours</li>
<li><code>m</code> = Minutes</li>
<li><code>D</code> = Day</li>
<li><code>M</code> = Month</li>
<li><code>Y</code> = Year</li>
</ul>
</li>
<li>The main body / the content of the post</li>
<li>The current vote status of the post. The number will be:
<ul>
<li>Green when the vote is positive (&gt;= 1)</li>
<li>Red when the vote is negative (&lt;= -1)</li>
<li>White when the vote is neutral (0)</li>
</ul>
</li>
<li>An upvote and a downvote button</li>
<li>A comment section that will contain:
<ul>
<li>A title of 'comments' with a count of the current amount of comments</li>
<li>A list of comments. Each comment will contain:
<ul>
<li>The content of the comment</li>
<li>The author of the comment</li>
</ul>
</li>
</ul>
</li>
<li>A 'New Comment' section that will contain:
<ul>
<li>A text area to entered the content of the new comment
<ul>
<li>This will need to be validated so it cannot be empty, and possibly not too
long</li>
</ul>
</li>
<li>A 'Post Comment' button that will submit the comment</li>
</ul>
</li>
</ul>
<p>If the user is not logged in, the following will happen to the page:</p>
<ul>
<li>The upvote and downvote button will be greyed out as only logged in users can
vote</li>
<li>The 'New Comment' section will be completely removed, as only logged in users
can post comments</li>
</ul>
<a class="header" href="print.html#server-side-3" id="server-side-3"><h2>Server Side</h2></a>
<p>The CRUD API generated by graphcool exposes a way to retrieve a single item of
data by passing a parameter that identifies an item of data to be unique. For
the post page, we will want to retrieve a single item of data of type <code>Post</code>, a
single post. The only field on the Post type that can be used to uniquely
identify a post is the <code>id</code> field. This is easy enough to retrieve as the posts
id is the path variable <code>:post</code>. From having the post's id, the client can now
retrieve all of the data needed to view a post.</p>
<a class="header" href="print.html#new-post-page" id="new-post-page"><h1>New Post Page</h1></a>
<a class="header" href="print.html#client-side-4" id="client-side-4"><h2>Client Side</h2></a>
<p>This page is accessible from every subforum via the 'New Post' button. The
subforum page generates this link based on its own <code>:subforum</code> path variable.
(For example, the 'New Post' button on the 'programming' subforum will link to
<code>/subforum/programming/new</code>)</p>
<p>The reason this page is specific subforum is for the following reasons:</p>
<ul>
<li>A post belongs to a single subforum, so it wouldn't make sense to make it a
generalized page</li>
<li>By making it specific to a certain subforum, the page knows what subforum to
add the post to</li>
<li>In the future, there could possibly be a 'New Subforum Page' at the path
<code>/subforum/new</code></li>
</ul>
<p>The new post page will contain:</p>
<ul>
<li>The page title ('New Post')</li>
<li>A text box for the new post's title to be entered</li>
<li>A text area for the new post's content to be entered</li>
<li>A 'Create Post' button that submits the post</li>
</ul>
<p>To submit a post, both the post title and post content fields must be filled in.
When a post has been created, the site will redirect the user to the new post.</p>
<p>Now this post will be be:</p>
<ul>
<li>Available in the corresponding subforum page</li>
<li>Able to be upvoted and downvoted</li>
<li>Able to be commented on</li>
</ul>
<p>As mentioned in the 'Subforum page' section, the 'New Post' button will be
disabled to users that are not logged in. However, a user that is not logged in
could still visit the page via the url bar. If a user that is not logged in does
this, the page should display a message to the user telling them they are not
logged in.</p>
<a class="header" href="print.html#server-side-4" id="server-side-4"><h2>Server Side</h2></a>
<p>The CRUD API generated by graphcool exposes a way to create new items of data
through a GraphQL mutation. These mutations are called <code>createType</code>. 'Type' in
this case is <code>Post</code>, so the mutation is called <code>createPost</code>. The 4 pieces of
data that this mutation in particular takes is <code>subforum</code>, <code>title</code>, <code>authorId</code>
and <code>content</code>.</p>
<p>These pieces of data are all available to the client when they send a request:</p>
<ul>
<li><code>subforum</code> can be found in the <code>:subforum</code> path variable</li>
<li><code>title</code> can be found in the text box on the page</li>
<li><code>content</code> can be found in the text area on the page</li>
<li><code>authorId</code> can be found in the clients local storage, as it was stored when
the user logged in</li>
</ul>
<a class="header" href="print.html#error-page" id="error-page"><h1>Error Page</h1></a>
<p>In development, these error pages will give detailed error messages for
debugging purposes, however in production, showing these details error messages
may be of use to malicious users. For this reason, when in production mode,
Corum will show helpful messages for the following situations:</p>
<ul>
<li>They attempt to visit a subforum that doesn't exist</li>
<li>They attempt to visit a post that doesn't exist</li>
<li>They attempt to visit any other route that doesn't exist</li>
</ul>
<p>If an unhandled error occurs, a generic error will be displayed to not give any
information to a malicious users that could result in an exploit.</p>
<a class="header" href="print.html#testing" id="testing"><h1>Testing</h1></a>
<p>This section outlines how I will aim to test the project during and after the
development phase of the project. This including what linter I will use to catch
syntax errors, my test plan along with the data to use with it, as well as a
section on how I will aim to automated this testing.</p>
<a class="header" href="print.html#linter" id="linter"><h1>Linter</h1></a>
<p>During development, I will be using a utility called a linter. A linter is able
to statically analyse code and print out warnings and errors to the programmer.</p>
<p>A linter can catch errors such as:</p>
<ul>
<li>Using a variable that is not defined</li>
<li>Missing a bracket (For example, in an if statement or in a function call)</li>
<li>Attempting to reassign a constant</li>
<li>Incorrect formatting (For example, using tabs instead of spaces)</li>
</ul>
<p>As I am using JavaScript, I will be using the current most popular linter called
ESLint.</p>
<p>As quoted from ESlint's website:</p>
<blockquote>
<p>The pluggable linting utility for JavaScript</p>
</blockquote>
<p>The reason ESLint has been so popular is the fact that it is 'pluggable'. This
means that it can be easily customised. In the context of a linter, this means
that rules can be turned off and on easily. For example, I prefer not to use
semicolons in JavaScript, so I can just tell ESLint to enforce that rule. This
makes it extremely powerful, as I can define exactly what I want it to warn me
about.</p>
<p>While this isn't exactly testing, it does help me catch and prevent potential
errors that could result in bugs.</p>
<a class="header" href="print.html#test-plan" id="test-plan"><h1>Test Plan</h1></a>
<p>To test that Corum is working as expected, the 'Success Criteria' list found in
the analysis section of the report needs to be met.</p>
<p>This included the following:</p>
<ul>
<li>The UI should resemble the layout seen in the
<a href="print.html#gui-design">GUI Design section</a></li>
<li>Users can click on subforums, and the site displays the subforum's posts.</li>
<li>Users can click on posts, and the site displays the content of the post.</li>
<li>Users can click on the <code>signup</code> button and signup to the site (Details saved
to backend)</li>
<li>Users can click on the <code>login</code> / <code>logout</code> button and login to / logout of the
site (Check details against the backend)</li>
<li>Logged in users can add &amp; remove subforums to their <code>favorites</code></li>
<li>Logged in users can vote on posts</li>
<li>Logged in users can create new posts</li>
<li>Logged in users can comment on posts</li>
</ul>
<p>If all of these tests pass, then the site is verified to be in working order.
All of these tests should be done many time during the iterative development
process, and then once gain once development has finished.</p>
<p>I will write automated tests so that I can ensure the site works quickly.</p>
<a class="header" href="print.html#test-data" id="test-data"><h1>Test Data</h1></a>
<p>For some of the items listed about in the test plan, test data is required. In
the following subsections, the items that required test data are given relevant,
justified test data. The items that are not covered below cannot be given test
data, and they instead rely on testing using a web browser / 'end to end'
testing. (Explained later on)</p>
<a class="header" href="print.html#creating-a-user" id="creating-a-user"><h2>Creating a User</h2></a>
<p>To properly test the account creation implementation, I will need to test what
happens when the following occurs:</p>
<ul>
<li>A valid, not already taken email and / or username are given</li>
<li>A valid, already taken email is given</li>
<li>An already taken username is given</li>
<li>An invalid email is given</li>
</ul>
<p>When testing the situation where a not already taken email or username are
given, I need to ensure beforehand that no entries exist with the used test
data, otherwise the test might fail when it shouldn't.</p>
<p>The following data will be used:</p>
<ul>
<li>A valid email - <code>test@test.com</code></li>
<li>Invalid emails - <code>test@</code>, <code>test</code>, <code>@test</code>, <code>@test.com</code>, <code>@</code></li>
</ul>
<p>This data ensures that edge cases like some of those above (For example, <code>test@</code>
or <code>@test.com</code>) are not allowed into the system.</p>
<a class="header" href="print.html#logging-in-a-user" id="logging-in-a-user"><h2>Logging in a User</h2></a>
<p>To properly test the account authentication implementation, I will need to test
what happens when the following occurs:</p>
<ul>
<li>An existing email and correct password are given</li>
<li>An existing email and incorrect password are given</li>
<li>An email that doesn't exist is given</li>
</ul>
<p>Just like when testing the creation of a user, I need to ensure beforehand that
when testing that giving the correct details works, the user exists on the
server. Likewise, I need to ensure that the user doesn't exist when testing
failing login attempts.</p>
<p>The following data will be used:</p>
<ul>
<li>An existing set of details:
<ul>
<li>Email - <code>exists@test.com</code></li>
<li>Password - <code>exists123</code></li>
</ul>
</li>
<li>An incorrect email - <code>nothing@test.com</code></li>
<li>An incorrect password - <code>nothing321</code></li>
</ul>
<a class="header" href="print.html#creating-a-post" id="creating-a-post"><h2>Creating a Post</h2></a>
<p>To properly test the new post page, I will need to give it data that is varied
in length. This is because I need to test how the post page will handle titles
and content of different sizes.</p>
<p>The following data will be used:</p>
<ul>
<li>Short title - <code>testing title</code></li>
<li>Short content - <code>testing content</code></li>
<li>Long title -
<code>This is quite a long title that will be used for testing purposes to verify the post page displays it correctly</code></li>
<li>Long content (From randomtextgenerator.com) -
<code>Unwilling sportsmen he in questions september therefore described so. Attacks may set few believe moments was. Reasonably how possession shy way introduced age inquietude. Missed he engage no test of. Still tried means we aware order among on. Eldest father can design tastes did joy settle. Roused future he ye an marked. Arose mr rapid in so vexed words. Gay welcome led add lasting chiefly say looking. Is allowance instantly strangers applauded discourse so. Separate entrance welcomed sensible laughing why one moderate shy. We seeing piqued garden he. As in merry at forth least ye stood. And cold sons yet with. Delivered middleton therefore me at. Attachment companions man way excellence how her pianoforte. Oh to talking improve produce in limited offices fifteen an. Wicket branch to answer do we. Place are decay men hours tiled. If or of ye throwing friendly required. Marianne interest in exertion as. Offering my branched confined oh test. Dispatched entreaties boisterous say why stimulated. Certain forbade picture now prevent carried she get see sitting. Up twenty limits as months. Inhabit so perhaps of in to certain. Sex excuse chatty was seemed warmth. Nay add far few immediate sweetness earnestly dejection.</code></li>
</ul>
<a class="header" href="print.html#creating-a-comment" id="creating-a-comment"><h2>Creating a Comment</h2></a>
<p>To properly test the creation of a comment, I will need to give it data that is
varied in length. This is because I need to test how the post page will handle
comments of different sizes.</p>
<p>The following data will be used:</p>
<ul>
<li>Short comment - <code>testing comment</code></li>
<li>Long comment (From randomtextgenerator.com) -
<code>Unwilling sportsmen he in questions september therefore described so. Attacks may set few believe moments was. Reasonably how possession shy way introduced age inquietude. Missed he engage no test of. Still tried means we aware order among on. Eldest father can design tastes did joy settle. Roused future he ye an marked. Arose mr rapid in so vexed words. Gay welcome led add lasting chiefly say looking.</code></li>
</ul>
<a class="header" href="print.html#automated-testing" id="automated-testing"><h1>Automated Testing</h1></a>
<p>These are the following types of tests I will write:</p>
<ul>
<li>Unit Tests</li>
<li>Integration Tests</li>
<li>End to End Tests (e2e)</li>
</ul>
<p>I will be using the following software to automate my testing:</p>
<ul>
<li><a href="https://facebook.github.io/jest/">Jest (For unit and integration testing)</a></li>
<li><a href="https://www.cypress.io/">Cypress (For e2e testing)</a></li>
</ul>
<p>The following subsections will describe what each of these types of test are,
and examples of where they could be used.</p>
<a class="header" href="print.html#unit-testing" id="unit-testing"><h2>Unit Testing</h2></a>
<p>Unit testing is where individual parts (units) of a program are tested in
isolation. For example, a single function or a single class method could be
considered a unit, and tested on its own. Sometimes, to test a unit in a
predictable way, its inputs and outputs (IO) may need to be whats called
'mocked' (faked).</p>
<p>Examples of mocking include the following:</p>
<ul>
<li>File system reads and writes</li>
<li>Database reads and writes</li>
<li>Network interactions</li>
</ul>
<p>All of the above examples could fail and cause an error without the unit in
question being at fault.</p>
<p>For example:</p>
<ul>
<li>The OS might prevent a file from being written to or read from because its
permissions have been changed or the file is locked by another program</li>
<li>Database reads and writes require a database to be running, and for it to be
consistent, it needs to be in the same state for every test</li>
<li>The network connection may be disconnected, or it may be really slow, these
factors could both effect the outcome of a test</li>
</ul>
<p>It is evident from the examples above that mocking is about keeping
uncontrollable / unpredictable state predictable and consistent.</p>
<a class="header" href="print.html#advantages" id="advantages"><h3>Advantages</h3></a>
<ul>
<li>Relatively easy and quick to write</li>
<li>Quick to run</li>
<li>Allows safer refactors</li>
<li>Simplifies writing integration tests</li>
</ul>
<a class="header" href="print.html#disadvantages" id="disadvantages"><h3>Disadvantages</h3></a>
<ul>
<li>Does not necessarily represent how the program will act in the real world</li>
<li>Can be difficult to draw the line of what to test and what not to test (Should
simple units be left out of code coverage?)</li>
</ul>
<a class="header" href="print.html#example" id="example"><h3>Example</h3></a>
<p>An easy unit test to write would be the validation that happens on certain
pages.</p>
<p>For example, the signup page will have a validation function to check the
following:</p>
<ul>
<li>An email address has been entered</li>
<li>A username has been entered</li>
<li>The first password field has been entered</li>
<li>The second password field has been entered</li>
<li>The first and second password fields match</li>
</ul>
<p>The function would expect the following inputs:</p>
<ul>
<li>Email address</li>
<li>Username</li>
<li>Password 1</li>
<li>Password 2</li>
</ul>
<p>The function would return the following output:</p>
<ul>
<li>boolean true if all is valid</li>
<li>boolean false if something is not valid</li>
</ul>
<p>In this case, I could test for the following:</p>
<ul>
<li>Call the function with inputs that should work and test that true is returned.</li>
<li>Call the function with inputs that shouldn't work and test that false is
returned.</li>
<li>Call the function with edge case inputs such as a password containing only
spaces.</li>
</ul>
<a class="header" href="print.html#integration-testing" id="integration-testing"><h2>Integration Testing</h2></a>
<p>While unit testing is testing in isolation, integration testing is testing that
units work together. This type of testing is usually done after unit testing.
The reason for this is that it is easier to narrow down bugs as they happen if
the unit tests are known to pass.</p>
<a class="header" href="print.html#advantages-1" id="advantages-1"><h3>Advantages</h3></a>
<ul>
<li>They can find issues with a system that unit tests alone cannot</li>
<li>The test cases are closer to how the code is actually executed in production</li>
</ul>
<a class="header" href="print.html#disadvantages-1" id="disadvantages-1"><h3>Disadvantages</h3></a>
<ul>
<li>Writing them properly is harder than writing unit tests</li>
</ul>
<a class="header" href="print.html#example-1" id="example-1"><h3>Example</h3></a>
<p>An example of a possible integration for Corum would be testing that the UI
state is correct depending on the logged in state.</p>
<p>These are couple of things that are supposed to happen when a user is logged in:</p>
<ul>
<li>The header should display the username of the user that is logged in, and a
logout button</li>
<li>A 'favorites' section should be visible in the navigation along with the 'All
Subforums' section</li>
</ul>
<p>In this example, these are the steps that would have to happen in this
integration test:</p>
<ul>
<li>The global state store would have to be queried in order to test that a user
is logged in</li>
<li>The UI would have to be checked that it is in the correct state depending on
what is currently in the store</li>
</ul>
<p>As evident from above, this tests requires that multiple units are working
together to provide the correct output.</p>
<a class="header" href="print.html#end-to-end-testing" id="end-to-end-testing"><h2>End to End Testing</h2></a>
<p>As suggested by the name, end to end testing (e2e) is where a complete user
story is tested.</p>
<p>In the case of a website, the following would be considered e2e testing: A
button is pressed, which sends a message to the server, and the server responses
with another message.</p>
<p>In this example, the following sub-systems are tested</p>
<ul>
<li>The user interface</li>
<li>The client side logic</li>
<li>The server side logic</li>
</ul>
<p>The following could also be tested depending on the test:</p>
<ul>
<li>A database action, such as reading or writing</li>
<li>The server querying another server and getting the correct response</li>
</ul>
<p>By testing all of these sub-systems, these tests ensure that when the code is
put into production, it will work as intended. Also, it is important to note
that e2e tests can be made up of 1 or more integration tests.</p>
<a class="header" href="print.html#advantages-2" id="advantages-2"><h3>Advantages</h3></a>
<ul>
<li>Tests an entire user story, which means that it is as close to what the user
will experience as possible</li>
</ul>
<a class="header" href="print.html#disadvantages-2" id="disadvantages-2"><h3>Disadvantages</h3></a>
<ul>
<li>Writing them properly is even harder than writing good integration tests</li>
</ul>
<a class="header" href="print.html#example-2" id="example-2"><h3>Example</h3></a>
<p>An example of a possible e2e test for Corum would be testing the entire user
login flow.</p>
<p>This is what is suppose to happen when the user goes to login:</p>
<ul>
<li>The user visits the login page at <code>'/login'</code></li>
<li>They fill out both the email and password field</li>
<li>The client sends a message to the API server requesting to authenticate them</li>
</ul>
<p>If the details are not correct:</p>
<ul>
<li>The server sends an error response to the client</li>
<li>The client displays the error message to the user</li>
<li>The client allows the user to try again</li>
</ul>
<p>If the details are correct:</p>
<ul>
<li>The server sends back the data the client requested</li>
<li>The client stores the the data sent back from the server</li>
<li>The UI updates to reflect this change (Now in a logged in state)</li>
</ul>
<a class="header" href="print.html#implementation" id="implementation"><h1>Implementation</h1></a>
<a class="header" href="print.html#todo" id="todo"><h2>TODO</h2></a>
<ul>
<li>Relate implementation back to design and user requirements</li>
<li>Put new subforum page in design</li>
</ul>
<hr />
<p>In this section of the report, I will be doing the following:</p>
<ul>
<li>Creating a more detailed description of the structure of Corum as a whole</li>
<li>Documenting the iterations of the development phase</li>
<li>Explaining the problems that I experienced during development</li>
<li>Analysing both the client and API code of Corum</li>
</ul>
<a class="header" href="print.html#structure-of-the-project" id="structure-of-the-project"><h1>Structure of the Project</h1></a>
<p>In this section I will be talking about how the structure of Corum started off,
how it changed over time, and how it ended up.</p>
<p>This section is split into three sub sections:</p>
<ul>
<li>'Monolith vs Micro' - This is where I talk about how the structure of Corum
changed over time.</li>
<li>'Client' - This is where I give an overview of how the client side of the
project is structured in its final form.</li>
<li>'API' - This is where I give an overview of how the API of the project is
structured in its final form.</li>
</ul>
<a class="header" href="print.html#monolith-vs-micro" id="monolith-vs-micro"><h1>Monolith vs Micro</h1></a>
<a class="header" href="print.html#at-the-start-of-development" id="at-the-start-of-development"><h2>At the Start of Development</h2></a>
<p>At the start of the project, I was pretty certain that I would develop both the
client and the API as one project. This kind of structure is very common when
developing with languages such as PHP. This kind of structure is known as a
'monolith system'.</p>
<p>This structure has the benefit of being conceptually simpler to think about and
easier to actually implement. However, monolith projects do have their
drawbacks. It is harder to test conceptually different components of a system as
they are typically tightly coupled, and it is harder to make large refactors as
the changes might break other parts of the system.</p>
<p>Developing in a 'micro service' mindset lends to code being more testable and
reusable, as components of a system that are conceptually separate are developed
in isolation from each other, meaning that tight coupling of components is
avoided at a management level. It also adheres more to the idea of 'separation
of concerns', as conceptually in the context of Corum, the API doesn't need any
knowledge of the client, it only needs to provide a generic interface to the
data the client needs.</p>
<p>Another benefit of developing micro services are that the services can be
deployed separately, even on different machines. This is a benefit because with
a monolith system, if the machine running it fails for whatever reason, and no
redundancy is in place, the whole system goes down. The way to provide
redundancy to a monolith system is to deploy multiple instances of the whole
system, or to boot an instance when another goes down. This could be less than
ideal because it may be using more system resources than needed, and it could
take longer for the whole system to start up, instead of a single micro service.</p>
<p>Deploying micro services means that different parts of the system can be
provided redundancy independently of each other. This could mean that less
system resources are wasted, and start up times are likely to be faster, meaning
that the system is down for a shorter period of time.</p>
<p>For these reasons above, I decided, during the development of the project, that
I would split the client and the API into separate services.</p>
<a class="header" href="print.html#implementing-the-micro-service-architecture" id="implementing-the-micro-service-architecture"><h2>Implementing the Micro Service Architecture</h2></a>
<p>As mentioned above, implementing a monolith system is easier to start, but it
tends to be harder to maintain. I found that during the implementation of Corum
in a micro service architecture that testing and documenting it was much easier.
I believe this was because I only had to think about part of the system at a
single moment in time, reducing the cognitive load that was placed on me.</p>
<a class="header" href="print.html#configuration-is-made-easier" id="configuration-is-made-easier"><h3>Configuration is Made Easier</h3></a>
<p>I also found that when I begun separating the two logical parts of Corum,
configuring the tools and libraries that I was using was much simpler. This was
because I didn't have to think as much about if a configuration setting would
cause a conflict. Configuration files were also a lot shorter, so therefore more
understandable at a glance. In the following sub sections I will give concrete
examples of where switching to a micro service architecture made configuring my
tools easier.</p>
<a class="header" href="print.html#eslint-my-linter" id="eslint-my-linter"><h4>ESLint (My Linter)</h4></a>
<p>For example, the configuration for ESLint (My linter of choice) that I am using
is different for the client and the API. This is because the two run in
different environments. The client code runs in the browser and the API code
runs on the server. (In the node.js runtime) While browsers and node.js both use
JavaScript, they support a different set of features as well as exposing
different global variables. For example, if I tried to use node's CommonJS
'<code>require</code>' syntax (used to import files into the current file scope) in the
browser, an error would be thrown because there is no global called '<code>require</code>'.
Likewise, if I tried to reference the '<code>document</code>' browser global in a node
environment, an error would also be thrown.</p>
<p>This relates to linting because if I was create Corum as a monolith, the ESLint
config would have to be quite permissive, where syntax and globals valid in both
environments would be allowed. This would have reduced the effectiveness of the
linter because if I did make a mistake like the two mentioned above, it wouldn't
be picked up by the linter. This would mean that I would only find this bug at
runtime, meaning that I would have wasted time that wouldn't have been wasted if
I had a stricter linter configuration.</p>
<p>The problem could be mitigated slightly by having separate directories for both
the client and server, then creating a config file per directory. This would
allow for stricter linting, however it would mean that my editor would not be
able to recognise the configuration file. This means that I wouldn't get the
errors showing in my editor, and I would have to instead rely on running the
linter from the command line. Also, if I wanted to work on both projects at the
same time, I would have to start two instances of the linter for each directory.</p>
<p>This problem wasn't present when I switch over to a micro service architecture.
This was because I could have two separate config files at the root of each
service. This means that my editor correctly picks up both the config files and
I could still have strict configs for the different services.</p>
<a class="header" href="print.html#gitignore-file" id="gitignore-file"><h3><code>.gitignore</code> File</h3></a>
<p>I am using version control to manage my project, in particular, Git. The reason
for this is explained in a section later on named 'Version Control'. When using
git you can create a file called '<code>.gitignore</code>' at the root of the repository.
This file tells git what files not to parse for changes. This means that the
files listed in this file are not committed to the repo. It also allows you to
list directories so that entire directories can be ignore, as well as the use of
a wildcard character (<code>*</code>) for pattern matching file names. For example, if you
didn't want to commit an files with the <code>.txt</code> extension, you could list <code>*.txt</code>
as an entry in the file.</p>
<p>When developing Corum as a monolith, the issue was that I wanted to ignore
certain types of files in the client but not in the API and vice versa. This
problem was solved when switching to a micro service architecture because the
client and the API are completely separate git repos, so they can have separate
<code>.gitignore</code> files.</p>
<a class="header" href="print.html#editor-configuration-files" id="editor-configuration-files"><h3>Editor Configuration Files</h3></a>
<p>The editor that I am using is Visual Studio Code. (vscode) Vscode allows you to
configure workspace settings for different projects, this includes things such
as recommended editor extensions and their settings. These settings can be found
at the root of the project under a directory called '<code>.vscode</code>'. The API and
client use different libraries, so they would benefit from different editor
extensions. However it wouldn't make much sense to recommend an extension that
is not useful for what it being used. For example, it wouldn't make sense to
recommend any Vue related extensions for the API code, as it doesn't use Vue. By
using a micro service architecture I can have separate configurations for each
service.</p>
<a class="header" href="print.html#packagejson-file" id="packagejson-file"><h3><code>package.json</code> File</h3></a>
<p>The <code>package.json</code> file is standard across JavaScript and used to provide
information about the project. For example, you can list the project's name,
version, author and it's dependencies. This information is used by tools that
will be explained soon.</p>
<p>To automate some of the tasks that I do often, I use something called a task
runner. The task runner I am using for corum is called NPM scripts, and it comes
with my package manager by default. I could have used a different task runner
such as gulp but it would have introduced more complexity to the project for not
much gain. All NPM scripts does is run the commands that you specify with a few
nice features. The way you configure NPM scripts is by adding a <code>&quot;scripts&quot;</code>
field to <code>package.json</code>.</p>
<p>Here is a simple example:</p>
<pre><code class="language-json">{
  &quot;scripts&quot;: {
    &quot;start&quot;: &quot;node .&quot;,
    &quot;test&quot;: &quot;jest&quot;,
    &quot;deploy&quot;: &quot;yarn test &amp;&amp; yarn start&quot;
  }
}
</code></pre>
<p>In this contrived example, the usefulness of NPM scripts is not very evident at
first glance. Here is what each of these scripts do and how they show the
usefulness of NPM scripts when building coding in JavaScript:</p>
<a class="header" href="print.html#start" id="start"><h4><code>&quot;start&quot;</code></h4></a>
<p>Runs the file named <code>index.js</code> in the root of the project. In practice, this
could be used to start something like a web server. Also in practice this
command could be a lot more complicated, for example command line flags could be
passed to alter how the program runs. This shows one of the benefits of using
scripts. The user only has to type a short command such as <code>yarn start</code> to run
an arbitrarily long command. This reduces both time taken to execute a task as
well as making it so the developer doesn't have to remember a long command every
time they want to run it.</p>
<a class="header" href="print.html#test" id="test"><h4><code>&quot;test&quot;</code></h4></a>
<p>Runs tests using a testing framework called 'jest'. The testing library would be
installed as a local dependency to the project, meaning that if the user just
typed <code>jest</code> into their command line, it would return an error because the
command isn't available in the global context. (Unless they explicitly installed
it globally on their system which wouldn't make the project very portable) What
NPM scripts is doing is adding the path '<code>./node_modules/.bin</code>' to its PATH
environment variable. (This is how it work on Unix like system at least) If NPM
scripts didn't add this path, then user would have to write
<code>./node_modules/.bin/jest</code> instead of just <code>jest</code>. This NPM scripts feature
makes it a lot easier to write concise, portable scripts.</p>
<a class="header" href="print.html#deploy" id="deploy"><h4><code>&quot;deploy&quot;</code></h4></a>
<p>Runs both the <code>&quot;test&quot;</code> and <code>&quot;start&quot;</code> scripts one after each other. In this case
I am using <code>yarn</code> to execute the scripts, but NPM would also work.
(<code>&quot;deploy&quot;: &quot;npm run test &amp;&amp; npm run start&quot;</code>) What this script shows is that you
can compose scripts together. This is useful because it means that individual
scripts can be reused and it can abstract the implementation of the scripts
away. For example, it is quite evident that the <code>deploy</code> script tests and starts
the project just from the names of the scripts it is running.</p>
<a class="header" href="print.html#the-problem" id="the-problem"><h4>The Problem</h4></a>
<p>From the sections above, I hope you can see why NPM scripts are very useful in
any type of JavaScript project. The problem is that when there are a lot of
scripts, it is a lot harder to reason about them when reading <code>package.json</code>.
This issue showed itself when developing Corum as a monolith system as I had
scripts for both the client and the API in the same file and sometimes I wanted
to call the scripts by the same name. For example, I wanted a <code>&quot;start&quot;</code> script
for both the client and the API. The client one would start the production ready
web server and the API one would start a production ready docker cluster running
the backing database and the graphcool service. Because you can't have multiple
scripts with the same name for obvious reasons, I had to start prefixing scripts
with what part of the system it started. For example, I had scripts called
<code>&quot;client:start&quot;</code> and <code>&quot;api:start&quot;</code> as well as <code>&quot;client:test&quot;</code> and <code>&quot;api:test&quot;</code>.
This was fine for a few scripts but it got out of hand as more scripts were
added.</p>
<p>When switching to a micro service architecture, there was a separate
<code>package.json</code> file for the client and the API. This meant that I could get rid
of the prefixes that I had given to most scripts. This in turn made it a lot
easier to understand the file and the scripts that could be run at a glance.</p>
<a class="header" href="print.html#dependency-and-bundling-issue" id="dependency-and-bundling-issue"><h4>Dependency and Bundling Issue</h4></a>
<p>JavaScript handles dependencies in the following way:</p>
<ul>
<li>The file <code>package.json</code> contains information about the project</li>
<li>An important piece of information is the project dependencies</li>
<li>When installing the dependencies, (with the <code>yarn</code> command) they are placed in
the <code>node_modules</code> folder</li>
</ul>
<p>The API framework I am using, (graphcool) currently bundles the entire contents
of the <code>node_modules</code> folder with the deployed code. This means that when the
project was a monolith, all of the dependencies for the client were also being
bundled with the API code. This was an issue for the following reasons:</p>
<ul>
<li>The API would take up more storage space on the deployed server</li>
<li>It would take significantly more time to bundle the API before it was
deployed. This meant that I was wasting time.</li>
</ul>
<p>By switching to a micro service architecture, the client and the API had
separate dependencies, and therefore had separate <code>node_modules</code> directories.
This meant that graphcool was only bundling the code that it needed to. This did
indeed reduce the amount of storage space the API service used as well as
reduced the built time of the API service considerably. (From about around 30
seconds to roughly 5 seconds, a 600% decrease) This reduced built time meant
that I could spend more time coding rather than waiting around.</p>
<a class="header" href="print.html#downsides-compared-to-developing-as-a-monolith" id="downsides-compared-to-developing-as-a-monolith"><h2>Downsides Compared to Developing as a Monolith</h2></a>
<p>While developing Corum in a micro service architecture has a lot of benefits,
there are of course at least some trade offs to be made. Luckily so far, I have
only encountered one issue so far.</p>
<a class="header" href="print.html#repeated-prettier-configuration" id="repeated-prettier-configuration"><h3>Repeated Prettier Configuration</h3></a>
<p>Developing in a micro service architecture means that each service can have its
own configuration file. As evident from the above sections, this is usually a
good thing. However, when a configuration file is the same between services,
there is little you can do to deduplicate and share them.</p>
<p>The tool that I ran into configuration problems because of this is called
'prettier'. Prettier is a tool that automatically formats you code to conform to
an opinionated style guide that they determine. This is incredibly useful as it
means that code styling is kept consistent and I don't have to spend any time
formatting the code manually. Prettier does allow some configuration for
controversial styling decisions. For example, I like indenting with 2 spaces, I
prefer writing JavaScript without semicolons, and I prefer strings in JavaScript
to be written only using single quotes.</p>
<p>To keep both projects consistent, I want to have the same styling in both the
client and the API code. To achieve this consistency I need to have two
identical configuration files in each service directory. The issue with this is
that if I want to make a change to my prettier configuration I have to remember
to change it in both services. This problem could be worse if I had more
services as it would have to be changed for each of them.</p>
<a class="header" href="print.html#conclusion" id="conclusion"><h2>Conclusion</h2></a>
<p>From the evidence above of implementing this architecture I would say that it
was a success, and it suited Corum more than a monolith structure. While Corum
suits this paradigm, other projects may not suit it as well, so it was important
that I tried developing a monolith system first. It would have been a lot harder
to start building in a micro service architecture if I hadn't felt the pain
points of building as a monolith system.</p>
<a class="header" href="print.html#client-architecture" id="client-architecture"><h1>Client Architecture</h1></a>
<a class="header" href="print.html#vue" id="vue"><h2>Vue</h2></a>
<p>As mentioned in both the analysis and design sections of this report, I am using
a library called 'Vue' to build my sites user interface.</p>
<a class="header" href="print.html#why-use-vue" id="why-use-vue"><h3>Why use Vue?</h3></a>
<p>If you are not too familiar with modern web development, many libraries and
frameworks have been created to make it easier to build performant and
maintainable web applications. This is because the web has become more than just
static web pages, but the underlying APIs have not changed all that much. These
libraries and frameworks make the job of a web developer easier.</p>
<p>For now I will be focusing on the libraries that make building the user
interface easier. They do this by abstracting away operations such as manually
manipulating the DOM (Through something called a virtual DOM) as well as
providing reactive rendering capabilities amongst other things. This improves
the developer experience (DX) considerably, as user interfaces can be created
declaratively. This means that instead of saying how to do something, (Like
manually manipulating the DOM) you just say what you want to happen. This makes
the code easier to reason about.</p>
<p>The two most popular view libraries today are React and Vue. They both provide
the same basic set of features, but they expose these features to the developer
in very different ways. This means that the decision is almost entirely down to
personal preference. I have experience with both of these libraries and in their
current state I prefer Vue.</p>
<p>Vue provides a way of building UI components in a <code>.vue</code> file. These files are
known as 'Single File Components'. (SFCs) These files allow you to declaratively
write a components markup (HTML), logic (JavaScript) and styling (CSS). This
provides excellent DX as you only have to view a single file to understand the
entire component. This is an abstraction that React doesn't provide, as it one
of the contributing factors to why I prefer Vue over React.</p>
<p>When I started developing the client side of Corum, I actually started using
React. I migrated to Vue because I felt it was more intuitive and less verbose.</p>
<a class="header" href="print.html#nuxt" id="nuxt"><h2>Nuxt</h2></a>
<p>Nuxt is a framework that builds on top of Vue and intends to provide a better
developer experience when building web applications using Vue. It is inspired by
a framework for react that tries to do the same thing called 'Next.js'.</p>
<a class="header" href="print.html#why-use-nuxt" id="why-use-nuxt"><h3>Why use Nuxt?</h3></a>
<a class="header" href="print.html#build-and-deployment-tooling-is-included" id="build-and-deployment-tooling-is-included"><h4>Build and deployment tooling is Included</h4></a>
<p>When building modern web applications, there tends to be a lot of configuration
to get the build tooling working correctly. Some of the most commonly used build
tools such as webpack are renown for there fine control configuration. This is
good because it allows the developer to really customise the tools if they want
to. However most of the time developers don't need as fine grain control and
just want something that works without spending a lot of time setting it up.</p>
<p>Two very common tools that are used are 'Babel' and 'Webpack'.</p>
<a class="header" href="print.html#babel" id="babel"><h5>Babel</h5></a>
<p>This is what Babel has to say for itself on their website:</p>
<blockquote>
<p>Babel is a JavaScript compiler. Use next generation JavaScript, today.</p>
</blockquote>
<p>This means that you can write modern JavaScript and have it compiled down into
code that can be understood by older browsers and node.js versions. This is
great because it means that you don't have to bring your developer experience
down to accommodate for the lowest common denominator.</p>
<p>Babel can be configured a lot. You can choose what syntax to support and what
version of ECMAScript to compile down to. For example, with the
<code>babel-preset-env</code> preset you can choose how many previous browser versions to
support.</p>
<a class="header" href="print.html#webpack" id="webpack"><h5>Webpack</h5></a>
<p>Webpack is the most commonly used module bundler for JavaScript projects at this
moment in time. Webpack is a tool that takes an entry point, creates a
dependencies tree, and bundles it to an output depending on how it is
configured.</p>
<p>Webpack's documentation puts it like this:</p>
<blockquote>
<p>It recursively builds a dependency graph that includes every module your
application needs, then packages all of those modules into one or more
bundles.</p>
</blockquote>
<p>This sounds very abstract because Webpack is capable of a lot and is incredibly
configurable.</p>
<p>Through the concept known as 'loaders', different types of modules (For example,
<code>.js</code>, <code>.css</code> or <code>.vue</code> files) can be processed in a different way. An example
of a loader that would be used in conjunction with babel is <code>babel-loader</code>. When
configured to run against <code>.js</code> modules, this loader will run babel on every one
of them. Another example that would be used with Vue SFCs would be <code>vue-loader</code>.
When configured to run against <code>.vue</code> modules, this loader will convert it into
a module that can be understood by the browser, as no browsers understand the
<code>.vue</code> extension.</p>
<p>Through the concept known as 'plugins', tasks can be ran that are not module
specific, such as code optimisation and minification. An example of a plugin
used commonly is called <code>DefinePlugin</code>. This plugin allows you to configure
global constants at compile time. This could be useful when you need to include
something like a build version in your final bundle.</p>
<a class="header" href="print.html#what-nuxt-does-for-you" id="what-nuxt-does-for-you"><h5>What Nuxt does for You</h5></a>
<p>As evident from the above sections on Babel and Webpack, both of these tools are
very configurable. This can be an issue when you just want to start a project
and don't need to have fine grain control of the build tools. This can be
achieved by either copying a lot of boilerplate configuration code (which is far
from ideal) or using a framework like Nuxt that abstracts away the configuration
into the framework itself.</p>
<p>Nuxt provides sane defaults for both Babel and Webpack in the context of
building a Vue project. This brings the best of both worlds as the framework
makes it easier to get started by providing sane defaults and it also makes it
easy to configure the underlying tools if you need to.</p>
<p>Nuxt provides the following out of the box:</p>
<ul>
<li>The ability to write <code>.vue</code> SFCs (It configures Webpack to use <code>vue-loader</code>)</li>
<li>Automatic code splitting (It configures a Webpack plugin to do this work)</li>
<li>Transpiles ES6+ syntax (It configures Webpack to use <code>babel-loader</code>)</li>
<li>CSS pre-processor support (It configures Webpack to use a few CSS loaders)</li>
<li>Bundles and minifies (It configures multiple Webpack plugins to do this work)</li>
</ul>
<a class="header" href="print.html#routing-and-state-management-is-baked-in" id="routing-and-state-management-is-baked-in"><h4>Routing and State Management is Baked in</h4></a>
<p>While Vue is an excellent view library, it is just that, a view library. This is
a good thing because it does one job and does it well. However, it would be nice
if one could extend Vue's functionality to provide more than just a view layer.
The developers of Vue thought of this and provided a way to do so through what
are known as 'Vue plugins'. While there are many plugins available, both
official and non-official, I am only interested in two for Corum. These are both
official plugins created and maintained by the Vue core team. They are called
<code>vue-router</code> and <code>vuex</code>.</p>
<p><code>vue-router</code> provides a client side routing system where the developer can
specify routes as Vue components and link between them easily. Without client
side routing the routing would have to be done server side. The benefits of
client side routing are talked about in the 'Route Design' sub-section of the
design section of the report.</p>
<p><code>vuex</code> provides global state management to the application. This is needed for
an application like Corum where different components (and often pages) need to
be able to access to the same data. This is made even better by the fact that
the global data store is reactive. This means that components can subscribe to
the store and be notified when the data they want changes. This is useful in
many situations. An example in Corum would be where the login page updates the
user's login state, and components and pages need to display different
information depending on if the user is logged in or not. For example, the
header component of the UI needs to update to display a <code>logout</code> button if the
user logs in.</p>
<p>The issue is that if I want to use these plugins in my code, I have to write a
lot of configuration and boilerplate code to get them working at all. Nuxt
provides both routing and state management based on <code>vue-router</code> and <code>vuex</code> out
of the box. This means that Nuxt handles all of the configuration and means that
I don't have to write boilerplate code that makes my code harder to reason
about.</p>
<p>Nuxt also makes routing file based instead of it being done through a
configuration file. How this works is explained in the below 'How Nuxt Works'
section.</p>
<a class="header" href="print.html#server-side-rendering-without-the-hassle" id="server-side-rendering-without-the-hassle"><h4>Server Side Rendering without the Hassle</h4></a>
<p>In applications built with libraries like Vue, the majority of the markup is
generated on the client side after the initial HTML page has been loaded. For
example, you might send a HTML document that looks like this:</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;React or Vue Application&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div id=&quot;root&quot;&gt;&lt;/div&gt;
  &lt;script src=&quot;bundle.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>At the end of the body element is a script tag that loads a file called
'bundle.js'. This file will contain the the Vue runtime as well as all of the
files that you as a developer created. Given the element selector that the
developer passed to Vue (In this case <code>#root</code>), Vue will mount itself at that
location. From there, Vue will add and remove elements to and from the DOM.</p>
<p>While this is all happening, all the user is seeing is a blank page. The issue
is that the time that the page is blank can be quite long depending on the users
hardware. This is because the device has to parse and execute the JavaScript in
<code>bundle.js</code> before any visible markup is added to the DOM by Vue.</p>
<p>Another issue is that some search engines that use crawlers don't execute
JavaScript. This means that all the crawler will see is the above HTML and
nothing more. This could severely hurt the SEO of the site on certain search
engines.</p>
<p>Some users also choose not to execute unknown JavaScript code by changing a
setting in their browser. Just like the crawler, these users will not see
anything on the page.</p>
<p>The way to solve this is to use a technique known as Server Side Rendering
(SSR). When SSR is implemented, the server goes through a similar process to the
one above that happens on the client and saves the markup outputted by Vue. This
markup is then what is sent to the user instead of just the application skeleton
shown above. The SSR version of the code above might look something like this:</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;React or Vue Application&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div id=&quot;root&quot;&gt;
    &lt;main&gt;
      &lt;h1&gt;Home Page&lt;/h1&gt;
      &lt;p&gt;This is the home page.&lt;/p&gt;
    &lt;/main&gt;
  &lt;/div&gt;
  &lt;script src=&quot;bundle.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>Here you can see that the element that Vue mounts to (<code>#root</code>) contains some
markup when it is returned from the server. This means that as soon as the page
is parsed and loaded, the user will be able to see the markup. This means that
the initial perceived load time is faster. It also means that SEO is better as
the search engine crawlers that don't execute JavaScript can now see the correct
markup, as well as those users that have JavaScript disabled.</p>
<p>At the end of the body there is still a script tag that loads <code>bundle.js</code>. This
time <code>bundle.js</code> contains JavaScript that performs an action known as
'hydrating'. This is where Vue checks the markup inside the mounting element and
compares it to the markup that it would have inserted there. If they match, Vue
can be sure that the page has rendered correctly and can perform its reactive
updates when needed.</p>
<p>After this process has finished, the site acts just like it would when SSR was
not being used.</p>
<a class="header" href="print.html#module-system" id="module-system"><h4>Module System</h4></a>
<p>Nuxt also provides a 'module system'. This is similar to the Webpack plugin
system where developers can extend the functionality of the tool. This also
means that developers can publish Nuxt modules to be downloaded by others. In
the below section named 'How Nuxt Works' there is a sub section on what modules
Corum uses.</p>
<a class="header" href="print.html#how-nuxt-works" id="how-nuxt-works"><h3>How Nuxt Works</h3></a>
<p>This section will explain how Nuxt works in the context of Corum.</p>
<a class="header" href="print.html#the-command-line-interface-cli" id="the-command-line-interface-cli"><h4>The Command Line Interface (CLI)</h4></a>
<p>Nuxt provides a CLI tool that exposes 3 important commands:</p>
<a class="header" href="print.html#nuxt-1" id="nuxt-1"><h5><code>nuxt</code></h5></a>
<p>This command starts the Nuxt development server.</p>
<p>The following happens in development mode:</p>
<ul>
<li>The server is reloaded every time a file changes</li>
<li>Errors are logged to the console and on an overlay</li>
</ul>
<p>These features are useful when developing but are not needed or wanted when
deploying the site to production.</p>
<p>#####<code>nuxt build</code></p>
<p>This builds and bundles all of the sites files. This makes it ready to be hosted
on the production server.</p>
<a class="header" href="print.html#nuxt-start" id="nuxt-start"><h5><code>nuxt start</code></h5></a>
<p>This starts the production server. Before executing this command, it is
important that the site has been build with the <code>nuxt build</code> command.</p>
<p>The following happens in production mode:</p>
<ul>
<li>All errors are suppressed so that it is harder for an attacker to exploit a
possible bug</li>
<li>the files are minified and optimised.</li>
<li>Vue developer tools are disabled for better performance</li>
<li>The service worker added by the PWA module is turned on</li>
</ul>
<p>This makes the production site faster and more refined.</p>
<a class="header" href="print.html#the-directory-structure" id="the-directory-structure"><h4>The Directory Structure</h4></a>
<p>Nuxt utilises a file based API system. Each of the following sections explains
what each directory means to Nuxt.</p>
<a class="header" href="print.html#layouts" id="layouts"><h5><code>layouts</code></h5></a>
<p>Nuxt has a concept of 'layouts'. A layout is a Vue SFC that can be used to make
multiple pages have the same base layout. When a page is rendered, Nuxt looks at
what layout it specifies and then renders the page inside of the specified
layout. You can choose where the page renders in the layout using the <code>nuxt</code> Vue
component.</p>
<p>As mentioned above, pages can say what layout they want to use. This is done in
the page's SFC under the <code>&quot;layout&quot;</code> property. For example, if a page specified
<code>&quot;layout&quot;: &quot;test&quot;</code> then the page would use the <code>test.vue</code> SFC found in the
<code>layouts</code> directory. The <code>&quot;layout&quot;</code> property defaults to <code>default</code> if it is not
otherwise specified. Because Corum has a single consistent layout, only a single
<code>default.vue</code> exists. This means that all pages default to use this layout.</p>
<p>From the sketch shown in the 'Component Design' sub section of the Design
section, it is clear what components should be kept in this file:</p>
<ul>
<li>The <code>Logo</code> component</li>
<li>The <code>Header</code> component</li>
<li>The <code>Navigation</code> component</li>
</ul>
<p>Then where the <code>Main Content</code> section is in the UI design sketch is where the
<code>nuxt</code> Vue component should be used to render the actual page.</p>
<a class="header" href="print.html#pages" id="pages"><h5><code>pages</code></h5></a>
<p>This directory contains all of the sites pages as Vue SFCs. Here is a diagram of
the structure of Corum's <code>pages</code> directory:</p>
<pre><code>pages
├── index.vue
├── login.vue
├── new-subforum.vue
├── signup.vue
└── subforum
    └── _subforum
        ├── index.vue
        ├── new.vue
        └── post
            └── _post.vue
</code></pre>
<p>This directory acts as a file based router. This means that when Nuxt builds the
site for either development or production mode, it reads the structure of this
directory and creates page accordingly. For example, the <code>index.vue</code> file would
map to the route <code>/</code>, the <code>signup.vue</code> file would map to the route <code>/signup</code> and
the <code>subforum/_subforum/index.vue</code> would map to the route <code>/subforum/:subforum</code>.</p>
<p>From the examples given above, you can see that you can nest directories in the
<code>pages</code> directory to create deeper routes. Also, it is important to note that
any file prefixed with a <code>_</code> means that the value of this part of the route is
dynamic.</p>
<p>For example, in the final example above that maps to <code>/subforum/:subforum</code>, the
<code>:subforum</code> part of the route can be any string such as <code>/subforum/programming</code>.
The dynamic variable can be accessed from within the pages SFC, meaning that the
page can dynamically show different content from the same route depending on the
content of the dynamic part of it.</p>
<p>If you look back at the 'Route Design' sub section in the Design section of this
report, you can see from the diagram above that the files shown map to all of
the routes that are needed for Corum.</p>
<a class="header" href="print.html#static" id="static"><h5><code>static</code></h5></a>
<p>This directory is a place to store any asset that is linked statically in the
site in its HTML. The only thing Corum uses this directory for it to store the
favicon of the site.</p>
<a class="header" href="print.html#store" id="store"><h5><code>store</code></h5></a>
<p>This directory is used to store JavaScript files that are used to create the
global state store using <code>vuex</code>. This directory is optional. If the directory is
empty, then Nuxt will intelligently exclude <code>vuex</code> as a dependency, as if the
directory is empty, the global state store is not being used, and therefore is
not needed.</p>
<p>In the context of Corum, only a single <code>index.js</code> file is contained within it.
This file creates and exports a store that is used to keep track of the user's
data. A detailed explanation of this file can be found in the later sub section
named 'Client Analysis'.</p>
<a class="header" href="print.html#nuxt-modules-used-by-corum" id="nuxt-modules-used-by-corum"><h4>Nuxt modules used by Corum</h4></a>
<p>As mentioned above, Nuxt provides an extension point through the use of 'Nuxt
modules'. These are the modules that Corum uses that have been published by
others.</p>
<a class="header" href="print.html#apollo" id="apollo"><h5><code>apollo</code></h5></a>
<p>This will only make complete sense once you have read the section below titled
'Apollo'. In short, this module provides a very simple way to setup the Apollo
library that I am using to fetch data from the GraphQL API.</p>
<a class="header" href="print.html#dotenv" id="dotenv"><h5><code>dotenv</code></h5></a>
<p>This allows Corum to read in configuration options from a file named <code>.env</code> at
the root of the project though a global variable called <code>process.env</code>. There is
also a section below that will explain this in more detail named
'Configuration'.</p>
<a class="header" href="print.html#font-awesome" id="font-awesome"><h5><code>font-awesome</code></h5></a>
<p>This module injects a CSS library called 'Font Awesome'. This library provides a
large collection of SVG icons that Corum uses. These can be seen in a lot of
places, for example in the <code>login</code> and <code>signup</code> buttons.</p>
<a class="header" href="print.html#pwa" id="pwa"><h5><code>pwa</code></h5></a>
<p>This module provides a zero configuration Progressive Web App experience. This
includes things like adding a service worker to the site when in production mode
and more.</p>
<a class="header" href="print.html#nuxt-configuration-nuxtconfigjs" id="nuxt-configuration-nuxtconfigjs"><h4>Nuxt Configuration (<code>nuxt.config.js</code>)</h4></a>
<p>While nuxt provides a great abstraction on top of Vue and related libraries, it
is also very customisable and extensible. Nuxt provides a central way to
configure itself through a file located at the root of the project called
<code>nuxt.config.js</code>.</p>
<p>The details of Corum's Nuxt config are explained in the client's code analysis
section.</p>
<a class="header" href="print.html#fetching-data-with-apollo" id="fetching-data-with-apollo"><h2>Fetching Data with Apollo</h2></a>
<p>As mentioned in the Design section of this report, the API is a GraphQL server.
This is instead of a similar comparable technique such as REST. To find out more
about the benefits of GraphQL, have a look at the 'API Design' sub section in
the Design section.</p>
<p>Because the API is a GraphQL server, the client needs a GraphQL client library
to communicate with the server. Communication with the server could be done
manually with <code>GET</code> and <code>POST</code> JSON requests to the API endpoint, however, just
like Vue provides a declarative interface to the DOM, GraphQL clients provide a
declarative interface for fetching data.</p>
<p>Even though GraphQL is a relatively new technology, there are quite a few
clients to choose from. Some libraries target React as it is the most popular
view library (Such as <code>urql</code> or <code>relay</code>). I will be excluding these options as I
want to be able to have a nice interface to the client through Vue.</p>
<p>These are the two choices that I considered:</p>
<ul>
<li><code>graphql-request</code></li>
<li><code>apollo</code></li>
</ul>
<p>The following sub sections will give a brief explanation of the pros and cons of
each library.</p>
<a class="header" href="print.html#graphql-request" id="graphql-request"><h3><code>graphql-request</code></h3></a>
<p>This is the most lightweight option of the three. This is a benefit as the user
will have less code to download, parse and execute, however, this comes at the
cost of less features. Unlike the other two options, <code>graphql-request</code> doesn't
have cache implementation.</p>
<p>This is an issue for Corum as I want the data fetched to be cached so that if a
user requests the same data multiple times, multiple network requests are not
made. For example, if the user visits a post, goes to another subforum then
returns to the previous post, the post data would have to be fetched again even
though it hasn't changed. This is only an issue in <code>graphql-request</code>.</p>
<p>If I want to have a cache and use <code>graphql-request</code> then I would have to create
a wrapper around the library, however it would be wiser to just use another
library that has caching built in. This is because not only would it take time
to create the cache implementation that I could spend on other things, it would
also take away from how simple and lightweight the library is.</p>
<a class="header" href="print.html#apollo-1" id="apollo-1"><h3><code>apollo</code></h3></a>
<p>This is currently the most popular GraphQL client library. I mentioned briefly
in the design section of this report that I was likely going to be using this
library.</p>
<p>Like <code>graphql-request</code>, Apollo Client is not bound to a specific framework (It
is framework agnostic). However, unlike <code>graphql-request</code>, it provides libraries
with bindings to popular view libraries such as React, Angular and Vue. This
makes it much more ergonomic to work with the library within the supported view
libraries. As I am using Vue as the view library for Corum, I will be using the
Vue bindings named <code>vue-apollo</code>.</p>
<p>Also, Apollo Client provides built in support for caching. This is good for the
reason stated above in the <code>graphql-request</code> sub section above. The way this
works in Apollo is described in the code analysis section of this report.</p>
<p>Another nicety that Apollo Client provides is the concept of middleware hooks.
In simple terms, middleware hooks allows the developer to execute arbitrary code
and to modify the data that passes through the library on a request or response.
This concept is used within Corum to add an <code>Authorization</code> header to every HTTP
request sent to the API server (If the user is logged in). This allows the API
server to verify that the user is allowed to execute protected queries and
mutations. The implementation code for this can be found in the code analysis
section.</p>
<a class="header" href="print.html#css" id="css"><h2>CSS</h2></a>
<p>As mentioned previously, Vue allows you to develop in a format know as Single
File Components (SFC). These files are the ones with a <code>.vue</code> extension. They
basically allow you to write HTML, JavaScript and CSS in a single file. During
the build process, these files are compiled into plain JavaScript files that
browsers can understand. The way the file is written is like a HTML document.
The three top level elements that can exist in an Vue SFC are <code>template</code> (HTML),
<code>script</code> (JavaScript), and <code>style</code> (CSS). All of these tags allow for attributes
like normal HTML tags.</p>
<p>The two attributes that we are interested in are <code>lang</code> and <code>scoped</code>. These two
attributes are described in the following sub sections.</p>
<a class="header" href="print.html#lang" id="lang"><h3><code>lang</code></h3></a>
<p>This attribute allows you to specify what language the code inside of the
element is written in. This attribute is allowed on all top level elements.</p>
<p>For example, you may want to use a HTML pre-processor such as Pug. This will
work by adding <code>lang=&quot;pug&quot;</code> to the <code>template</code> tag, as well as installing the
correct package to process the code inside the element (In this case, the <code>pug</code>
package).</p>
<p>For an example for the <code>script</code> tag, you may want to use a compile-to-JS
language such as TypeScript. This will work by adding <code>lang=&quot;ts&quot;</code> to the
<code>script</code> tag, as well as installing the correct package to process the code
inside the element (In this case, the <code>ts-loader</code> package).</p>
<p>For an example for the <code>style</code> tag, you may want to use a CSS pre-processor
language such as SASS. This will work by adding <code>lang=&quot;sass&quot;</code> to the <code>style</code>
tag, as well as installing the correct package to process the code inside the
element (In this case, the <code>sass-loader</code> package).</p>
<a class="header" href="print.html#scoped" id="scoped"><h3><code>scoped</code></h3></a>
<p>This attribute is only allow to be placed on <code>style</code> elements. This attribute
scopes the CSS inside the element to this component only. This means that if a
class is specified that changes the background colour, if it is applied outside
of this component, it will not get this styling. This works by adding a prefix
to the class name that ensures that it is only scoped the HTML inside the
component. This means that I don't have to think about CSS rules clashing with
each other and causing unwanted styling.</p>
<a class="header" href="print.html#in-the-context-of-corum" id="in-the-context-of-corum"><h3>In the Context of Corum</h3></a>
<p>In the context of Corum, I apply the <code>scoped</code> attribute to most of my <code>style</code>
blocks. Also, I use a CSS pre-processor called Stylus. This is achieved by
adding <code>lang=&quot;stylus&quot;</code> to the <code>style</code> tag and installing the <code>stylus-loader</code>
package. The reason I use a CSS pre-processor is because regular CSS has
problems that I don't want to deal with. This includes things like allowing
nested rules and auto-prefixing rules so that Corum works correctly in older
browsers.</p>
<a class="header" href="print.html#configuration" id="configuration"><h2>Configuration</h2></a>
<p>Certain settings for Corum exist in the file named <code>.env</code> at the root of the
client project. The variables in this file can be accessed from any file through
<code>process.env</code>. During the build process, these variable values are inlined into
the files so that there is no performance hit. The following sub sections
describe what the two variable in this file do.</p>
<a class="header" href="print.html#api_endpoint" id="api_endpoint"><h3>API_ENDPOINT</h3></a>
<p>This setting used when setting up Apollo Client. This expect the URL of the API
endpoint. This has been abstracted up into this file so that if someone else
wants to run a separate instance of Corum, the can easily change what API server
it points to.</p>
<p>Example: <code>API_ENDPOINT=https://api.graph.cool/simple/v1/corum</code></p>
<a class="header" href="print.html#prod" id="prod"><h3>PROD</h3></a>
<p>This setting is used a function called <code>logIfDev</code>. This function reads the value
of this variable and logs details to the console depending on if the value is
<code>true</code> or <code>false</code>. This code can be found in the code analysis section.</p>
<p>Example: <code>PROD=true</code></p>
<a class="header" href="print.html#api-architecture" id="api-architecture"><h1>API Architecture</h1></a>
<a class="header" href="print.html#graphcool" id="graphcool"><h2>Graphcool</h2></a>
<p>As mentioned before in both the analysis and design sections, I am using the
library and service known as Graphcool. Graphcool provides an easily way to
create production ready GraphQL servers in a small amount of time. It acts
almost like a database, in that it provides a permanent data store as well as
CRUD operations to access and modify the data.</p>
<p>These CRUD operations are exposed through a GraphQL API. The way this works is
that it generates a CRUD API with GraphQL queries and mutations based on the
schema you give it. The schema can be found in the design section of the API.</p>
<a class="header" href="print.html#why-graphcool" id="why-graphcool"><h3>Why Graphcool?</h3></a>
<p>Graphcool is like Nuxt for a GraphQL server. Nuxt provides useful abstractions
on top of Vue to provide a better developer experience and a faster development
cycle. Graphcool abstracts away a lot of the implementation details of the
GraphQL API and allows you to declaratively specify what data you want to store.</p>
<p>This means that I don't have to reinvent the wheel, and I have more development
time to spend on other things.</p>
<a class="header" href="print.html#how-graphcool-works" id="how-graphcool-works"><h3>How Graphcool Works</h3></a>
<a class="header" href="print.html#the-command-line-interface-cli-1" id="the-command-line-interface-cli-1"><h4>The Command Line Interface (CLI)</h4></a>
<p>Like Nuxt, Graphcool provides a CLI (called <code>gcf</code>) that expose two important
commands:</p>
<a class="header" href="print.html#gcf-deploy" id="gcf-deploy"><h5><code>gcf deploy</code></h5></a>
<p>This command deploys the API to one of the available public Graphcool servers.
Under the hood, graphcool reads a file named <code>graphcool.yml</code> and builds the API
using it, then it sends this build bundle up to the server.</p>
<a class="header" href="print.html#gcf-playground" id="gcf-playground"><h5><code>gcf playground</code></h5></a>
<p>This commands opens a web browser at the URL of the deployed service and lets
you explore and test your API.</p>
<a class="header" href="print.html#configuring-graphcool" id="configuring-graphcool"><h4>Configuring Graphcool</h4></a>
<p>When running the <code>gcf deploy</code> command, Graphcool looks and reads a file named
<code>graphcool.yml</code>. This file contains all of the information Graphcool needs to
create the API server. The following sub sections will described what each top
level property does. For brevity, the entire contents of Corum's <code>graphcool.yml</code>
file is not shown in the code analysis section, however, like anything in Corum,
the full file can be found at the projects Github repository.</p>
<a class="header" href="print.html#types" id="types"><h5><code>types</code></h5></a>
<p>This property expects a string containing the relative path of the <code>.graphql</code>
file that contains the API schema. This file must be write in the Schema
Definition Language (SDL) that is part of the official GraphQL specification.</p>
<a class="header" href="print.html#functions" id="functions"><h5><code>functions</code></h5></a>
<p>This is where you specify custom resolvers and hook functions that are needed
for the API. The property expects an array of objects that describe what the
function does and where to find the code for it. Every function object should
have a <code>type</code> and a <code>handler</code> property. The <code>type</code> property is used to tell
Graphcool if the function is a resolver or a hook function. The <code>handler</code>
property tells Graphcool where to find the code for the function.</p>
<p>If the type of the function is a resolver, the function object should also
specify a <code>schema</code> string that points to the file that contains what data types
the resolver should expect and what data types it should return.</p>
<p>If the type of the function is a hook function, the function object should also
specify a <code>operation</code> property. This expect a string that tells Graphcool what
data type and what CRUD operation to trigger on. For example, Corum has a simple
hook function that initializes the vote count of a post to 0 when it is created.
The operation property of this hook function is <code>Post.create</code>.</p>
<a class="header" href="print.html#roottokens" id="roottokens"><h5><code>rootTokens</code></h5></a>
<p>The property expects an array of strings. Each string should map to an existing
function that was defined in the <code>functions</code> property. If the function is listed
under this property, the function is given the highest level of permissions
(Also known as root). This allows the functions to perform queries and mutations
to the API that even authenticated users cannot such as getting the password
hash for a user. This is needed because functions such as the <code>login</code> resolver
need to access this kind of sensitive data to work.</p>
<a class="header" href="print.html#permissions" id="permissions"><h5><code>permissions</code></h5></a>
<p>As the permissions section of the <code>graphcool.yml</code> file is explained in the code
analysis section, I will not repeat the same information. For this reason, look
at the code analysis section for an explanation of how permissions work.</p>
<a class="header" href="print.html#iterations-during-development" id="iterations-during-development"><h1>Iterations during Development</h1></a>
<p>In this section I will be talking about how the development of Corum happened
over time, and how it can be described as an iterative process.</p>
<p>This section is split into three sub sections:</p>
<ul>
<li>'Version Control' - This is where I explain the benefits of using a version
control system and how it meant that I could iterate faster and safer.</li>
<li>'Iteration Stages' - This is where all of the major iteration stages are
explained, and the reasoning behind developing Corum in this way.</li>
<li>'User and Stakeholder Feedback' - This is where I talk about how I got
feedback from my friends, family and stakeholders on Corum during and at the
end of Corum's development.</li>
</ul>
<a class="header" href="print.html#version-control" id="version-control"><h1>Version Control</h1></a>
<p>Corum uses a version control system to manage and store the project.
Specifically, Corum uses Git and has the repository uploaded to Github. The way
that version control systems (git in particular) works is when a change is made
to the codebase, the developer makes something called a 'commit'. This contains
a diff of the codebase with the state before and the state after the change.
This diff is sent along with a message describing the change.</p>
<a class="header" href="print.html#why-version-control" id="why-version-control"><h2>Why Version Control?</h2></a>
<p>Version control systems offers a lot of benefits, although a lot of these
benefits are only helpful when working on a team. As Corum is developed by me
alone, Corum cannot take advantages of these features.</p>
<p>There are three main benefits of using a version control system in the context
of Corum's development. The following sub sections will explain what these are:</p>
<a class="header" href="print.html#backup-in-case-of-file-loss" id="backup-in-case-of-file-loss"><h3>Backup in Case of File Loss</h3></a>
<p>While not required, it is useful to create a remote version of the repository (A
version of the repo that is not stored locally). Not only does this mean that I
can easily work on Corum across devices (I have worked on this project on both
my desktop and my laptop), it means that it is almost impossible to lose any
files. This is because in my case, the codebase is stored on three separate
machines at all times (My laptop, desktop, and on Github's servers). For
example, if I accidentally delete the folder, the files corrupt, or my device
breaks, the codebase will still be intact.</p>
<a class="header" href="print.html#backup-in-case-of-a-coding-mistake" id="backup-in-case-of-a-coding-mistake"><h3>Backup in Case of a Coding Mistake</h3></a>
<p>Due to how version control systems work by storing each change, it means that if
I make a serious mistake and want to get back to the previous working state, I
just have to run a single command. It also means that I can revert to any state
in the history of the repo. If I was not using a version control system this
would be difficult or sometimes impossible, as the 'undo' button only stores a
limited amount of state.</p>
<a class="header" href="print.html#documentation" id="documentation"><h3>Documentation</h3></a>
<p>Due to the fact that with every change (commit) made to the repo is accompanied
by a message, it means that anyone can look at the history of the repo and see
when and why a change was made. This is extremely useful; for example, if I find
a bug I can easily look at the history of that file and determine when this
change was made. This allows me to more easily find more potential bugs that
might stem from the same commit.</p>
<p>Also, for this project, this is useful because it allows me to examine the
development process of Corum and more easily comment on it for this report.
Also, if you wanted to, you could see an extremely detailed timeline of the
development process by visiting the projects Github repo.
(<a href="https://github.com/joealden/corum-client">https://github.com/joealden/corum-client</a>)</p>
<a class="header" href="print.html#iteration-stages" id="iteration-stages"><h1>Iteration Stages</h1></a>
<ul>
<li>Talk about iterative development style</li>
<li>Talk about each develop cycle as a 'module' (testing at the end of each)</li>
</ul>
<a class="header" href="print.html#iteration-stages-shown-visually" id="iteration-stages-shown-visually"><h2>Iteration Stages shown Visually</h2></a>
<p>As explained in the previous section, the use of a version control system allow
me to go back in time in the development of Corum. This allows me to show
different visual iterations of the client codebase. There are 5 main visual
iteration stages that can be seen during the development process. The following
sub sections will show what the project looked like at that stage as well as a
short description of what had been achieved.</p>
<a class="header" href="print.html#prototype-1" id="prototype-1"><h3>Prototype 1</h3></a>
<p>Location: <strong><code>images/gifs/iterations/prototype-1.gif</code></strong></p>
<p><img src="images/gifs/iterations/prototype-1.gif" alt="Prototype 1" /></p>
<p>This was the first iteration milestone that was reached. The goal of this
iteration was to implement a dumb frontend. This means that it was just to get
the HTML and CSS correct for the basic layout of all pages. All of the
components described in the design section of the this report were created and
layed out correctly on the page. This stage was very basic, for example the
<code>sign-up</code> and <code>login</code> buttons didn't do anything.</p>
<p>Also to note is that this prototype was created with React and not Vue, the view
library that I ended up using. At the end of this prototype, as explained
before, I didn't like how developing Corum in react felt.</p>
<a class="header" href="print.html#prototype-2" id="prototype-2"><h3>Prototype 2</h3></a>
<p>Location: <strong><code>images/gifs/iterations/prototype-2.gif</code></strong></p>
<p><img src="images/gifs/iterations/prototype-2.gif" alt="Prototype 2" /></p>
<p>In this prototype, I switched from React to Vue. This change can only be seen by
looking at the actual code. I had to convert all of the existing React
components over to Vue.</p>
<p>Also in this prototype I implemented a dumb version of the navigation. Each item
in the navigation correctly linked to the right subforum page, however the data
it was acting on was actually just a mock of the data the API should have been
returning. This was because at this stage in development I hadn't even started
to code the API. I also implemented a basic subforum page that just read the
subforum name from the url and displayed it. This was useful as it ensured that
the routing library was working correctly. Another thing that I added was basic
signup and login pages. These pages were not connected to anything, and the
signup and login buttons did nothing.</p>
<a class="header" href="print.html#prototype-3" id="prototype-3"><h3>Prototype 3</h3></a>
<p>Location: <strong><code>images/gifs/iterations/prototype-3.gif</code></strong></p>
<p><img src="images/gifs/iterations/prototype-3.gif" alt="Prototype 3" /></p>
<p>In this prototype I worked on the look and feel of the site as a whole. Instead
of using the grey scale colour scheme that the previous prototype was using I
used a white, blue and green colour scheme. I also added some drop shadows and
animations to give the site depth and make it feel more natural to use. I
applied this design to the login and signup pages as well. I think this
prototype was important as it made Corum feel a lot more professional and
modern.</p>
<p>You can also see that I removed the mock data that I was using in the previous
iteration and added a search bar in preparation for implementing the API into
the client.</p>
<a class="header" href="print.html#prototype-4" id="prototype-4"><h3>Prototype 4</h3></a>
<p>Location: <strong><code>images/gifs/iterations/prototype-4.gif</code></strong></p>
<p><img src="images/gifs/iterations/prototype-4.gif" alt="Prototype 4" /></p>
<p>This prototype has a lot less changes that the previous ones. I removed the
animations from the site as I thought it made the site feel less responsive. I
think that it is more important for the user to access the information they want
in the shortest amount of time rather than having a lot of animations.</p>
<p>Also, although you cannot see it visually, I added a lot of code for the client
to communicate with the API. The issue at the time was that the API was not
quite finished, so it wasn't possible to load the data. The reason for this is
explained later in the 'problems experienced' section as it was to do with the
fact I hadn't thought about everything I needed to.</p>
<a class="header" href="print.html#production-build" id="production-build"><h3>Production Build</h3></a>
<p>Location: <strong><code>images/gifs/iterations/production.gif</code></strong></p>
<p><img src="images/gifs/iterations/production.gif" alt="Production Build" /></p>
<p>This is what Corum looks like in its current state. Here you can see the client
correctly communicating with the API. By this stage all of the success criteria
set out had been met. To find out more about the final build of Corum visit the
evaluation's testing section where I have recordings for every feature of Corum,
showing that it all works as expected.</p>
<a class="header" href="print.html#an-explanation-of-each-iteration-stage" id="an-explanation-of-each-iteration-stage"><h2>An Explanation of each Iteration Stage</h2></a>
<p>Due to the fact that I cannot show the iterations visually of non visual
development, this section explains these iterations in more detail.</p>
<p>I decided to split up the implementation stage of build Corum up into 3 main
parts.</p>
<p>The first stage was to implement the frontend code up to the point until it
needed to interface with the API. This meant doing things like working out where
things should go on each page and what they should look like.</p>
<p>The second stage was to implement the API. This included writing the code for
the signup and login resolvers. Due to the fact that the API and the frontend
are independent services I did not need to think that much about the
implications of the API design might have on the frontend.</p>
<p>The third stage was to connect the client to the API. This involved writing the
code that made queries to the API and made mutations to the data. For example on
the signup page, when the user pressed submit, the frontend needed to send a
mutation to the API in order to create the account. I also needed to handle how
the frontend would handle the data returned from the API, for example if there
was an error (Maybe the email address the user entered is already being used).</p>
<p>The following three sub sections will describe each of these stages in more
detail.</p>
<a class="header" href="print.html#implementing-a-dumb-frontend-stage-1" id="implementing-a-dumb-frontend-stage-1"><h3>Implementing a Dumb Frontend (Stage 1)</h3></a>
<p>First of all I needed to develop a dumb frontend for the site. This would mean
that I wouldn't have to think about the layout and styling of the site as much
when this iteration was complete. Instead I could just focus on the logic of
making the site actually function. The first stages of this iteration can be
seen in the 1st prototype I made.</p>
<p>This meant that in the following stages I could easily just connect HTML
elements such as buttons and links to JavaScript functions.</p>
<p>There was must to test at this stage, all of the page looked how I wanted them
to look, and of of the links worked correctly. The majority of the testing for
Corum needed to be done when implementing the API and connecting it to the
frontend.</p>
<a class="header" href="print.html#implementing-the-api-stage-2" id="implementing-the-api-stage-2"><h3>Implementing the API (Stage 2)</h3></a>
<p>Next, I needed to implement the API that Corum's client relies on for data.
Because I was using Graphcool it meant that I didn't need to worry about setting
up things like a database or a web sever, Graphcool handled all of that for me
by abstracting them away.</p>
<p>Instead, I had to think about how the data model defined in the design section
of this report would interface with the JavaScript code I needed to write to get
functionality like signup and login working. This was done by using hook
functions and custom resolvers.</p>
<p>The exact code for this iteration stage can be found in the API code analysis
section of this report.</p>
<p>To test the API I used a tool called <code>graphql-playground</code>. This tool is
available standalone but it also comes bundles with Graphcool. This meant that I
didn't have to set it up to test the API. When visiting the API endpoint
returned by Graphcool in a web browser it displays the <code>graphql-playground</code>
interface. This interface allows you to make queries and mutations to the API
without writing any code.</p>
<p>The following GIF shows how it works.</p>
<p>Location: <strong><code>images/gifs/iterations/graphql-playground.gif</code></strong></p>
<p><img src="images/gifs/iterations/graphql-playground.gif" alt="graphql-playground example" /></p>
<p>The left hand side of the screen is where you write the query / mutation and the
right hand side of the screen is the result of that query / mutation that is
returned from the server. The play button (<code>|&gt;</code>) in the top middle is pressed to
execute the query / mutation.</p>
<p>For example, I needed to implement a hook function that set the initial vote
count of every post to 0 to ensure that the client could fake the amount of
up-votes a post had.</p>
<p>To test this I could simply try all of the different cases that the client code
provide:</p>
<p>The client doesn't provide a <code>voteCount</code> field:</p>
<p>Location: <strong><code>images/gifs/iterations/post-test-1.gif</code></strong></p>
<p><img src="images/gifs/iterations/post-test-1.gif" alt="Post Test 1" /></p>
<p>The client provides <code>voteCount</code> but it is <code>null</code>:</p>
<p>Location: <strong><code>images/gifs/iterations/post-test-2.gif</code></strong></p>
<p><img src="images/gifs/iterations/post-test-2.gif" alt="Post Test 1" /></p>
<p>The client provides a <code>voteCount</code> field that is not <code>0</code>:</p>
<p>Location: <strong><code>images/gifs/iterations/post-test-3.gif</code></strong></p>
<p><img src="images/gifs/iterations/post-test-3.gif" alt="Post Test 1" /></p>
<p>The client provides a <code>voteCount</code> field that is <code>0</code>:</p>
<p>Location: <strong><code>images/gifs/iterations/post-test-4.gif</code></strong></p>
<p><img src="images/gifs/iterations/post-test-4.gif" alt="Post Test 1" /></p>
<p>As you can see in all of these examples, <code>voteCount</code> is returned as <code>0</code> in all
cases, as intended.</p>
<a class="header" href="print.html#connecting-the-client-to-the-api-stage-3" id="connecting-the-client-to-the-api-stage-3"><h3>Connecting the Client to the API (Stage 3)</h3></a>
<p>After implementing the API and testing that it worked at expected I needed to
connect the frontend and the API together. This meant implementing the
following:</p>
<ul>
<li>The <code>Header</code> component changes state on login</li>
<li>The <code>Navigation</code> component loads in all subforums and changes on login state</li>
<li>The signup page creates a user and logs them in (with validation)</li>
<li>The login page logs a user in if their details are correct (with validation)</li>
<li>The subforum page loads the posts from the correct subforum</li>
<li>The post page loads post details (name, author, content, comments etc.)</li>
<li>The new post page creates a new post and redirects the user to the new post</li>
<li>The new subforum page creates a new subforum and updates the navigation</li>
</ul>
<p>This was all made pretty easy because of <code>graphql-playground</code>. It meant that I
could construct the queries and mutations for the client in
<code>graphql-playground</code>, then once I knew that they did what I wanted them to do I
just converted these queries and mutations into JavaScript code. This meant that
I could be confident that the frontend was fetching the correct data from the
API.</p>
<p>As this was the final iteration stage it meant that I could test everything just
by visiting the site in a web browser and checking that everything worked
correctly as set out in Corum's success criteria. This testing is shown in great
detail in the evaluation section of this report.</p>
<a class="header" href="print.html#user-and-stakeholder-feedback" id="user-and-stakeholder-feedback"><h1>User and Stakeholder Feedback</h1></a>
<p>placeholder</p>
<a class="header" href="print.html#problems-experienced" id="problems-experienced"><h1>Problems experienced</h1></a>
<p>placeholder</p>
<a class="header" href="print.html#client-problems" id="client-problems"><h1>Client Problems</h1></a>
<ul>
<li>How to manage login state</li>
<li>How to handle errors</li>
<li>Updating state based on data mutations</li>
</ul>
<a class="header" href="print.html#api-problems" id="api-problems"><h1>API Problems</h1></a>
<ul>
<li>User account creation and authentication</li>
<li>Setting the initial vote count of a post to 0 on creation</li>
<li>Ensuring a user could only favorite a subforum once</li>
<li>Ensuring a user could only vote once on a post</li>
<li>Figuring out permissions</li>
<li>Adding extra fields to data types when I realised while developing frontend</li>
</ul>
<a class="header" href="print.html#code-analysis" id="code-analysis"><h1>Code Analysis</h1></a>
<p>The following sections analyse the final code for both the client and the API of
Corum. It is worth noting that I am using modern JavaScript, (Up to ES2017) so
if you do not recognise some any of the syntax used, I recommend visiting the
following link, <a href="https://devhints.io/es6">https://devhints.io/es6</a></p>
<p>To find the full source code, visit the following Github links:</p>
<ul>
<li><a href="https://github.com/joealden/corum-client">https://github.com/joealden/corum-client</a></li>
<li><a href="https://github.com/joealden/corum-api">https://github.com/joealden/corum-api</a></li>
</ul>
<a class="header" href="print.html#client-analysis" id="client-analysis"><h1>Client Analysis</h1></a>
<a class="header" href="print.html#nuxt-configuration-nuxtconfigjs-1" id="nuxt-configuration-nuxtconfigjs-1"><h2>Nuxt configuration (<code>nuxt.config.js</code>)</h2></a>
<pre><code class="language-js">// For more info, visit https://nuxtjs.org/api/configuration-build

module.exports = {
  // Headers of the page
  head: {
    titleTemplate: '%s - Corum',
    meta: [
      { charset: 'utf-8' },
      { name: 'viewport', content: 'width=device-width, initial-scale=1' },
      {
        hid: 'description',
        name: 'description',
        content: 'An open, democratic &amp; self governing forum.'
      }
    ],
    link: [{ rel: 'icon', type: 'image/png', href: '/favicon.png' }]
  },

  // CSS globals
  css: ['~/assets/styles/globals.styl'],

  // Customize the progress bar color
  // $nav-hover (Found at '~/assets/styles/variables.styl')
  loading: { color: '#53c556' },

  // Build configuration
  build: {
    // Extend the webpack config
    extend(config, { isClient, isDev }) {
      if (isClient &amp;&amp; isDev) {
        // Run ESLint on save
        config.module.rules.push({
          enforce: 'pre',
          test: /\.(js|vue)$/,
          loader: 'eslint-loader',
          exclude: /(node_modules)/
        })
      }
    }
  },

  //  Define modules used.
  //  For more info, visit https://nuxtjs.org/guide/modules

  //  @nuxtjs/apollo - Provides vue-apollo + apollo-client
  //  @nuxtjs/dotenv - Reads .env and merges with process.env
  //  @nuxtjs/font-awesome - Provides icons
  //  @nuxtjs/pwa - Adds PWA features like offline support etc.

  //  Documentation for the modules used here can be found at:
  //  https://github.com/nuxt-community/awesome-nuxt#modules

  modules: [
    '@nuxtjs/apollo',
    '@nuxtjs/dotenv',
    '@nuxtjs/font-awesome',
    '@nuxtjs/pwa'
  ],

  // Specify the file where the apollo client config resides
  apollo: {
    clientConfigs: {
      default: '~/apollo/client-configs/default.js'
    }
  }
}
</code></pre>
<p>Please refer to the <a href="print.html#how-nuxt-works"><code>nuxt.config.js</code></a> section located near the
top of this document for more information about what this file does and why it
exists.</p>
<p>These are the main section of Corum's Nuxt configuration file:</p>
<ul>
<li><code>head</code></li>
<li><code>css</code></li>
<li><code>loading</code></li>
<li><code>build</code></li>
<li><code>modules</code></li>
<li><code>apollo</code></li>
</ul>
<p>The following sections will describe what Corum uses them for.</p>
<a class="header" href="print.html#head" id="head"><h3><code>head</code></h3></a>
<p>This is where page headers are defined that will be the same across all pages.</p>
<p>As seen below, an useful property nuxt expose is <code>titleTemplate</code>. This allows
pages to pass their names into a template, so the page title changes between
pages. Corum's title template is <code>'%s - Corum'</code>, so for example, a post page
will have its title, followed by <code>'- corum'</code>.</p>
<p>This also includes things such as meta tags for character encoding and site
description. Also specified here is the link to the site's favicon.</p>
<a class="header" href="print.html#css-1" id="css-1"><h3><code>css</code></h3></a>
<p>This is where you can specify what CSS files you want to be added to the head of
every page, so these styles will be global to the entire site.</p>
<p>Corum's configuration reference a file called <code>globals.styl</code>. It contains a
basic CSS reset, as well as globals such as the base font size and font family.</p>
<p>The <code>.styl</code> file extension is short for stylus. Stylus is a CSS preprocessor.
(You may have heard of SASS, which is another example of a CSS preprocessor) The
fact that I am referencing a <code>.styl</code> file is important because nuxt reads the
file extension, and applies the correct loader to process this file into regular
CSS.</p>
<a class="header" href="print.html#loading" id="loading"><h3><code>loading</code></h3></a>
<p>In the GIFs files above that show how the site actually functions, you may have
noticed a small green loading bar going across the top of the page when
navigating between pages. This is a feature built into nuxt. Nuxt allows you to
customise this loading bar with CSS. Corum only changes the color of the bar to
match the overall theme.</p>
<a class="header" href="print.html#build" id="build"><h3><code>build</code></h3></a>
<p>The build property is where Nuxt allows you to extend its functionality. The
only thing Corum uses this for is to linting to JavaScript and Vue.</p>
<a class="header" href="print.html#modules" id="modules"><h3><code>modules</code></h3></a>
<p>This is where you defined the Nuxt modules that you want to use. Nuxt modules
are packages that features to Nuxt just by installing them and telling nuxt to
use them.</p>
<p>The modules used by Corum and why they are used can be found in the code
comments below.</p>
<a class="header" href="print.html#apollo-2" id="apollo-2"><h3><code>apollo</code></h3></a>
<p>This is exposed by the <code>@nuxtjs/apollo</code> module, and requires you to specify
where the Apollo Client configuration file resides.</p>
<a class="header" href="print.html#apollo-configuration" id="apollo-configuration"><h2>Apollo Configuration</h2></a>
<pre><code class="language-js">// https://github.com/nuxt-community/apollo-module

import { ApolloLink } from 'apollo-link'
import { HttpLink } from 'apollo-link-http'
import { InMemoryCache } from 'apollo-cache-inmemory'

export default () =&gt; {
  // Create a HTTP link to the Graphcool endpoint
  const uri = process.env.API_ENDPOINT
  const httpLink = new HttpLink({ uri })

  // This middleware sends the JWT (if present) that is needed for
  // mutations such as 'createPost' or 'createComment', as only logged
  // in users are allowed to perform such mutations.

  const middlewareLink = new ApolloLink((operation, forward) =&gt; {
    /*
      Due to this being parsed SSR, process.browser must be used to
      make sure localStorage is only attempted to be accessed on the
      client. This isn't a  n issue as no queries or mutations that
      require authentication are made on an SSR request of the page.
    */
    const token = process.browser
      ? localStorage.getItem('auth-token')
      : undefined

    // Set the request headers to include the auth token
    operation.setContext({
      headers: { authorization: `Bearer ${token}` }
    })
    return forward(operation)
  })

  // Add this auth token middleware onto the HTTP link
  const link = middlewareLink.concat(httpLink)

  // Create an memory cache to be used by Apollo
  const cache = new InMemoryCache()

  return { link, cache }
}
</code></pre>
<p>To find out more about how configuring Apollo client works, visit the url that
is at the top of the code block.</p>
<p>As mentioned before, Apollo is used to communicate with Corum's GraphQL API.
Before Apollo can communicate the with the API, it needs to be configured. In
version 2 of Apollo Client, it was made a lot more modular. The two important
things to configure now are Apollo Links and Caches.</p>
<p>Apollo Links allow you to configure how GraphQL queries are handled. A common
Apollo link is <code>apollo-link-http</code> as seen below. This allows you to configure
how queries are sent over HTTP. The <code>apollo-link-http</code> package exposes a class
called <code>HttpLink</code>. As seen below, it expects and object containing the <code>uri</code> of
the API server. In Corum's case, the API endpoint address is fetched from the
<code>.env</code> file located in the root directory of the project. This means that
queries sent through Apollo are now sent to our Graphcool API.</p>
<p>There is also a generic Apollo link in the package <code>apollo-link</code>. This package
exposes a class called <code>ApolloLink</code>. This link allows you to modify the request
before it is sent in any way you like. (Also known as middleware) The reason
Corum needs to modify the request is so that the authentication token (if
present) is sent along with the request, allowing protected queries to be
performed. (Such as creating posts) The authentication token is fetched when the
user is logged in, and it is checked by the API before any protected queries are
performed, so it ensures that only logged in users can perform protected
queries.</p>
<p>Apollo Caches are used to cache data fetched from the server, so that unneeded
network requests are not made. How this works is that Apollo checks the cache
before following the Apollo Link chain. A type of Apollo Cache called
<code>apollo-cache-inmemory</code> is used by corum. This simply means that the cache is
kept in memory on the client, so it is deleted when the user goes off of the
site.</p>
<a class="header" href="print.html#navigation-component" id="navigation-component"><h2>Navigation Component</h2></a>
<a class="header" href="print.html#subforumsearch" id="subforumsearch"><h3><code>subforumSearch</code></h3></a>
<pre><code class="language-js">// Used to produce the filtered search
subforumSearch() {
  const caseInsensitiveInput = this.search.toLowerCase()

  return this.allSubforums.filter(subforum =&gt;
    subforum.name.toLowerCase().includes(caseInsensitiveInput)
  )
}
</code></pre>
<p>The <code>subforumSearch</code> function is used as a computed property by Vue. Computed
properties can be used in any place where component data can be used, however
the main difference is that if any of the variables that the computed property
function is referencing change, the return value of the function will get
recomputed and the code that references this computed property will update with
this new value. To find out more about computed properties, visit the following
link: <a href="https://vuejs.org/v2/api/#computed">https://vuejs.org/v2/api/#computed</a></p>
<p>This function is used to calculate what items match the users search term.</p>
<p>As this function has been taken out of context, it will be useful to know what
the variables referenced are:</p>
<ul>
<li><code>this.search</code> is a string that is linked to the search box in the navigation
and is updated when the contents of the search box changes.</li>
<li><code>this.allSubforums</code> is an array of <code>Subforum</code> objects that has been fetched by
Apollo. These objects contain a <code>name</code> property.</li>
</ul>
<p>To make the search case insensitive, the <code>toLowerCase</code> method on the string
prototype is called on the users search term. Then, using the <code>filter</code> method on
the array prototype and the <code>includes</code> method on the string prototype, the
subforums that match the search term are returned from the function.</p>
<a class="header" href="print.html#sortedfavorites" id="sortedfavorites"><h3><code>sortedFavorites</code></h3></a>
<pre><code class="language-js">/*
  As graphcool doesn't support ordering by nested data, this
  computed value sorts the favorites array by subforum names.
*/
sortedFavorites() {
  if (this.allFavorites !== undefined) {
    // Spread into a new array as sort mutates original array
    return [...this.allFavorites].sort((a, b) =&gt; {
      if (a.subforum.name &gt; b.subforum.name) {
        return 1
      } else if (a.subforum.name &lt; b.subforum.name) {
        return -1
      } else {
        return 0
      }
    })
  } else {
    return undefined
  }
}
</code></pre>
<p>This is a Vue computed property, refer to the
<a href="print.html#subforumsearch"><code>subforumSearch</code></a> section for more information.</p>
<p>Graphcool (The API framework I am using) does support ordering, (Which I have
taken advantage of when sorting posts on the subforum page) however it currently
doesn't support ordering by nested data. (As mentioned in the code comment
below) This means that instead of relying on the API to do the sorting work, I
have to perform this sorting on the client.</p>
<p>The reason I want the favorites to be sorted alphabetically is because
otherwise, like the <code>All Subforums</code>, it would be harder for the user to find the
subforum they are looking for when just scrolling through the list.</p>
<p>Variable Reference:</p>
<ul>
<li><code>this.allFavorites</code> is an array of <code>Favorite</code> objects that are fetched by
Apollo if the user is logged in. These objects contain a <code>Subforum</code> object
with a <code>name</code> property.</li>
</ul>
<p>Firstly, a check is made that the favorites have been fetched from the API, if
this wasn't checked, an error would be thrown. It also means that a message can
be shown to the user when the data is still loading.</p>
<p>If the favorites data is present, using the <code>sort</code> method on the array
prototype, a new array of <code>Favorite</code> objects is returned sorted by their
<code>subforum.name</code> property.</p>
<a class="header" href="print.html#post-page-1" id="post-page-1"><h2>Post Page</h2></a>
<a class="header" href="print.html#upvotebuttonclick" id="upvotebuttonclick"><h3><code>upvoteButtonClick</code></h3></a>
<pre><code class="language-js">// Determines what GraphQL mutation to execute based on the vote state
upvoteButtonClick() {
  if (this.voteInProgress === false) {
    this.voteInProgress = true

    if (this.upvoted === true) {
      // The user has already upvoted
      this.localVote -= 1
      this.deleteVote({ id: this.userVoteData.id })
    } else if (this.downvoted === true) {
      // The user has already downvoted
      this.localVote += 2
      this.updateVote({ id: this.userVoteData.id, vote: 'VOTE_UP' })
    } else {
      // The user has not voted
      this.localVote += 1
      this.createVote({
        vote: 'VOTE_UP',
        postId: this.$route.params.post,
        userId: this.userId
      })
    }
  }
}
</code></pre>
<p>As shown in the 'Testing During Development' section, the post page has an
upvote and a downvote button in the top right of the page. These buttons are
bound to onClick event handlers called <code>upvoteButtonClick</code> and
<code>downvoteButtonClick</code> respectively. I am only explaining how the
<code>upvoteButtonClick</code> handler works as the <code>downvoteButtonClick</code> handler is very
similar, it just works in the opposite way. (For example, if the button is
pressed, then a downvote will be registered instead of an upvote)</p>
<p>Variable Reference:</p>
<ul>
<li><code>this.voteInProgress</code> ensures that only a single vote is being processed at a
time.</li>
<li><code>this.upvoted</code> keeps track of if the user has already upvoted the post</li>
<li><code>this.downvoted</code> keeps track of if the user has already downvoted the post</li>
<li><code>this.localVote</code> keeps track of the local vote count, this variable is needed
because any data fetched from the API is immutable. If Corum relied on the
data coming from the server only, then the UI would be slow to update, because
an response from the API would be required to update the vote count displayed
to the user</li>
<li><code>this.createVote</code>, <code>this.updateVote</code> and <code>this.deleteVote</code> are functions that
send mutations requests to the API, these functions are described in the next
code analysis sub section. This functionality is extracted out of the button
click handler functions to reduce code duplication and keep the event handlers
easier to read at a glance.</li>
</ul>
<p>Firstly, a check is made to ensure that no vote mutations are in progress. If
any are in progress, then the button click is ignored. The reasoning behind this
check is explain in the variable reference section above. If the check passes,
then the vote mutation starts to execute. To ensure that the user cannot vote
again before the function has finished executing, <code>this.voteInProgress</code> is set
to <code>true</code>.</p>
<p>This function needed to handle the following scenarios:</p>
<ul>
<li>If the user hasn't voted already, increment the vote count on the post by 1</li>
<li>If the user has already upvoted the post, decrement the vote count by 1</li>
<li>If the user has already downvoted the post, increment the vote count by 2</li>
</ul>
<p>This means that the function needs to handles the 3 possible branches, and
execute the correct code.</p>
<a class="header" href="print.html#createvote" id="createvote"><h3><code>createVote</code></h3></a>
<pre><code class="language-js">/*
  For more info on how mutations work within vue-apollo,
  visit https://github.com/Akryum/vue-apollo#mutations
*/

// variables = { vote, postId, userId }
async createVote(variables) {
  const postId = this.$route.params.post

  try {
    await this.$apollo.mutate({
      mutation: createVoteMutation,
      variables,

      update: (store, { data: { createVote } }) =&gt; {
        const data = store.readQuery({
          query: userVoteQuery,
          variables: {
            postId,
            userId: this.userId
          }
        })

        data.allVotes.push({
          __typename: 'Vote',
          id: createVote.id,
          vote: variables.vote
        })

        store.writeQuery({
          query: userVoteQuery,
          variables: {
            postId,
            userId: this.userId
          },
          data
        })
      },

      optimisticResponse: {
        __typename: 'Mutation',
        createVote: {
          id: 0,
          __typename: 'Vote'
        }
      }
    })

    // Indicate to the page that the vote has finished execution
    this.voteInProgress = false
  } catch (error) {
    logIfDev('error', error)
  }
}
</code></pre>
<p>Like the <code>upvoteButtonClick</code> and <code>downvoteButtonClick</code> functions, the 3 vote
mutation functions <code>createVote</code>, <code>updateVote</code> and <code>deleteVote</code> are very similar.
I will only analyse the <code>createVote</code> function.</p>
<p>Variable Reference:</p>
<ul>
<li><code>variables</code>, as mentioned at the top of the code block, is expected to be an
object with <code>vote</code>, <code>postId</code> and <code>userId</code> properties. These pieces of data are
needed to correctly create the vote</li>
<li><code>this.$apollo</code> is a module exposed by the <code>vue-apollo</code> package I am using for
Vue bindings to Apollo. This is available on the global Vue instance, this
means that is can be accessed from any <code>.vue</code> file. It exposes as method
called <code>mutate</code> that is used to send a mutation to the API</li>
<li><code>createVoteMutation</code> is a GraphQL mutation used to create the user</li>
<li><code>userVoteQuery</code> is a GraphQL query that returns the data for a users vote</li>
<li><code>this.$route.params.post</code> contains the postId that can be seen in the browsers
URL bar when on a post page. Like <code>this.$apollo</code>, <code>this.$route</code> is available
on the global Vue instance. However, instead of being exposed by <code>vue-apollo</code>,
it is exposed by the router, <code>vue-router</code>.</li>
</ul>
<p>The whole function is just a call to the <code>mutate</code> function found on
<code>this.$apollo</code>. The <code>mutate</code> function expects an object as an argument.</p>
<p>While the object argument can take more properties, these are the properties I
am using:</p>
<ul>
<li><code>mutation</code> - The GraphQL mutation that you want to send to the API</li>
<li><code>variables</code> - An object of variables that the mutation takes in</li>
<li><code>update</code> - The function that is called when data is returned from the API</li>
<li><code>optimisticUpdate</code> - An object that will be used in place of the real data
before the data is returned from the API. If this property is present, then
the <code>update</code> function passed in will be called twice. Once immediately with
the <code>optimisticUpdate</code> object passed as the <code>data</code> parameter of the <code>update</code>
function, and then again whenever the data is returned from the API. This
means that the UI can be optimistically updated before the real data from the
API is returned. Otherwise there would be a delay between pressing the vote
button and the UI updating, which would be a bad user experience.</li>
</ul>
<p>To show what the <code>update</code> function does, I will explain what happens when it is
called with the <code>optimisticUpdate</code> object. As shown in the <code>update</code> function
signature, the function expects the following parameters:</p>
<ul>
<li><code>store</code> - This object is a reference to the Apollo cache that exists in
memory. (That was created by the <code>apollo-cache-inmemory</code> package as seen in
the 'Apollo Configuration' sub section) It exposes two methods that I make use
of called <code>readQuery</code> and <code>writeQuery</code>. As evident from their names, the
<code>readQuery</code> function takes in a query and queries the cache with it. The
<code>writeQuery</code> takes a query and the data to be written to the cache.</li>
<li><code>data</code> - In the case of the first call of the <code>update</code> function, this is the
<code>optimisticUpdate</code> object.</li>
</ul>
<p>The usual flow of the <code>update</code> function is the following:</p>
<ul>
<li>Read the data from the cache</li>
<li>Mutation the read data</li>
<li>Write the data back to the cache</li>
</ul>
<p>This function does exactly that. The data is read, the data object is mutated by
pushing the new vote onto the end of the <code>allVotes</code> array, then the mutation
data object is written back to the cache.</p>
<p>Most of the function's body is wrapped in a try / catch statement. This is
needed as if any errors occur, the function will gracefully handle them. For
example, if the API is not running, then an error will be logged to the console
if the app is in development mode, using the <code>logIfDev</code> function that will be
explained later on.</p>
<a class="header" href="print.html#submitcomment" id="submitcomment"><h3><code>submitComment</code></h3></a>
<pre><code class="language-js">async submitComment() {
  const author = this.$store.state.username
  const { comment: content } = this
  const id = this.$route.params.post

  // Clears user input from textarea
  this.comment = ''

  try {
    await this.$apollo.mutate({
      mutation: createCommentMutation,
      variables: {
        author,
        content,
        id
      },

      update(store, { data: { createComment: commentData } }) {
        const data = store.readQuery({
          query: postQuery,
          variables: { id }
        })

        const newComment = {
          __typename: 'Comment',
          id: commentData.id,
          author: commentData.author,
          content: commentData.content
        }

        data.Post.comments.push(newComment)
        store.writeQuery({
          query: postQuery,
          variables: { id },
          data
        })
      },

      optimisticResponse: {
        __typename: 'Mutation',
        createComment: {
          __typename: 'Comment',
          id: 'loading',
          author,
          content
        }
      }
    })

    // scroll to bottom of page when comment is inserted
    const main = document.getElementById('main-content-wrapper')
    main.scrollTop = main.scrollHeight
  } catch (error) {
    logIfDev('error', error)
  }
}
</code></pre>
<p>Like the <code>upvoteButtonClick</code> function, this is also an event handler. This
function is called when the user clicks on the 'Post Comment' button.</p>
<p>Variable Reference:</p>
<ul>
<li><code>this.$store.state.username</code> is a reference to the user's username.
<code>this.$store</code> is another global Vue instance property. This is exposed by the
<code>vuex</code> package. This allows me to store global state in Corum like user data.</li>
<li><code>this.comment</code> is a string that is linked to the comment textarea and is
updated when the contents of the textarea changes.</li>
<li><code>this.$route.params.post</code> is a reference to the post's ID. The <code>this.$route</code>
global is explained the 'createVote' subsection above.</li>
<li><code>createCommentMutation</code> is a GraphQL mutation that creates a comment</li>
<li><code>postQuery</code> is a GraphQL query that fetches a post's data</li>
</ul>
<p>Just like the <code>createVote</code> function shown in the 'createVote' sub section above,
this function is mainly just a call to the <code>mutate</code> function found on
<code>this.$apollo</code>. To avoid repetition, I will not explain how this function works
again. If you don't know how it works, read the above 'createVote' sub section.</p>
<p>This function works in a very similar way to the <code>createVote</code> function. First,
the data required for the mutation is saved into local variables. After this,
the contents of <code>this.comment</code> is set to an empty string. This is done near the
start of the function to keep the UI feeling snappy.</p>
<p>Then the mutation is made. The mutation is very similar to the <code>createVote</code>
function. The update function pushes the new comment into the post's comments
array inside of Apollo's cache. After this has happened, the user is
automatically scrolled to the bottom of the page to see that their new comment
has appeared in the comments section.</p>
<p>Just like the <code>createVote</code> function, error handling is also present.</p>
<a class="header" href="print.html#new-post-page-1" id="new-post-page-1"><h2>New Post Page</h2></a>
<a class="header" href="print.html#submitpost" id="submitpost"><h3><code>submitPost</code></h3></a>
<pre><code class="language-js">async submitPost() {
  const authorId = this.$store.state.userId

  const { postTitle: title, postContent: content, Subforum: { id } } = this
  /*
    For more info on how mutations work within vue-apollo,
    visit https://github.com/Akryum/vue-apollo#mutations
  */
  try {
    const { data: { createPost } } = await this.$apollo.mutate({
      mutation: createPostMutation,
      variables: {
        authorId,
        title,
        content,
        id
      }
    })

    const { subforum } = this.$route.params
    const postId = createPost.id
    this.$router.push(`/subforum/${subforum}/post/${postId}`)
  } catch (error) {
    this.$router.push(`/error`) // TODO: create actual error page
  }
}
</code></pre>
<p>Like the <code>submitComment</code> function, this is also an event handler. This function
is called when the user clicks on the 'Create Post' button on the 'New Post'
page. Also, instead of submitting a comment, it submits a post.</p>
<p>Variable Reference:</p>
<ul>
<li><code>this.$store.state.userId</code> - explained in the <code>submitComment</code> sub section</li>
<li><code>this.postTitle</code> is a string that is linked to the title text box and is
updated when the contents of the text box changes</li>
<li><code>this.postContent</code> is a string that is linked to the content textarea and is
updated when the contents of the textarea changes</li>
<li><code>this.Subforum</code> contains the data of the subforum that the post is wanting to
be created on</li>
<li><code>createPost</code> is a GraphQL mutation to create a new post</li>
<li><code>this.$route.params.subforum</code> is the ID of the subforum that the post is
wanting to be created on</li>
<li><code>this.$router.push</code> is a function that redirects the user to a given url.</li>
</ul>
<p>This function is a lot simpler than previous <code>mutate</code> function calls. This is
because when the new post is created, the user is redirected to the new post's
page, where the new post's data is fetched. This means that the cache doesn't
need to be manually updated as the redirect will trigger GraphQL queries that
will update the cache.</p>
<p>Unlike previous error handling code, this function redirects the user to an
error page.</p>
<p>I have left out a section explaining the <code>newSubforum</code> function on the 'New
Subforum' page because it is very similar, if not even more simple that this
function.</p>
<a class="header" href="print.html#login-page-1" id="login-page-1"><h2>Login Page</h2></a>
<a class="header" href="print.html#login" id="login"><h3><code>login</code></h3></a>
<pre><code class="language-js">async login() {
  // Renders the loading submit button
  this.loading = true

  const { email, password } = this
  /*
    For more info on how mutations work within vue-apollo,
    visit https://github.com/Akryum/vue-apollo#mutations
  */
  try {
    const { data: { authenticateUser } } = await this.$apollo.mutate({
      mutation: authenticateUserMutation,
      variables: {
        email,
        password
      }
    })

    const { id, username, token } = authenticateUser
    this.$store.commit('saveUserData', { id, username, token })

    // Returns the user to the page they were on before
    // TODO: If user was on signup before, redirect to home
    this.$router.back()
  } catch ({ message }) {
    // Renders the normal submit button
    this.loading = false
    // Display the error to the user in an alert box
    alertError(message)
  }
}
</code></pre>
<p>This function is an event handler that is triggered when the users clicks on the
'Login' button on the login page. Due to the fact that the <code>signup</code> function for
the signup page is almost identical, I will not be analysing it.</p>
<p>Variable Reference:</p>
<ul>
<li><code>this.loading</code> keeps track of if the client is currently waiting for a
response from the API. It is used to disable the 'Login' button if it is set
to <code>true</code> so that the user knows that page is doing something, and so that the
user doesn't make multiple authentication requests for no reason.</li>
<li><code>this.email</code> is a string that is linked to the email text box and is updated
when the contents of the text box changes</li>
<li><code>this.password</code> is a string that is linked to the password text box and is
updated when the contents of the text box changes</li>
<li><code>authenticateUser</code> is a GraphQL mutation that authenticates a user</li>
<li><code>this.$store.commit</code> is a function that allows you to mutate the global state</li>
<li><code>this.$router.back</code> is a function that send the user back to the previous page
that they were on.</li>
</ul>
<p>This function is like many other event handlers on the site, it is basically
just a GraphQL mutation call.</p>
<p>If the authentication succeeds, (The user has entered the correct details) the
user's id, username and auth token is extracted from the API response and save
into the apps global state. After this, the user is redirected back to the
previous page they were on.</p>
<p>If the authentication fails, (The user has entered incorrect details) the
<code>catch</code> block is executed. <code>this.loading</code> is set to false so that the user can
correct the incorrect data they entered and resubmit the form. Then after this,
the error message returned from the API is cleaned up and displayed to the user
through the use of <code>alertError</code>, which will be explained later on.</p>
<a class="header" href="print.html#signup-page-1" id="signup-page-1"><h2>Signup Page</h2></a>
<a class="header" href="print.html#correctdetails" id="correctdetails"><h3><code>correctDetails</code></h3></a>
<pre><code class="language-js">// Ensures that all input fields have been entered correctly
correctDetails() {
  const emailEntered = this.email !== ''
  const usernameEntered = this.username !== ''

  const password1Entered = this.password1 !== ''
  const password2Entered = this.password2 !== ''
  const passwordsEntered = password1Entered &amp;&amp; password2Entered
  const passwordsMatch = this.password1 === this.password2

  return (
    emailEntered &amp;&amp; usernameEntered &amp;&amp; passwordsEntered &amp;&amp; passwordsMatch
  )
}
</code></pre>
<p>This function is used in the signup form to perform input validation on the
client side, so that the API will have not have to deal with as much processing.</p>
<p>Variable Reference:</p>
<ul>
<li><code>this.email</code> is a string that is linked to the email text box and is updated
when the contents of the text box changes</li>
<li><code>this.username</code> is a string that is linked to the username text box and is
updated when the contents of the text box changes</li>
<li><code>this.password1</code> is a string that is linked to the first password text box and
is updated when the contents of the text box changes</li>
<li><code>this.password2</code> is a string that is linked to the second password text box
and is updated when the contents of the text box changes</li>
</ul>
<p>This function returns a boolean that is used in the user interface to
conditionally render a clickable signup button. If the function returns <code>false</code>,
the signup button will be greyed out. If the function returns <code>true</code>, the signup
button will be clickable.</p>
<p>As this is a Vue computed property, the return value will be recalculated every
time a dependency changes. (Any of the form fields)</p>
<p>This function works by creating a boolean from each input field. All of the
fields work in the same way, so I will only give one example.</p>
<pre><code class="language-js">const emailEntered = this.username !== ''
</code></pre>
<p>If <code>this.username</code> is empty, <code>emailEntered</code> will evaluate to false.</p>
<p>The only differing piece of code in this function is where the password fields
are also checked to contain the same input. They must equal, as the user is
expected to input the exact same password.</p>
<a class="header" href="print.html#utility-functions" id="utility-functions"><h2>Utility Functions</h2></a>
<a class="header" href="print.html#stringtoboolean" id="stringtoboolean"><h3><code>stringToBoolean</code></h3></a>
<pre><code class="language-js">// Helper function to handle process.env booleans

const stringToBoolean = stringBool =&gt; {
  if (stringBool === 'true') {
    return true
  } else if (stringBool === 'false') {
    return false
  } else {
    throw new Error(
      `Expected a string of 'true' or 'false', but got ${stringBool}`
    )
  }
}

export default stringToBoolean
</code></pre>
<p>This function is used to convert the string literals <code>'true'</code> and <code>'false'</code> into
their actual boolean values, <code>true</code> and <code>false</code>. This function is used when
importing data from the configuration file, as everything is treated as a
string.</p>
<p>The logic of the function is very easy to follow. If the argument to the
function is the string <code>'true'</code>, the function will return the boolean <code>true</code>. If
the argument to the function is the string <code>'false'</code>, the function will return
the boolean <code>false</code>. There is also a final check if the other conditions do not
match. For this case, a helpful error is thrown.</p>
<a class="header" href="print.html#logifdev" id="logifdev"><h3><code>logIfDev</code></h3></a>
<pre><code class="language-js">import stringToBoolean from '~/utils/stringToBoolean'

// Only logs to console if process.env.PROD is false

const logIfDev = (logType, message) =&gt; {
  if (stringToBoolean(process.env.PROD) === false) {
    console[logType]('test')
  }
}

export default logIfDev
</code></pre>
<p>This function conditionally logs messages to the console, depending on the
configuration option <code>PROD</code>. If the site is in development mode, the messages
passed to the function will be logged. If the site is in production mode, the
messages passed to the function will not be logged, as the end user does not
need to see these debug / error messages.</p>
<p>Variable Reference:</p>
<ul>
<li><code>process.env.PROD</code> is the configuration option that is used to change if the
site is in development or production mode. The <code>process</code> global is exposed by
Nuxt, and the <code>env</code> property is exposed by the Nuxt module <code>@nuxtjs/dotenv</code>.</li>
</ul>
<p>This functions takes a <code>logType</code> and a <code>message</code> as arguments. The <code>logType</code> can
be any valid log method on the console global, such as <code>log</code>, <code>warning</code>, or
<code>error</code>. These methods show the severity of messages logged to the console. The
<code>message</code> is expected to be a string.</p>
<a class="header" href="print.html#alerterror" id="alerterror"><h3><code>alertError</code></h3></a>
<pre><code class="language-js">// Formats a GraphQL error to display to the user

export const formatError = errorMessage =&gt; {
  const colonIndex = errorMessage.lastIndexOf(':')
  const cleanedMessage = errorMessage.substring(
    colonIndex + 2,
    errorMessage.length
  )
  return cleanedMessage
}

const alertError = errorMessage =&gt; {
  const cleanedMessage = formatError(errorMessage)
  alert(`Error: ${cleanedMessage}`)
}

export default alertError
</code></pre>
<p>This function is used in the signup and login pages to convert errors returned
from the API into a readable format, and then display them to the user.</p>
<p>There are two parts of this code, the <code>formatError</code> function and the
<code>alertError</code> function. The <code>formatError</code> actually performs the tidying up of the
error, and the <code>alertError</code> calls the <code>formatError</code> function and displays it.</p>
<p>The reason this function is needed is because the error message returned from
the API is for debugging, and contains data that is not useful to the end user.</p>
<a class="header" href="print.html#global-store-configuration-vuex" id="global-store-configuration-vuex"><h2>Global Store Configuration (Vuex)</h2></a>
<pre><code class="language-js">import { Store } from 'vuex'
import Vue from 'vue'

// For more info, visit https://nuxtjs.org/guide/vuex-store/

/*
  Vue.set() is used to get around Vue's inability to detect the
  state change.
*/

export default () =&gt; {
  return new Store({
    // Only allow state mutations through the defined mutation methods
    strict: true,

    /*
      Initial state is fetched in a hook that executes on the client.
      Fetch can be found at '~/layouts/default' or '~/layouts/error'.
    */
    state: {
      userId: undefined,
      username: undefined
    },

    mutations: {
      logout(state) {
        localStorage.removeItem('user-id')
        localStorage.removeItem('username')
        localStorage.removeItem('auth-token')
        Vue.set(state, 'userId', localStorage.getItem('user-id'))
        Vue.set(state, 'username', localStorage.getItem('username'))
      },

      saveUserData(state, { id, username, token }) {
        localStorage.setItem('user-id', id)
        localStorage.setItem('username', username)
        localStorage.setItem('auth-token', token)
        Vue.set(state, 'userId', localStorage.getItem('user-id'))
        Vue.set(state, 'username', localStorage.getItem('username'))
      },

      updateUserState(state) {
        Vue.set(state, 'userId', localStorage.getItem('user-id'))
        Vue.set(state, 'username', localStorage.getItem('username'))
      }
    }
  })
}
</code></pre>
<p>This file is used to configure the state management library that I am using,
<code>Vuex</code>. The reason Corum needs a global state management library is because the
user details need to be available across the entire app. Instead of calling out
to the <code>localStorage</code> API every time Corum needs the user information, it is
quicker to keep this information in memory.</p>
<p>Nuxt expects this file to export a function that returns the store to use in the
application. the <code>Store</code> class is exposed by the <code>Vuex</code> library, and expect a
configuration object as a parameter. This object can contain many properties,
but I will only explain the ones that I am using.</p>
<ul>
<li><code>strict</code> - As explained in the comment in the code block, if set to <code>true</code>,
this prevents the state from being changed directly without using the methods
defined in the <code>mutations</code> property.</li>
<li><code>state</code> - This is an object that is used to initialise the state. Corum only
uses two state properties, <code>userId</code> and <code>username</code>.</li>
<li><code>mutations</code> - This is a object of functions that can be called to mutate the
<code>state</code> object, as well as perform other operations, such as setting or
removing data from the browsers <code>localStorage</code>.</li>
</ul>
<p>There are three mutation methods in Corum's store. <code>logout</code>, <code>saveUserData</code> and
<code>updateUserState</code>. <code>logout</code> removes saved data from the browsers <code>localStorage</code>
as well as from the store. This mutation is called when the <code>logout</code> button is
pressed in the sites header. <code>saveUserData</code> updates the browsers <code>localStorage</code>
and the store with the data passed in. This mutation is called when logging the
user into the site, or after a user signs up (As it also logs them in).
<code>updateUserState</code> updates the state by fetching the data from the browser's
<code>localStorage</code>. This is needed as <code>localStorage</code> persists in the browser across
visits, whereas Corum's global state cannot persist. Upon every visit, this
mutation is called. This means that a user can be kept logged into Corum across
visits.</p>
<a class="header" href="print.html#api-analysis" id="api-analysis"><h1>API Analysis</h1></a>
<a class="header" href="print.html#api-schema" id="api-schema"><h2>API Schema</h2></a>
<p>The schema of the API was created during the design phase of the project.
However, so it is easier to understand the code in this section, I will repeat
it here:</p>
<pre><code class="language-graphql">type User @model {
  id: ID! @isUnique
  username: String! @isUnique
  email: String! @isUnique
  password: String!
  posts: [Post!]! @relation(name: &quot;UserToPost&quot;)
  votes: [Vote!]! @relation(name: &quot;UserToVote&quot;)
  favorites: [Favorite!]! @relation(name: &quot;UserToFavorite&quot;)
}

type Subforum @model {
  id: ID! @isUnique
  url: String! @isUnique
  name: String!
  posts: [Post!]! @relation(name: &quot;SubforumToPost&quot;)
  favorites: [Favorite!]! @relation(name: &quot;SubforumToFavorite&quot;)
}

type Favorite @model {
  id: ID! @isUnique
  user: User! @relation(name: &quot;UserToFavorite&quot;)
  subforum: Subforum! @relation(name: &quot;SubforumToFavorite&quot;)
}

type Post @model {
  id: ID! @isUnique
  subforum: Subforum! @relation(name: &quot;SubforumToPost&quot;)
  title: String!
  author: User! @relation(name: &quot;UserToPost&quot;)
  content: String!
  voteCount: Int
  createdAt: DateTime!
  comments: [Comment!]! @relation(name: &quot;PostToComment&quot;)
  votes: [Vote!]! @relation(name: &quot;PostToVote&quot;)
}

type Comment @model {
  id: ID! @isUnique
  post: Post! @relation(name: &quot;PostToComment&quot;)
  author: String!
  content: String!
}

type Vote @model {
  id: ID! @isUnique
  post: Post! @relation(name: &quot;PostToVote&quot;)
  user: User! @relation(name: &quot;UserToVote&quot;)
  vote: VoteType!
}

enum VoteType {
  VOTE_UP
  VOTE_DOWN
}
</code></pre>
<p>Here is a graphical representation of the schema above:</p>
<p><img src="images/api-schema-graph-view.png" alt="Graph View of API Schema" /></p>
<a class="header" href="print.html#permission-configuration" id="permission-configuration"><h2>Permission Configuration</h2></a>
<pre><code class="language-yml"># Where 'authenticated: true' is present in an operation,
# the client must pass along their JWT auth token in the
# request headers. (In the form -&gt; Authorization: 'Bearer ${TOKEN}')

permissions:
    # User Permissions

    # Allows access to User from Post
    # Only the username field is made queryable. This means
    # that malicious users cannot query for someones elses
    # information such as their password, id, or email.
  - operation: User.read  
    fields: [username]

  # Subforum Permissions
  - operation: Subforum.create
    authenticated: true
  - operation: Subforum.read

  # Favorite Permissions
  - operation: Favorite.create
    authenticated: true
  - operation: Favorite.read
  - operation: Favorite.delete
    authenticated: true

  # Post Permissions
  - operation: Post.create
    authenticated: true
  - operation: Post.read

  # Comment Permissions
  - operation: Comment.create
    authenticated: true
  - operation: Comment.read

  # Vote Permissions
  - operation: Vote.create
    authenticated: true
  - operation: Vote.read
  - operation: Vote.update
    authenticated: true
  - operation: Vote.delete
    authenticated: true

  # Relation Permissions
  - operation: SubforumToPost.connect
    authenticated: true
  - operation: PostToComment.connect
    authenticated: true
  - operation: UserToPost.connect
    authenticated: true
  - operation: UserToVote.connect
    authenticated: true
  - operation: PostToVote.connect
    authenticated: true
  - operation: UserToFavorite.connect
    authenticated: true
  - operation: SubforumToFavorite.connect
    authenticated: true
</code></pre>
<p>As mentioned in the '<a href="print.html#how-graphcool-works">How Graphcool Works</a>' section,
graphcool needs a configuration file called <code>graphcool.yml</code>. Most of this file
is just boilerplate to link the below hook functions into graphcool, however a
very important part of this file is the <code>permissions</code> section.</p>
<p>This section allows you to define exactly who can do what with the API. This is
crucial to the proper functioning of Corum as it stops non authenticated users
from doing things like creating posts, creating comments and voting on posts.</p>
<p>This configuration file is written in <code>yml</code>.</p>
<p>So in this file, <code>permissions</code> is a list of objects. Each object in the
<code>permissions</code> array specifies the <code>operation</code> to configure. The operations that
can be configured are derived from the API schema. (Linked above)</p>
<p>For example, The <code>Vote</code> data type found in the schema can have the following
operations configured:</p>
<ul>
<li><code>Vote.create</code></li>
<li><code>Vote.read</code></li>
<li><code>Vote.update</code></li>
<li><code>Vote.delete</code></li>
</ul>
<p>These operations are found on every data type in the schema. (Which are CRUD
operations) You can also specify permissions for relations. This is important
because creating a relationship between data types means that both data type
instances are mutated. For example, the following operations can be specified
for the <code>UserToPost</code> relation which links a user to the post they created:</p>
<ul>
<li><code>UserToPost.connect</code></li>
<li><code>UserToPost.Disconnect</code></li>
</ul>
<p>If a certain operation is not specified, (for example, there is not
<code>Favorite.update</code> operation in this configuration) then nothing (expect hook
functions given root tokens) can perform this operation.</p>
<p>If an object in the <code>permissions</code> section specifies an <code>authenticated</code> property
of <code>true</code>, the operation can only be performed by authenticated users (Users
that are logged in)</p>
<p>If an object in the <code>permission</code> section specifies a <code>field</code> property, then
operation is restricted to only the values found in the array passed to it. For
example, in Corum's API, anyone can read from the <code>Username</code> data type, however
they can only read the <code>username</code> field.</p>
<a class="header" href="print.html#hook-functions" id="hook-functions"><h2>Hook Functions</h2></a>
<a class="header" href="print.html#userandsubforumisunique" id="userandsubforumisunique"><h3><code>userAndSubforumIsUnique</code></h3></a>
<pre><code class="language-js">import { fromEvent } from 'graphcool-lib'
import { makeRequest } from '../../utils/common'

/*
  This is a hook function that executes every time before a favorite is created.
  It ensures that only 1 favorite of a subforum by a single user can happen.
*/

const favoriteQuery = `
query FavoriteQuery($userId: ID!, $subforumId: ID!) {
  allFavorites(
    filter: { AND: [{ user: { id: $userId } }, { subforum: { id: $subforumId } }] }
  ) {
    id
  }
}
`

export default async event =&gt; {
  try {
    // Create Graphcool API (based on https://github.com/graphcool/graphql-request)
    const api = fromEvent(event).api('simple/v1')

    // Retrieve payload from event
    const { data } = event
    const { userId, subforumId } = data

    const { allFavorites } = await makeRequest(api, favoriteQuery, {
      userId,
      subforumId
    })

    if (allFavorites.length === 0) {
      return { data }
    } else {
      return { error: 'This user has already favorited this subforum' }
    }
  } catch (error) {
    return { error }
  }
}
</code></pre>
<p>As mentioned in the comment at the top of this file, This hook function ensures
that only 1 favorite of a subforum by a single user can happen, and it is run
every time before a favorite is created. There is also a hook function called
<code>userAndPostIsUnique</code> is very similar. Instead of ensuring that only unique
favorites can be added, it ensures that only unique votes can be made on a post.
As this hook function is so similar, I will only analyse this hook function.</p>
<p>Variable Reference:</p>
<ul>
<li><code>favoriteQuery</code> is the GraphQL query used to check if the user has already
favorited of this subforum.</li>
<li><code>event</code>this is an object containing all of the information about the query or
mutation event we are hooking into.</li>
<li><code>fromEvent</code> is a function exposed by the library <code>graphcool-lib</code> that
constructs a GraphQL client from the <code>event</code> data passed into the function.
This allows us to send queries and mutations to the API from within the API
code.</li>
<li><code>makeRequest</code> is an abstraction of a function provided by <code>graphcool-lib</code> that
allows us to send queries and mutations to the API. The exact implementation
of this function is described later on.</li>
</ul>
<p>First, <code>fromEvent</code> and <code>makeRequest</code> are imported so that they can be used in
this file. Next, we export a function that expects the <code>event</code> argument. The
reason we do this is because graphcool expects hook function files to export a
function that it can call when needed.</p>
<p>Within this function, using the <code>fromEvent</code> function, a reference to the API is
created from the <code>event</code> data and assigned to the variable <code>api</code>. This variable
will be passed into the <code>makeRequest</code> function so that it knows what API to make
the request to.</p>
<p>Next, the data the client submitted to the API is extracted from the <code>data</code>
property of the <code>event</code> argument. For this hook function, we extract <code>userId</code>
and <code>subforumId</code>. Then, a call to the <code>makeRequest</code> function is made, passing in
the API reference created earlier, the GraphQL query that we want to execute,
along with the variable needed to perform the query. In this case, both the
<code>userId</code> and <code>subforumId</code> are passed as variables to the query.</p>
<p>Once the query has successfully been executed, the function will return the data
response. In this case, we are only interested in the <code>allFavorites</code> value that
is returned. This is an array of <code>Favorite</code> objects that belong to the user and
match the subforum they are attempting to create a favorite for. This means that
if the array has any <code>Favorite</code> objects in it, the user has already favorited
this subforum.</p>
<p>This check is made by checking if the length of the array is 0. (empty) If the
array is empty, then the user has not favorited this subforum already, so they
should allow to favorite it. In this case, the data submitted by the user is
saved to the database. If the length of the array is anything other than 0, then
user should not be allowed to create a favorite. An error is returned to the
user and the data is not saved.</p>
<a class="header" href="print.html#initvotecount" id="initvotecount"><h3><code>initVoteCount</code></h3></a>
<pre><code class="language-js">// Ensures that when a post is created, the vote Count is set to 0

export default event =&gt; {
  const { data } = event
  data.voteCount = 0
  return { data }
}
</code></pre>
<p>This is the simplest hook function used in Corum. As mentioned in the code
comment, when a <code>Post</code> is created, the <code>voteCount</code> field on it is set to 0. This
is so that malicious users cannot initialise a post with however many votes they
want.</p>
<a class="header" href="print.html#updatevotecountonvotecreation" id="updatevotecountonvotecreation"><h3><code>updateVoteCountOnVoteCreation</code></h3></a>
<pre><code class="language-js">import { fromEvent } from 'graphcool-lib'
import {
  VOTE_COUNT_TO_DELETE_POST,
  makeRequest,
  deleteAllVotesOnPost,
  postIdFromVoteQuery,
  currentPostVoteCount,
  getAllVoteIdsOnPost,
  deleteVote,
  deletePost,
  updatePost
} from '../../utils/common'

/*
  This is a hook function that executes every time after a vote is created.
  It updates the voteCount field on the post to reflect the vote creation.
  Also, if the new vote count is equal or less than the VOTE_COUNT_TO_DELETE_POST
  constant, then the post will be deleted (The automated management system)
*/

export default async event =&gt; {
  try {
    // Create Graphcool API (based on https://github.com/graphcool/graphql-request)
    const api = fromEvent(event).api('simple/v1')

    // Retrieve payload from event
    const { data } = event
    const voteId = data.id
    const voteType = data.vote

    const { Vote } = await makeRequest(api, postIdFromVoteQuery, { voteId })
    const postId = Vote.post.id

    const { Post } = await makeRequest(api, currentPostVoteCount, { postId })
    const oldVoteCount = Post.voteCount

    let newVoteCount
    if (voteType === 'VOTE_UP') {
      newVoteCount = oldVoteCount + 1
    } else if (voteType === 'VOTE_DOWN') {
      newVoteCount = oldVoteCount - 1
    } else {
      return Promise.reject('voteType is invalid or is not defined')
    }

    if (newVoteCount &lt;= VOTE_COUNT_TO_DELETE_POST) {
      await deleteAllVotesOnPost(api, postId)
      return await makeRequest(api, deletePost, { postId })
    } else {
      return await makeRequest(api, updatePost, { postId, newVoteCount })
    }
  } catch (error) {
    return { error }
  }
}
</code></pre>
<p>As mentioned at the top of this file, this hook function executes every time
after a <code>Vote</code> is created. It updates the <code>voteCount</code> field on the post to
reflect the vote creation. Also, if the new vote count is equal or less than the
<code>VOTE_COUNT_TO_DELETE_POST</code> constant, then the post will be deleted (The
automated management system)</p>
<p>As this check has to be made on every possible CRUD operation that may modify
the overall vote count, there are also hook functions for when a vote is updated
or deleted called <code>updateVoteCountOnVoteUpdate</code> and
<code>updateVoteCountOnVoteDeletion</code> respectively. These hook functions are very
similar, so I will only be analysing the 'creation' version of the hook
functions as shown above.</p>
<p>Variable Reference:</p>
<ul>
<li><code>event</code>this is an object containing all of the information about the query or
mutation event we are hooking into.</li>
<li><code>fromEvent</code> is a function exposed by the library <code>graphcool-lib</code> that
constructs a GraphQL client from the <code>event</code> data passed into the function.
This allows us to send queries and mutations to the API from within the API
code.</li>
<li><code>makeRequest</code> is an abstraction of a function provided by <code>graphcool-lib</code> that
allows us to send queries and mutations to the API. The exact implementation
of this function is described later on.</li>
<li><code>deleteAllVotesOnPost</code> is a function that as the name suggests, deletes all
votes on a post. The implementation of this function is described later on.</li>
<li><code>postIdFromVoteQuery</code> is GraphQL query that fetches the post's ID that a vote
was made on.</li>
<li><code>currentPostVoteCount</code> is a GraphQL query that fetches the the current vote
count of a post.</li>
<li><code>getAllVoteIdsOnPost</code> is a GraphQL query that fetches all votes that exist on
a post.</li>
<li><code>deleteVote</code> is a GraphQL mutation that deletes a vote.</li>
<li><code>deletePost</code> is a GraphQL mutation that deletes a post.</li>
<li><code>updatePost</code> is a GraphQL mutation that updates a post with a new post count.</li>
</ul>
<p>Like the first hook function shown in this section, this function imports what
it needs and exports a function for graphcool. Also like the first hook
function, a reference to the API is created and the user data is extracted.</p>
<p>This time, <code>voteId</code> and <code>voteType</code> are extracted from the data object. Next, a
request is made to get the post ID using the <code>voteId</code> variable. When the API
responds, the post ID fetched is used to fetch the current vote count on that
post.</p>
<p>Then, depending on how the user voted, (determined by the contents of the
<code>voteType</code> variable) A new vote count is created. If the user upvoted the post,
the vote count is increment by 1. If the user downvoted the post, the vote count
is decremented by 1. There is also error handling if they somehow submitted an
incorrect vote type.</p>
<p>If <code>voteType</code> was defined, the function continues and goes on to update the post
data stored in the database. This is where the automated management system
works. If the new vote count is less than or equal to the defined threshold
stored in <code>VOTE_COUNT_TO_DELETE_POST</code>, the post is deleted along with all of the
votes that were linked to it. Otherwise, the post is updated with the new vote
count.</p>
<a class="header" href="print.html#resolvers" id="resolvers"><h2>Resolvers</h2></a>
<p>Resolvers are the most powerful way to extend graphcool. They make it so that
you can add extra queries and mutations to the API. In the case of Corum, only
two custom resolvers are needed. One to sign up users and one to authenticate
users.</p>
<a class="header" href="print.html#signup" id="signup"><h3><code>signup</code></h3></a>
<pre><code class="language-js">import { fromEvent } from 'graphcool-lib'
import * as bcryptjs from 'bcryptjs'
import * as validator from 'validator'
import { makeRequest } from '../../utils/common'

const userQuery = `
  query UserQuery($email: String!, $username: String!) {
    allUsers(filter: { OR: [{ email: $email }, { username: $username }] }) {
      id
      email
      username
    }
  }
`

const createUserMutation = `
  mutation CreateUserMutation(
    $username: String!
    $email: String!
    $passwordHash: String!
  ) {
    createUser(username: $username, email: $email, password: $passwordHash) {
      id
    }
  }
`

export default async event =&gt; {
  try {
    // Create Graphcool API (based on https://github.com/graphcool/graphql-request)
    const graphcool = fromEvent(event)
    const api = graphcool.api('simple/v1')

    // Retrieve payload from event
    const { username, email, password } = event.data

    // Check is email is valid
    if (validator.isEmail(email) === false) {
      return { error: 'The email address entered is not valid' }
    }

    // Fetch all users that match the users input (if any)
    const { allUsers } = await makeRequest(api, userQuery, { email, username })

    // If no users exists with the same details, create the user
    if (allUsers.length === 0) {
      const SALT_ROUNDS = 10

      // Generate the password hash that will be stored in the DB
      const passwordHash = await bcryptjs.hash(password, SALT_ROUNDS)

      // Create the user
      const { createUser } = await makeRequest(api, createUserMutation, {
        email,
        username,
        passwordHash
      })

      // Generate auth token
      const { id } = createUser
      const token = await graphcool.generateAuthToken(id, 'User')

      // Return the payload the user asked for
      return {
        data: {
          id,
          token
        }
      }
    }

    // If any users do exist, throw the correct informative error
    if (
      allUsers.length === 2 ||
      (allUsers[0].email === email &amp;&amp; allUsers[0].username === username)
    ) {
      return { error: 'The email address and username are in use' }
    } else if (allUsers[0].email === email) {
      return { error: 'The email address is in use' }
    } else if (allUsers[0].username === username) {
      return { error: 'The username is in use' }
    } else {
      return { error: 'An unknown error occurred' }
    }
  } catch (error) {
    return { error }
  }
}
</code></pre>
<p>This is the resolver that is used to create a new user account.</p>
<p>Variable Reference:</p>
<ul>
<li><code>event</code>this is an object containing all of the information about the query or
mutation event we are hooking into.</li>
<li><code>fromEvent</code> is a function exposed by the library <code>graphcool-lib</code> that
constructs a GraphQL client from the <code>event</code> data passed into the function.
This allows us to send queries and mutations to the API from within the API
code.</li>
<li><code>makeRequest</code> is an abstraction of a function provided by <code>graphcool-lib</code> that
allows us to send queries and mutations to the API. The exact implementation
of this function is described later on.</li>
<li><code>bcryptjs</code> is a hashing library implementing the bcrypt hashing function
design. In this resolver, only the <code>hash</code> function exposed by it is used. The
use of this function will explained below.</li>
<li><code>validator</code> is a library that can validate many types of data such as emails,
passwords, credit card numbers etc. In this resolver, only the <code>isEmail</code>
function is used.</li>
<li><code>userQuery</code> is a GraphQL query that fetches a users details. (Their account
ID, email and username)</li>
<li><code>createUserMutation</code> is a GraphQL mutation that creates a user.</li>
</ul>
<p>Like the first hook function shown in this section, this function imports what
it needs and exports a function for graphcool. Also like the hook functions, a
reference to the API is created and the user data is extracted.</p>
<p>This time, <code>username</code>, <code>email</code> and <code>password</code> are extracted from the data
object. Next, using the <code>isEmail</code> function found in the <code>validator</code> library, the
email the user entered is checked to be valid. Internally, the <code>isEmail</code>
function is probably using regular expressions to ensure that it contains things
such as an <code>@</code> symbol etc. The <code>isEmail</code> function returns a boolean value. If it
returns <code>true</code>, the email passed to it is valid. If it returns <code>false</code>, the
email passed to it is not valid. In this case, an error is returned telling the
user that '<code>The email address entered is not valid</code>'.</p>
<p>Next, a request is made using the <code>userQuery</code> query passing in the email and
username the user entered. This will return an array of <code>User</code> objects that have
either the same email or username that the user inputted. If the array returned
is empty, (length equals 0) then no users exists with either the same email or
username. This means that a new account can be created with these details.</p>
<p>First, a variable called <code>SALT_ROUNDS</code> is initialised to the value <code>10</code>. This is
created because the bcrypt hashing function has a built in salt. This is helpful
for security reasons as it means that passwords hashed with bcrypt can easily be
protected against rainbow table attacks.</p>
<p>Then the hash is created from the password with the <code>hash</code> function. This
expects two arguments. The first argument being the string to hash, and the
second being the number of times to run the salt. Once the function finishes,
the function returns the hash.</p>
<p>Next, a request is made using the <code>createUserMutation</code> mutation passing in the
email and the username the user entered, as well as the newly created password
hash. This mutation will create a new user record with these details.</p>
<p>After that, we extract the user's ID from the above mutation response. Then we
generate an authentication token for the user using the <code>generateAuthToken</code> on
the <code>graphcool</code> object that was created using the <code>fromEvent</code> function earlier.
This token will allow the user perform protected actions such as creating posts
etc.</p>
<p>Then finally, we return the data the user wanted.</p>
<p>In the case that the array returned from the <code>userQuery</code> request is not empty,
this means that a user exists with some of the same data the user entered. In
order to return a useful error message to the user, a few checks are made.</p>
<p>These checks are pretty self explanatory, however, I will list the cases that
these checks cover:</p>
<ul>
<li>When both the username and password are in use, then the following could be
possible:
<ul>
<li>There are 2 separate accounts, one with the same email and another with the
same username</li>
<li>There is 1 account with the same email and the same username</li>
</ul>
</li>
<li>When only the email is in use, there could only be 1 account with the same
email</li>
<li>When only the username is in use, there could only be 1 account with the same
username</li>
<li>There is also an else statement at the end in case something that I haven't
thought of occurs</li>
</ul>
<p>Also, if any other error occurred in the function, this is caught with the
surrounding <code>try / catch</code> statement, then returned to the user.</p>
<a class="header" href="print.html#authenticate" id="authenticate"><h3><code>authenticate</code></h3></a>
<pre><code class="language-js">import { fromEvent } from 'graphcool-lib'
import * as bcryptjs from 'bcryptjs'
import { makeRequest } from '../../utils/common'

const userQuery = `
  query UserQuery($email: String!) {
    User(email: $email) {
      id
      password
      username
    }
  }
`

export default async event =&gt; {
  try {
    // Create Graphcool API (based on https://github.com/graphcool/graphql-request)
    const graphcool = fromEvent(event)
    const api = graphcool.api('simple/v1')

    // Retrieve payload from event
    const { email, password } = event.data

    // Check if a user exists with the email entered
    const { User } = await makeRequest(api, userQuery, { email })
    if (!User) {
      return { error: 'Invalid credentials' }
    }

    // Check if the user entered the correct password for the user
    const passwordIsCorrect = await bcryptjs.compare(password, User.password)
    if (!passwordIsCorrect) {
      return { error: 'Invalid credentials' }
    }

    // Generate auth token
    const { id, username } = User
    const token = await graphcool.generateAuthToken(id, 'User')

    // Return the payload the user asked for
    return {
      data: {
        id,
        username,
        token
      }
    }
  } catch (error) {
    return { error }
  }
}
</code></pre>
<p>This is the resolver that is used to authenticate users that have already
created an account. (Through the <code>signup</code> resolver)</p>
<p>Variable Reference:</p>
<ul>
<li><code>event</code>this is an object containing all of the information about the query or
mutation event we are hooking into.</li>
<li><code>fromEvent</code> is a function exposed by the library <code>graphcool-lib</code> that
constructs a GraphQL client from the <code>event</code> data passed into the function.
This allows us to send queries and mutations to the API from within the API
code.</li>
<li><code>makeRequest</code> is an abstraction of a function provided by <code>graphcool-lib</code> that
allows us to send queries and mutations to the API. The exact implementation
of this function is described later on.</li>
<li><code>bcryptjs</code> is a hashing library implementing the bcrypt hashing function
design. In this resolver, only the <code>compare</code> function exposed by it is used.
The use of this function will explained below.</li>
<li><code>userQuery</code> is a GraphQL query that fetches a users details. (Their account
ID, username and password)</li>
</ul>
<p>Like the first hook function shown in this section, this function imports what
it needs and exports a function for graphcool. Also like the hook functions, a
reference to the API is created and the user data is extracted.</p>
<p>This time, <code>email</code> and <code>password</code> are extracted from the data object. Next, a
request is made using the <code>userQuery</code> query to fetch the users details from the
email address the user inputted. When the API responds, a check is made to
ensure that a user with the email the user typed in actually exists. If a user
doesn't exist, a generic '<code>Invalid Credentials</code>' error is thrown. This means
that the API sends back this error message to the client for it to display it to
the user.</p>
<p>If a user does exist with the email the user specified, then we can continue to
make further checks. Next, using the <code>bcryptjs.compare</code> function, the password
the user entered is checked against the hash that was fetched earlier from the
database. The <code>compare</code> function takes two arguments. The first argument being
the raw password that hasn't been hashed. The second argument being the password
to check against that has been hashed. Internally, the function hashes the
password and then compares it against the second argument. If they match, the
function will return <code>true</code>, if the hashes don't match, the function will return
<code>false</code>.</p>
<p>This comparison function is asynchronous, so we must <code>await</code> the return value.
Once the function returns the boolean value, another check is made. If the
function returned false, meaning the password the user entered wasn't correct,
then the same generic '<code>Invalid Credentials</code>' error. The reason we throw the
same error on both cases is because it makes it harder for an attacker to gain
unauthorised accessed to another users account. This is because they can't tell
if the user or password is the thing they have got incorrect.</p>
<p>If a user exists with both the email and password the user specified, we have a
high degree of confidence that the user is who they say they are. This means
that we can start to construct the information to return to the user. First, we
extract the user's ID and username off of the <code>User</code> object. Then we generate an
authentication token for the user using the <code>generateAuthToken</code> on the
<code>graphcool</code> object that was created using the <code>fromEvent</code> function earlier. This
token will allow the user perform protected actions such as creating posts etc.</p>
<p>Then finally, we return the data the user wanted. Also, if any other error
occurred in the function, this is caught with the surrounding <code>try / catch</code>
statement, then returned to the user.</p>
<a class="header" href="print.html#utility-functions-and-constants" id="utility-functions-and-constants"><h2>Utility Functions and Constants</h2></a>
<a class="header" href="print.html#vote_count_to_delete_post" id="vote_count_to_delete_post"><h3><code>VOTE_COUNT_TO_DELETE_POST</code></h3></a>
<pre><code class="language-js">export const VOTE_COUNT_TO_DELETE_POST = -1
</code></pre>
<p>This number determines the amount of votes required for the post to be deleted
by the automatic post management system.</p>
<a class="header" href="print.html#makerequest" id="makerequest"><h3><code>makeRequest</code></h3></a>
<pre><code class="language-js">/*
  A wrapper around the fromEvent(event).request that is provided
  by 'graphcool-lib' to handle errors in query responses.
*/
export const makeRequest = async (api, query, variables) =&gt; {
  const queryResult = await api.request(query, variables)

  if (queryResult.error) {
    return Promise.reject(queryResult.error)
  } else {
    return queryResult
  }
}
</code></pre>
<p>As explained in the code comment, this is simply a wrapper around the function
<code>request</code> that is on the object returned by the <code>fromEvent</code> function. The reason
this function was created was so that I didn't have to rewrite the same error
checking functionality with every request made.</p>
<p>It accepts the following arguments:</p>
<ul>
<li><code>api</code> is a reference to the API object created from the <code>fromEvent</code> function</li>
<li><code>query</code> is the GraphQL query or mutation to execute against the API</li>
<li><code>variables</code> is an object of variables that are used in the query or mutation</li>
</ul>
<p>It returns a promise that is either resolved with the result, or rejected with
the error.</p>
<a class="header" href="print.html#deleteallvotesonpost" id="deleteallvotesonpost"><h3><code>deleteAllVotesOnPost</code></h3></a>
<pre><code class="language-js">/*
  Currently, the CRUD API generated by graphcool does not expose a
  query that allows you to update or delete multiple data records at
  once.

  It looks like this feature is coming in the graphcool 1.0 release.
  https://github.com/graphcool/framework/issues/81

  In the meantime, this function will be used to delete all the Votes
  on a Post record. This is required because graphcool doesn't allow
  you to delete records that would leave other records orphans.

  In the case of the Post type, if it was deleted, it would leave the
  Vote records that reference the Post, orphans. To allow us to delete
  a post, we must first delete the Votes that reference it.
*/
export const deleteAllVotesOnPost = async (api, postId) =&gt; {
  const { allVotes } = await makeRequest(api, getAllVoteIdsOnPost, { postId })
  const voteIdList = allVotes.map(vote =&gt; vote.id)

  return await Promise.all(
    voteIdList.map(voteId =&gt; {
      return makeRequest(api, deleteVote, { voteId })
    })
  )
}
</code></pre>
<p>The reason for this function is best explained in the code comment above.</p>
<p>Variable Reference:</p>
<ul>
<li><code>getAllVoteIdsOnPost</code> is a GraphQL query that gets all the <code>Vote</code> object IDs
that are associated with the post specified.</li>
</ul>
<p>It accepts the following arguments:</p>
<ul>
<li><code>api</code> is a reference to the API object created from the <code>fromEvent</code> function</li>
<li><code>postId</code> is the post's ID to delete the votes on</li>
</ul>
<p>It returns a promise that is resolved with the array of the deleted vote IDs.</p>
<p>First, a request is made using the <code>getAllVoteIdsOnPost</code> query passing in
<code>postId</code> as the queries variables. As mentioned above, this returns an array of
<code>Vote</code> objects each with an <code>id</code> property.</p>
<p>Then, using JavaScript built in <code>map</code> method present on the <code>Array</code> prototype,
an array is created of just the ID strings. If you do not know what a map
function does, it takes an array as input, performs an arbitrary action on each
item of the array, and then returns a new array of length. The JavaScript
implementation expects a function as input. This function will be executed on
each item of the array. To find out more about the <code>map</code> function, visit the MDN
(Mozilla Developer Network) website and search for <code>Array.prototype.map</code>.</p>
<p>Finally, a call to <code>Promise.all</code> is made. This function takes in an array of
promises and returns a promise. The array of promises are executed in parallel,
and the promise only resolves when all items in the promise array have resolved.
If any of the promises reject, the returned promise will reject with that
promises rejection error. To find out more about the <code>map</code> function, visit the
MDN website and search for <code>Promise.all</code>.</p>
<p>In this function, the array of vote IDs are mapped to an array of promises that
will make a request to delete the vote in the database with the corresponding
ID. This array is used as the argument to <code>Promise.all</code>. This means that This
function will resolve when all of the votes in the array have been deleted.</p>
<a class="header" href="print.html#evaluation" id="evaluation"><h1>Evaluation</h1></a>
<p>In this section of the report, I will be doing the following:</p>
<ul>
<li>Doing final testing to ensure success criteria has been met</li>
<li>Outlining usability features of Corum</li>
<li>Performing a final evaluation of the success of the solution, its limitations,
and its possible maintenance issues</li>
</ul>
<a class="header" href="print.html#testing-1" id="testing-1"><h1>Testing</h1></a>
<ul>
<li>Talk about testing during development (relate to automated tests)</li>
<li>Say that these manual tests could have been automated with e2e / cypress</li>
<li>However, they do not mean unit tests are pointless</li>
</ul>
<a class="header" href="print.html#signup-page-2" id="signup-page-2"><h1>Signup Page</h1></a>
<p>These also show the following:</p>
<ul>
<li>The url can be seen at the top (<code>/signup</code>)</li>
<li>The Sign Up button in the header is highlighted correctly</li>
<li>On submit, the sign up button is no clickable and says 'Please Wait...'</li>
</ul>
<a class="header" href="print.html#successful-signup-attempt" id="successful-signup-attempt"><h2>Successful Signup Attempt</h2></a>
<ul>
<li>The user is redirected to the page they were on before if successful</li>
<li>The logged in state has been changed (Show in navigation and header)</li>
<li>It is assumed that the email and username are not already taken</li>
</ul>
<p>Location: <strong><code>images/gifs/signup/correct.gif</code></strong></p>
<p><img src="images/gifs/signup/correct.gif" alt="Successful Signup Attempt GIF" /></p>
<a class="header" href="print.html#input-validation" id="input-validation"><h2>Input validation</h2></a>
<ul>
<li>Mention that the validation code can be found below (maybe link)</li>
<li>The Sign Up button can only be pressed when:
<ul>
<li>All fields have been filled</li>
<li>The two passwords fields match</li>
</ul>
</li>
<li>In this GIF, it can be seen that the passwords do not match, as they of
different length</li>
</ul>
<p>Location: <strong><code>images/gifs/signup/input-validation.gif</code></strong></p>
<p><img src="images/gifs/signup/input-validation.gif" alt="Input validation GIF" /></p>
<a class="header" href="print.html#email-is-already-taken" id="email-is-already-taken"><h2>Email is Already Taken</h2></a>
<ul>
<li>The correct error message is displayed</li>
<li>It is assumed that the email <code>test@test.com</code> is already taken</li>
<li>It is assumed that the username <code>test12345</code> is not taken</li>
</ul>
<p>Location: <strong><code>images/gifs/signup/email-taken.gif</code></strong></p>
<p><img src="images/gifs/signup/email-taken.gif" alt="Username taken GIF" /></p>
<a class="header" href="print.html#username-is-already-taken" id="username-is-already-taken"><h2>Username is Already Taken</h2></a>
<ul>
<li>The correct error message is displayed</li>
<li>It is assumed that the username <code>test</code> is already taken</li>
<li>It is assumed that the email <code>test123@test.com</code> is not taken</li>
</ul>
<p>Location: <strong><code>images/gifs/signup/username-taken.gif</code></strong></p>
<p><img src="images/gifs/signup/username-taken.gif" alt="Username taken GIF" /></p>
<a class="header" href="print.html#email-and-username-are-already-taken" id="email-and-username-are-already-taken"><h2>Email and Username are Already Taken</h2></a>
<ul>
<li>The correct error message is displayed</li>
<li>It is assumed that the email <code>test@test.com</code> is already taken</li>
<li>It is assumed that the username <code>test</code> is already taken</li>
</ul>
<p>Location: <strong><code>images/gifs/signup/both-taken.gif</code></strong></p>
<p><img src="images/gifs/signup/both-taken.gif" alt="Both taken GIF" /></p>
<a class="header" href="print.html#navigating-to-the-login-page" id="navigating-to-the-login-page"><h2>Navigating to the Login Page</h2></a>
<ul>
<li>The link provided on the signup page to the login page works</li>
</ul>
<p>Location: <strong><code>images/gifs/signup/login-link.gif</code></strong></p>
<p><img src="images/gifs/signup/login-link.gif" alt="Successful Login Attempt GIF" /></p>
<a class="header" href="print.html#login-page-2" id="login-page-2"><h1>Login Page</h1></a>
<p>These also show the following:</p>
<ul>
<li>The url can be seen at the top (<code>/login</code>)</li>
<li>The login button in the header is highlighted correctly</li>
<li>The login button is only clickable when both fields have been filled</li>
<li>On submit, the login button is no clickable and says 'Please Wait...'</li>
</ul>
<a class="header" href="print.html#successful-login-attempt" id="successful-login-attempt"><h2>Successful Login Attempt</h2></a>
<ul>
<li>The user is redirected to the page they were on before if successful</li>
<li>The logged in state has been changed (Show in navigation and header)</li>
</ul>
<p>Location: <strong><code>images/gifs/login/correct.gif</code></strong></p>
<p><img src="images/gifs/login/correct.gif" alt="Successful Login Attempt GIF" /></p>
<a class="header" href="print.html#unsuccessful-login-attempt" id="unsuccessful-login-attempt"><h2>Unsuccessful Login Attempt</h2></a>
<ul>
<li>The error message is displayed to the user when an attempt is not successful</li>
<li>Once the user dismisses the error, (With the button or the enter key) they are
free to try again</li>
</ul>
<p>Location: <strong><code>images/gifs/login/invalid-credentials.gif</code></strong></p>
<p><img src="images/gifs/login/invalid-credentials.gif" alt="Unsuccessful Login Attempt GIF" /></p>
<a class="header" href="print.html#navigating-to-the-signup-page" id="navigating-to-the-signup-page"><h2>Navigating to the Signup Page</h2></a>
<ul>
<li>The link provided on the login page to the signup page works</li>
</ul>
<p>Location: <strong><code>images/gifs/login/signup-link.gif</code></strong></p>
<p><img src="images/gifs/login/signup-link.gif" alt="Navigating to the Signup Page GIF" /></p>
<a class="header" href="print.html#navigation-1" id="navigation-1"><h1>Navigation</h1></a>
<a class="header" href="print.html#links-to-subforums-work" id="links-to-subforums-work"><h2>Links to Subforums Work</h2></a>
<ul>
<li>The links navigate to the correct subforum page</li>
<li>When on a subforum, it is highlighted in the navigation</li>
</ul>
<p>Location: <strong><code>images/gifs/navigation/links.gif</code></strong></p>
<p><img src="images/gifs/navigation/links.gif" alt="Links to Subforums Work GIF" /></p>
<a class="header" href="print.html#search-functionality-works" id="search-functionality-works"><h2>Search Functionality Works</h2></a>
<ul>
<li>The 'All Subforums' list is filtered by the search input</li>
<li>The search is case insensitive</li>
<li>Mention the filtering code below (Link)</li>
<li>When no items match the search term, show a message</li>
</ul>
<p>Location: <strong><code>images/gifs/navigation/search.gif</code></strong></p>
<p><img src="images/gifs/navigation/search.gif" alt="Search Functionality Works GIF" /></p>
<ul>
<li>If the user is logged in and no items match, show a slightly different message
with a link to create a subforum</li>
<li>Link to the create a subforum page works</li>
</ul>
<p>Location: <strong><code>images/gifs/navigation/search-logged-in.gif</code></strong></p>
<p><img src="images/gifs/navigation/search-logged-in.gif" alt="Logged in search message GIF" /></p>
<a class="header" href="print.html#navigation-shows-favorites-when-logged-in" id="navigation-shows-favorites-when-logged-in"><h2>Navigation shows Favorites when Logged In</h2></a>
<ul>
<li>When the user logs in, the navigation updates correctly</li>
<li>The favorites section is not shown when a user is not logged in</li>
</ul>
<p>Location: <strong><code>images/gifs/navigation/login.gif</code></strong></p>
<p><img src="images/gifs/navigation/login.gif" alt="Favorites shown on login GIF" /></p>
<a class="header" href="print.html#favorites-works" id="favorites-works"><h2>Favorites Works</h2></a>
<ul>
<li>When the user has favorites, they are displayed in the favorites section</li>
<li>Each item in the favorites section has a '-' button to remove items from the
favorites section</li>
<li>Each item in the 'All Subforums' section that is not already in the favorites
section has a '+' button to add items to the favorites section</li>
<li>When the favorites section is empty, a message is shown</li>
<li>The add and remove button work correctly</li>
<li>The favorites are sorted correctly (Refer to sort cod below, link)</li>
</ul>
<p>Location: <strong><code>images/gifs/navigation/favorites.gif</code></strong></p>
<p><img src="images/gifs/navigation/favorites.gif" alt="Favorites Works GIF" /></p>
<a class="header" href="print.html#subforum-page-1" id="subforum-page-1"><h1>Subforum Page</h1></a>
<a class="header" href="print.html#empty-subforum-message" id="empty-subforum-message"><h2>Empty Subforum Message</h2></a>
<ul>
<li>Display a message when a subforum has no posts</li>
</ul>
<p>Location: <strong><code>images/gifs/subforum/empty.gif</code></strong></p>
<p><img src="images/gifs/subforum/empty.gif" alt="Empty subforum message GIF" /></p>
<a class="header" href="print.html#the-new-post-button" id="the-new-post-button"><h2>The 'New Post' Button</h2></a>
<ul>
<li>When a user is logged in, the button is clickable</li>
<li>When a user is not logged in, the button is greyed out and not clickable</li>
</ul>
<p>Location: <strong><code>images/gifs/subforum/new-post-button.gif</code></strong></p>
<p><img src="images/gifs/subforum/new-post-button.gif" alt="New Post Button GIF" /></p>
<a class="header" href="print.html#the-post-list" id="the-post-list"><h2>The Post List</h2></a>
<ul>
<li>The list contains the following information about the post:
<ul>
<li>Post title</li>
<li>Created at</li>
<li>Vote count</li>
</ul>
</li>
<li>Each post in the list is a link to the post</li>
</ul>
<p>Location: <strong><code>images/gifs/subforum/post-list.gif</code></strong></p>
<p><img src="images/gifs/subforum/post-list.gif" alt="The post list GIF" /></p>
<a class="header" href="print.html#sorting-functionality" id="sorting-functionality"><h2>Sorting Functionality</h2></a>
<ul>
<li>The default sorting method is by 'most popular' posts</li>
<li>Both sort methods sort in descending order</li>
<li>The 'most popular' sort method sorts by vote count</li>
<li>The 'newest' sort method sorts by created at time and date</li>
</ul>
<p>Location: <strong><code>images/gifs/subforum/sorting.gif</code></strong></p>
<p><img src="images/gifs/subforum/sorting.gif" alt="Sorting Functionality GIF" /></p>
<a class="header" href="print.html#post-page-2" id="post-page-2"><h1>Post Page</h1></a>
<a class="header" href="print.html#posts-are-loading-correctly" id="posts-are-loading-correctly"><h2>Posts are Loading Correctly</h2></a>
<ul>
<li>Links from subforum pages work and post details are loaded</li>
</ul>
<p>Location: <strong><code>images/gifs/post/load.gif</code></strong></p>
<p><img src="images/gifs/post/load.gif" alt="Post info loading GIF" /></p>
<a class="header" href="print.html#comments-section" id="comments-section"><h2>Comments Section</h2></a>
<ul>
<li>If there are no comments, show a message</li>
<li>You cannot comment when not logged in</li>
<li>When logged in, add a section add the bottom of the page to add a comment</li>
<li>When a comment is submitted, it is added to the comment section of the page</li>
<li>The user cannot submit a comment when no text has been entered</li>
<li>The comment count is updated correctly</li>
</ul>
<p>Location: <strong><code>images/gifs/post/comment.gif</code></strong></p>
<p><img src="images/gifs/post/comment.gif" alt="Comments section GIF" /></p>
<a class="header" href="print.html#post-voting" id="post-voting"><h2>Post Voting</h2></a>
<ul>
<li>The vote count is displayed in the top right of a post</li>
<li>There is a button to upvote and a button to downvote a post</li>
<li>If a user is not logged in, then vote buttons are greyed out and not clickable</li>
<li>If a user is logged in, the vote buttons are clickable</li>
<li>The vote count updates properly (Reference code below, link)</li>
</ul>
<p>Location: <strong><code>images/gifs/post/vote.gif</code></strong></p>
<p><img src="images/gifs/post/vote.gif" alt="Post voting GIF" /></p>
<a class="header" href="print.html#new-post-page-2" id="new-post-page-2"><h1>New Post Page</h1></a>
<ul>
<li>The 'New Post' button in a subforum brings the user to this page</li>
<li>A new post can only be submitted when both fields are filled in</li>
<li>The user is then redirected to the newly created post after they submit it</li>
<li>The new post is inserted into the subforum from which the user click the 'New
Post' button</li>
</ul>
<p>Location: <strong><code>images/gifs/new-post/index.gif</code></strong></p>
<p><img src="images/gifs/new-post/index.gif" alt="New post page GIF" /></p>
<ul>
<li>If a user tries to visit this page when they are not logged in, an error
message is displayed with links to either signup or login</li>
</ul>
<p>Location: <strong><code>images/gifs/new-post/error.gif</code></strong></p>
<p><img src="images/gifs/new-post/error.gif" alt="New post page error GIF" /></p>
<a class="header" href="print.html#new-subforum-page" id="new-subforum-page"><h1>New Subforum Page</h1></a>
<ul>
<li>The only way to access this page is through the navigation when a user is
logged in</li>
</ul>
<p>Location: <strong><code>images/gifs/new-subforum/index.gif</code></strong></p>
<p><img src="images/gifs/new-subforum/index.gif" alt="New subforum page GIF" /></p>
<ul>
<li>If the user tries to create a subforum that already exists, an error occurs</li>
</ul>
<p>Location: <strong><code>images/gifs/new-subforum/exists.gif</code></strong></p>
<p><img src="images/gifs/new-subforum/exists.gif" alt="Subforum already exists GIF" /></p>
<ul>
<li>If a user tries to visit this page when they are not logged in, an error
message is displayed with links to either signup or login</li>
</ul>
<p>Location: <strong><code>images/gifs/new-subforum/error.gif</code></strong></p>
<p><img src="images/gifs/new-subforum/error.gif" alt="New subforum page error GIF" /></p>
<a class="header" href="print.html#usability-features" id="usability-features"><h1>Usability Features</h1></a>
<ul>
<li>Quick loading between actions</li>
<li>Instant search of subforums</li>
<li>Optimistic UI updates (For example, adding a comment or voting on a post)</li>
<li>Loading states
<ul>
<li>On loading navigation lists</li>
<li>On loading a subforum or a post</li>
<li>Signup and login loading states</li>
</ul>
</li>
<li>Helpful error messages</li>
<li>justify their success</li>
</ul>
<a class="header" href="print.html#final-evaluation" id="final-evaluation"><h1>Final Evaluation</h1></a>
<a class="header" href="print.html#success-of-the-solution" id="success-of-the-solution"><h2>Success of the Solution</h2></a>
<ul>
<li>Reference to test data</li>
<li>Cross reference test evidence with success criteria and evaluate how well the
criteria has been met. If any have not been fully met, comment on how they
could be met with further development.</li>
<li>One major one I can think of now (Not currently in the success criteria) is
that the ergonomics of deployment is not the best. One solution to this would
be to move the API to Prisma and offer an option to host the API and the
client on the same machine with a single command.</li>
<li>Could also talk about the possibility of adding GraphQL subscriptions to
provide live updating info for the following:
<ul>
<li>New posts coming up on the subforum page</li>
<li>Vote count updating both on subforum and post page</li>
<li>New comments coming up on post page</li>
<li>Possible new subforums as well?</li>
</ul>
</li>
</ul>
<a class="header" href="print.html#limitations-and-maintenance" id="limitations-and-maintenance"><h2>Limitations and Maintenance</h2></a>
<ul>
<li>Mention the fact that I did not get around to implementing the automated
tests. This was because Nuxt, the client framework I am using, makes it hard
to build robust tests at the moment. In future version of the framework, they
have said that they will address this issue, and it will be easier to create
robust tests. This will impact maintenance because when refactoring, adding
and features and code, it will not be nearly as easy to tell if those changes
have broke any other code depending on them.</li>
<li>Talk about good code comments</li>
<li>Talk about how this report itself could be used by myself and others to get
familiar with the project.</li>
<li>Talk about how these limitations could be fixed</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>


        <!-- Local fallback for Font Awesome -->
        <script>
            if (getComputedStyle(document.querySelector(".fa")).fontFamily !== "FontAwesome") {
                var link = document.createElement('link');
                link.rel = 'stylesheet';
                link.type = 'text/css';
                link.href = '_FontAwesome/css/font-awesome.css';
                document.head.insertBefore(link, document.head.firstChild)
            }
        </script>

        

        

        

        
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                window.print();
            })
        </script>
        

        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS script -->
        

    </body>
</html>
